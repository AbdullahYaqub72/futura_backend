Started GET "/auth/login" for 182.177.127.163 at 2025-03-29 22:56:00 +0500
Cannot render console from 182.177.127.163! Allowed networks: 127.0.0.0/127.255.255.255, ::1
  [1m[36mActiveRecord::SchemaMigration Load (146.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/auth/login"):
  
Started GET "/auth/google" for 182.177.127.163 at 2025-03-29 22:56:18 +0500
Cannot render console from 182.177.127.163! Allowed networks: 127.0.0.0/127.255.255.255, ::1
Processing by AuthController#google_login as */*
Redirected to https://58dc-182-177-127-163.ngrok-free.app/auth/v1/authorize?provider=google&redirect_to=http://localhost:3000/auth/callback
Completed 302 Found in 22ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/auth/v1/authorize?provider=google&redirect_to=http://localhost:3000/auth/callback" for 182.177.127.163 at 2025-03-29 22:56:18 +0500
Cannot render console from 182.177.127.163! Allowed networks: 127.0.0.0/127.255.255.255, ::1
  
ActionController::RoutingError (No route matches [GET] "/auth/v1/authorize"):
  
Started POST "/auth/login" for ::1 at 2025-03-29 22:56:32 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:56:33 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:56:54 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:57:30 +0500
  [1m[36mActiveRecord::SchemaMigration Load (141.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:58:25 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:58:26 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 22:58:26 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:07:58 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:07:59 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:08:00 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:08:00 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:16:57 +0500
  
ActiveRecord::DatabaseConnectionError (There is an issue connecting with your hostname: aws-0-ap-south-1.pooler.supabase.com.

Please check your database configuration and ensure there is a valid connection to your database.
):

Causes:
PG::ConnectionBad (could not translate host name "aws-0-ap-south-1.pooler.supabase.com" to address: nodename nor servname provided, or not known
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:67:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/auth/login" for ::1 at 2025-03-29 23:25:36 +0500
  [1m[36mActiveRecord::SchemaMigration Load (482.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:27:41 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:27:42 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:29:32 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:29:33 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-29 23:30:01 +0500
  [1m[36mActiveRecord::SchemaMigration Load (140.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 558ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.6ms)


Started POST "/auth/login" for ::1 at 2025-03-29 23:30:19 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 3164ms (Views: 0.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.2ms)


Started POST "/auth/login" for ::1 at 2025-03-29 23:31:58 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 2132ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/customers/" for ::1 at 2025-03-30 12:37:10 +0500
  
ActionController::RoutingError (No route matches [POST] "/customers"):
  
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:22 +0500
  [1m[36mActiveRecord::SchemaMigration Load (158.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:34 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:35 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:36 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:37 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-03-30 12:43:37 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:25:04 +0500
  [1m[36mActiveRecord::SchemaMigration Load (149.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:48 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:49 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:50 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:51 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:51 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:52 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:52 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:27:52 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:23:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-04-01 14:38:25 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 342060ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 37.1ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:24:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
Started POST "/auth/login" for ::1 at 2025-04-01 14:44:12 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 8387ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 10.8ms)


  
Errno::ECONNREFUSED (Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)):

Causes:
Errno::ECONNREFUSED (Connection refused - connect(2) for nil port 80)
  
app/services/supabase_service.rb:24:in `sign_in'
app/controllers/auth_controller.rb:21:in `login'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-04-01 14:45:04 +0500
  [1m[36mActiveRecord::SchemaMigration Load (147.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1422ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:45:17 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 891ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:47:34 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 976ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:48:07 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 489ms (Views: 0.9ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:49:11 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 942ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.8ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:49:18 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 861ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:50:20 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 17607ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 17.5ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:50:47 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 31687ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 53.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 14:51:29 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 824ms (Views: 0.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/auth/register" for ::1 at 2025-04-01 14:54:16 +0500
  
ActionController::RoutingError (No route matches [GET] "/auth/register"):
  
Started POST "/auth/register" for ::1 at 2025-04-01 14:54:22 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 201 Created in 3909ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-04-01 14:56:34 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 201 Created in 4067ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


Started POST "/auth/register" for ::1 at 2025-04-01 14:58:11 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 201 Created in 2903ms (Views: 1.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/" for ::1 at 2025-04-01 15:00:42 +0500
Processing by Rails::WelcomeController#index as HTML
  Rendering /Users/abdullahyaqub/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/railties-7.2.2.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /Users/abdullahyaqub/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/railties-7.2.2.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 0.6ms | GC: 0.0ms)
Completed 200 OK in 3ms (Views: 1.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-04-01 15:07:37 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 201 Created in 5071ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-04-01 15:09:45 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 201 Created in 889ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-04-01 15:13:25 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 422 Unprocessable Content in 785ms (Views: 3.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-01 15:13:35 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 526ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.3ms)


Started POST "/auth/login" for ::1 at 2025-04-01 15:14:22 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 607ms (Views: 0.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.7ms)


Started POST "/product_categories/" for ::1 at 2025-04-02 10:37:13 +0500
Processing by ProductCategoriesController#create as */*
  Parameters: {"product_category"=>{"name"=>"Electronics", "description"=>"All kinds of electronic gadgets and accessories."}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/auth/login" for ::1 at 2025-04-02 10:37:19 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 1612ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-02 10:37:24 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 992ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-02 10:37:39 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 853ms (Views: 0.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-02 10:38:04 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 98211ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 22.7ms)


Started POST "/auth/login" for ::1 at 2025-04-02 10:39:45 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 2610ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 24.1ms)


Started POST "/product_categories/" for ::1 at 2025-04-02 10:39:55 +0500
Processing by ProductCategoriesController#create as */*
  Parameters: {"product_category"=>{"name"=>"Electronics", "description"=>"All kinds of electronic gadgets and accessories."}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/product_categories/" for ::1 at 2025-04-02 10:42:59 +0500
Processing by ProductCategoriesController#create as */*
  Parameters: {"product_category"=>{"name"=>"Electronics", "description"=>"All kinds of electronic gadgets and accessories."}}
  [1m[36mTRANSACTION (135.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/product_categories_controller.rb:19:in `create'
  [1m[36mProductCategory Create (282.2ms)[0m  [1m[32mINSERT INTO "product_categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Electronics"], ["description", "All kinds of electronic gadgets and accessories."], ["created_at", "2025-04-02 05:43:06.267192"], ["updated_at", "2025-04-02 05:43:06.267192"]]
  ↳ app/controllers/product_categories_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/product_categories_controller.rb:19:in `create'
Completed 201 Created in 6729ms (Views: 0.8ms | ActiveRecord: 5472.6ms (1 query, 0 cached) | GC: 0.9ms)


Started GET "/product_categories/" for ::1 at 2025-04-02 10:45:34 +0500
Processing by ProductCategoriesController#index as */*
  [1m[36mProductCategory Load (138.4ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories"[0m
  ↳ app/controllers/product_categories_controller.rb:8:in `index'
Completed 200 OK in 161ms (Views: 4.2ms | ActiveRecord: 138.4ms (1 query, 0 cached) | GC: 0.2ms)


Started POST "/product/" for ::1 at 2025-04-02 10:48:02 +0500
  
ActionController::RoutingError (No route matches [POST] "/product"):
  
Started POST "/products/" for ::1 at 2025-04-02 10:48:04 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Headphones", "description"=>"Noise-canceling over-ear headphones with Bluetooth connectivity.", "quantity"=>50, "price"=>99.99, "product_category_id"=>1}}
  [1m[36mTRANSACTION (497.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProductCategory Load (135.4ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProduct Create (141.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "quantity", "price", "product_category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Wireless Headphones"], ["description", "Noise-canceling over-ear headphones with Bluetooth connectivity."], ["quantity", 50], ["price", "99.99"], ["product_category_id", 1], ["created_at", "2025-04-02 05:48:07.301546"], ["updated_at", "2025-04-02 05:48:07.301546"]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mTRANSACTION (136.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
Completed 201 Created in 2721ms (Views: 0.4ms | ActiveRecord: 2993.4ms (2 queries, 0 cached) | GC: 4.8ms)


Started GET "/products/" for ::1 at 2025-04-02 10:48:18 +0500
Processing by ProductsController#index as */*
  Parameters: {"product"=>{"name"=>"Wireless Headphones", "description"=>"Noise-canceling over-ear headphones with Bluetooth connectivity.", "quantity"=>50, "price"=>99.99, "product_category_id"=>1}}
  [1m[36mProduct Load (136.4ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  ↳ app/controllers/products_controller.rb:8:in `index'
Completed 200 OK in 141ms (Views: 2.4ms | ActiveRecord: 136.4ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-04-06 18:01:55 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1746ms (Views: 1.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/products/" for ::1 at 2025-04-06 18:02:19 +0500
Processing by ProductsController#index as */*
  Parameters: {"product"=>{"name"=>"Magic Mug", "description"=>"Reveals image with hot water", "quantity"=>10, "price"=>12.99, "product_category_attributes"=>{"name"=>"Kitchen Gadgets", "description"=>"Cool things for the kitchen"}}}
  [1m[36mProduct Load (2421.9ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  ↳ app/controllers/products_controller.rb:8:in `index'
Completed 200 OK in 2435ms (Views: -1098.5ms | ActiveRecord: 3532.4ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/products/" for ::1 at 2025-04-06 18:02:39 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Magic Mug", "description"=>"Reveals image with hot water", "quantity"=>10, "price"=>12.99, "product_category_attributes"=>{"name"=>"Kitchen Gadgets", "description"=>"Cool things for the kitchen"}}}
  [1m[36mTRANSACTION (199.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProductCategory Create (356.8ms)[0m  [1m[32mINSERT INTO "product_categories" ("name", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Kitchen Gadgets"], ["description", "Cool things for the kitchen"], ["created_at", "2025-04-06 13:02:39.790068"], ["updated_at", "2025-04-06 13:02:39.790068"]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProduct Create (134.1ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "quantity", "price", "product_category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Magic Mug"], ["description", "Reveals image with hot water"], ["quantity", 10], ["price", "12.99"], ["product_category_id", 2], ["created_at", "2025-04-06 13:02:40.150070"], ["updated_at", "2025-04-06 13:02:40.150070"]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mTRANSACTION (404.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
Completed 201 Created in 1300ms (Views: 0.6ms | ActiveRecord: 1475.2ms (2 queries, 0 cached) | GC: 2.7ms)


Started GET "/products/" for ::1 at 2025-04-06 18:02:54 +0500
Processing by ProductsController#index as */*
  Parameters: {"product"=>{"name"=>"Magic Mug", "description"=>"Reveals image with hot water", "quantity"=>10, "price"=>12.99, "product_category_attributes"=>{"name"=>"Kitchen Gadgets", "description"=>"Cool things for the kitchen"}}}
  [1m[36mProduct Load (138.9ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  ↳ app/controllers/products_controller.rb:8:in `index'
Completed 200 OK in 143ms (Views: 2.8ms | ActiveRecord: 138.8ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/customets/" for ::1 at 2025-04-06 19:10:31 +0500
  
ActionController::RoutingError (No route matches [GET] "/customets"):
  
Started GET "/customers" for ::1 at 2025-04-06 19:10:34 +0500
Processing by CustomersController#index as */*
  Parameters: {"product"=>{"name"=>"Magic Mug", "description"=>"Reveals image with hot water", "quantity"=>10, "price"=>12.99, "product_category_attributes"=>{"name"=>"Kitchen Gadgets", "description"=>"Cool things for the kitchen"}}, "customer"=>{}}
  [1m[36mCustomer Load (140.8ms)[0m  [1m[34mSELECT "customers".* FROM "customers"[0m
  ↳ app/controllers/customers_controller.rb:7:in `index'
Completed 200 OK in 146ms (Views: 3.7ms | ActiveRecord: 6434.8ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/transactions" for ::1 at 2025-04-06 19:17:43 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:7)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>2, "date"=>"2025-04-01T10:00:00Z", "total_amount"=>1000, "discount"=>50, "payment_method"=>"mpesa", "status"=>"completed", "mpesa_transaction_attributes"=>{"total_amount"=>950, "code"=>"MP123ABC456", "status"=>"confirmed", "date"=>"2025-04-01T10:00:00Z"}}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/transactions" for ::1 at 2025-04-06 19:19:31 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:7)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>2, "date"=>"2025-04-01T10:00:00Z", "total_amount"=>1000, "discount"=>50, "payment_method"=>"mpesa", "status"=>"completed", "mpesa_transaction_attributes"=>{"total_amount"=>950, "code"=>"MP123ABC456", "status"=>"confirmed", "date"=>"2025-04-01T10:00:00Z"}}}
[31mUnpermitted parameter: :mpesa_transaction_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x00000001053a1e10>, params: {"transaction"=>{"user_id"=>1, "customer_id"=>2, "date"=>"2025-04-01T10:00:00Z", "total_amount"=>1000, "discount"=>50, "payment_method"=>"mpesa", "status"=>"completed", "mpesa_transaction_attributes"=>{"total_amount"=>950, "code"=>"MP123ABC456", "status"=>"confirmed", "date"=>"2025-04-01T10:00:00Z"}}, "controller"=>"transactions", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (147.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (152.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (551.8ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (151.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 16633ms (Views: 1.6ms | ActiveRecord: 7628.7ms (2 queries, 0 cached) | GC: 8.3ms)


  [1m[35m (150.5ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (150.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (152.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddSupabaseIdToUsers (20250406142616)
  [1m[36mTRANSACTION (152.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (322.5ms)[0m  [1m[35mALTER TABLE "users" ADD "supabase_id" character varying[0m
  [1m[36mActiveRecord::SchemaMigration Create (148.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250406142616') RETURNING "version"[0m
  [1m[36mTRANSACTION (150.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (148.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (148.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/auth/register" for ::1 at 2025-04-06 19:29:05 +0500
  [1m[36mActiveRecord::SchemaMigration Load (494.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 500 Internal Server Error in 9080ms (ActiveRecord: 1930.6ms (0 queries, 0 cached) | GC: 1.2ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'supabase_id' for User.):

Causes:
NoMethodError (undefined method `supabase_id=' for #<User id: nil, name: "John Doe", email: [FILTERED], phone: "+123456789", revenue: nil, revenue_type: nil, password: nil, role: nil, created_at: nil, updated_at: nil>)
  
app/controllers/auth_controller.rb:16:in `register'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/register" for ::1 at 2025-04-06 19:30:21 +0500
  [1m[36mActiveRecord::SchemaMigration Load (142.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
Completed 422 Unprocessable Content in 1464ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-04-06 19:30:43 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"+123456789", "name"=>"John Doe"}}
  [1m[36mTRANSACTION (138.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:17:in `register'
  [1m[36mUser Create (283.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["name", "John Doe"], ["email", "[FILTERED]"], ["phone", "+123456789"], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-04-06 14:30:54.821753"], ["updated_at", "2025-04-06 14:30:54.821753"], ["supabase_id", "e0e90aab-6fab-4877-9ca3-e78fe0f21d3e"]]
  ↳ app/controllers/auth_controller.rb:17:in `register'
  [1m[36mTRANSACTION (140.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:17:in `register'
Completed 201 Created in 12188ms (Views: 0.8ms | ActiveRecord: 4428.5ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/users" for ::1 at 2025-04-06 19:32:39 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (510.5ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  ↳ app/controllers/users_controller.rb:7:in `index'
Completed 200 OK in 520ms (Views: 5.9ms | ActiveRecord: 510.4ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/customers" for ::1 at 2025-04-06 19:35:40 +0500
Processing by CustomersController#create as */*
  Parameters: {"customer"=>{"first_name"=>"John", "last_name"=>"Doe", "phone"=>"123-456-7890", "gender"=>"male"}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/customers" for ::1 at 2025-04-06 19:36:49 +0500
Processing by CustomersController#create as */*
  Parameters: {"customer"=>{"first_name"=>"John", "last_name"=>"Doe", "phone"=>"123-456-7890", "gender"=>"male"}}
  [1m[36mTRANSACTION (833.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mCustomer Create (5295.4ms)[0m  [1m[32mINSERT INTO "customers" ("first_name", "last_name", "phone", "gender", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["first_name", "John"], ["last_name", "Doe"], ["phone", "123-456-7890"], ["gender", "male"], ["created_at", "2025-04-06 14:36:51.516488"], ["updated_at", "2025-04-06 14:36:51.516488"]]
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mTRANSACTION (5737.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
Completed 201 Created in 12983ms (Views: 0.7ms | ActiveRecord: 13801.2ms (1 query, 0 cached) | GC: 0.4ms)


Started POST "/transactions" for ::1 at 2025-04-06 19:37:18 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:7)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-01T10:00:00Z", "total_amount"=>1000, "discount"=>50, "payment_method"=>"mpesa", "status"=>"completed", "mpesa_transaction_attributes"=>{"total_amount"=>950, "code"=>"MP123ABC456", "status"=>"confirmed", "date"=>"2025-04-01T10:00:00Z"}}}
  [1m[36mTRANSACTION (140.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (142.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (139.3ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (144.8ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "950.0"], ["code", "MP123ABC456"], ["status", "confirmed"], ["date", "2025-04-01 10:00:00"], ["created_at", "2025-04-06 14:37:31.770040"], ["updated_at", "2025-04-06 14:37:31.770040"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (154.0ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-01 10:00:00"], ["total_amount", "1000.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "completed"], ["mpesa_transaction_id", 1], ["created_at", "2025-04-06 14:37:31.917700"], ["updated_at", "2025-04-06 14:37:31.917700"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (139.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 201 Created in 13728ms (Views: 0.6ms | ActiveRecord: 13520.9ms (4 queries, 0 cached) | GC: 1.8ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (145.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (147.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (141.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddEmailAndDateOfBirthToCustomers (20250409164945)
  [1m[36mTRANSACTION (138.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (296.1ms)[0m  [1m[35mALTER TABLE "customers" ADD "email" character varying[0m
  [1m[35m (138.8ms)[0m  [1m[35mALTER TABLE "customers" ADD "date_of_birth" date[0m
  [1m[36mActiveRecord::SchemaMigration Create (145.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250409164945') RETURNING "version"[0m
  [1m[36mTRANSACTION (219.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (139.0ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (140.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (155.6ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (149.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (158.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddQuantityToTransactions (20250409165309)
  [1m[36mTRANSACTION (155.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (312.1ms)[0m  [1m[35mALTER TABLE "transactions" ADD "quantity" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (163.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250409165309') RETURNING "version"[0m
  [1m[36mTRANSACTION (186.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (169.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (157.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (139.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (141.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (138.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateTransactionItems (20250409170018)
  [1m[36mTRANSACTION (137.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (234.3ms)[0m  [1m[35mCREATE TABLE "transaction_items" ("id" bigserial primary key, "sale_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e20b358bcf"
FOREIGN KEY ("sale_id")
  REFERENCES "sales" ("id")
, CONSTRAINT "fk_rails_856b4fc46a"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[36mTRANSACTION (136.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (139.8ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::SchemaMigration Load (134.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (134.8ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (134.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (134.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateTransactionItems (20250409170018)
  [1m[36mTRANSACTION (134.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (159.7ms)[0m  [1m[35mCREATE TABLE "transaction_items" ("id" bigserial primary key, "transaction_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_53aa362180"
FOREIGN KEY ("transaction_id")
  REFERENCES "transactions" ("id")
, CONSTRAINT "fk_rails_856b4fc46a"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[35m (140.9ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_transaction_id" ON "transaction_items" ("transaction_id")[0m
  [1m[35m (139.3ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_product_id" ON "transaction_items" ("product_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (139.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250409170018') RETURNING "version"[0m
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (134.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/transactions" for ::1 at 2025-04-09 22:06:51 +0500
  [1m[36mActiveRecord::SchemaMigration Load (160.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"MPESA", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
Completed 500 Internal Server Error in 2069ms (ActiveRecord: 1100.5ms (0 queries, 0 cached) | GC: 0.8ms)


  
ArgumentError ('MPESA' is not a valid payment_method):
  
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:07:42 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
Completed 500 Internal Server Error in 16ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
ArgumentError (You tried to define an association named transaction on the model TransactionItem, but this will conflict with a method transaction already defined by Active Record. Please choose a different association name.):
  
app/models/transaction_item.rb:2:in `<class:TransactionItem>'
app/models/transaction_item.rb:1:in `<main>'
app/controllers/transactions_controller.rb:18:in `create'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::SchemaMigration Load (132.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (129.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (142.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (129.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateTransactionItems (20250409170018)
  [1m[36mTRANSACTION (129.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (279.5ms)[0m  [1m[35mDROP TABLE "transaction_items"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (133.7ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20250409170018'[0m
  [1m[36mTRANSACTION (132.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (130.8ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (143.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (149.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (159.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (149.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateTransactionItems (20250409170018)
  [1m[36mTRANSACTION (180.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (188.3ms)[0m  [1m[35mCREATE TABLE "transaction_items" ("id" bigserial primary key, "transaction_record_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_922f2e8367"
FOREIGN KEY ("transaction_record_id")
  REFERENCES "transactions" ("id")
, CONSTRAINT "fk_rails_856b4fc46a"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
)[0m
  [1m[35m (154.1ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_transaction_record_id" ON "transaction_items" ("transaction_record_id")[0m
  [1m[35m (161.0ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_product_id" ON "transaction_items" ("product_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (149.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250409170018') RETURNING "version"[0m
  [1m[36mTRANSACTION (150.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (149.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (150.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/transactions" for ::1 at 2025-04-09 22:12:11 +0500
  [1m[36mActiveRecord::SchemaMigration Load (142.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (137.4ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (133.0ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (136.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (136.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mProduct Load (247.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mProduct Load (133.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (179.5ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 4928ms (Views: 1.6ms | ActiveRecord: 4209.5ms (5 queries, 0 cached) | GC: 12.7ms)


Started GET "/products/" for ::1 at 2025-04-09 22:12:45 +0500
Processing by ProductsController#index as */*
  [1m[36mProduct Load (133.1ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  ↳ app/controllers/products_controller.rb:8:in `index'
Completed 200 OK in 138ms (Views: 4.8ms | ActiveRecord: 133.1ms (1 query, 0 cached) | GC: 0.3ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:13:03 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>5, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (132.7ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (131.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (132.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (134.7ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mProduct Load (132.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mProduct Load (132.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (134.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 1092ms (Views: 0.8ms | ActiveRecord: 930.3ms (5 queries, 0 cached) | GC: 0.6ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:16:58 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>5, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
Completed 500 Internal Server Error in 1376ms (ActiveRecord: 1351.7ms (0 queries, 0 cached) | GC: 1.4ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'transaction_id' for TransactionItem.):

Causes:
NoMethodError (undefined method `transaction_id=' for #<TransactionItem id: nil, transaction_record_id: nil, product_id: 3, quantity: 2, created_at: nil, updated_at: nil>)
  
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:17:30 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>5, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (133.5ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (132.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (132.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (132.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 3305ms (Views: 1.0ms | ActiveRecord: 3210.4ms (3 queries, 0 cached) | GC: 13.1ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:20:49 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"Credit Card", "status"=>"Completed", "mpesa_transaction_id"=>"MPESA12345", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"Credit Card", "status"=>"Completed", "mpesa_transaction_id"=>"MPESA12345", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 317ms (ActiveRecord: 805.2ms (0 queries, 0 cached) | GC: 41.4ms)


  
ArgumentError ('Credit Card' is not a valid payment_method):
  
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:21:02 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"MPESA12345", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"MPESA12345", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (132.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (132.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (133.6ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Load (132.4ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 0], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 2069ms (Views: 1.7ms | ActiveRecord: 2141.0ms (3 queries, 0 cached) | GC: 1.7ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:23:16 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>1, "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>1, "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (134.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (135.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (134.0ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Load (132.5ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.7ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 701ms (Views: 0.9ms | ActiveRecord: 668.3ms (3 queries, 0 cached) | GC: 6.6ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:23:34 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (131.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (132.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (136.5ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 600ms (Views: 4.7ms | ActiveRecord: 532.5ms (2 queries, 0 cached) | GC: 54.0ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:24:00 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (132.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (141.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (132.5ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 422 Unprocessable Content in 1948ms (Views: 1.2ms | ActiveRecord: 2557.7ms (2 queries, 0 cached) | GC: 0.9ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:29:42 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (131.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `create'
  [1m[36mUser Load (137.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `create'
  [1m[36mCustomer Load (132.0ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (135.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:24:in `create'
Completed 422 Unprocessable Content in 1954ms (Views: 1.8ms | ActiveRecord: 2548.3ms (2 queries, 0 cached) | GC: 12.1ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:30:40 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (134.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `create'
  [1m[36mUser Load (134.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `create'
  [1m[36mCustomer Load (145.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `create'
  [1m[36mTRANSACTION (157.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:21:in `create'
Completed 422 Unprocessable Content in 1996ms (Views: 1.1ms | ActiveRecord: 2626.6ms (2 queries, 0 cached) | GC: 1.6ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:31:05 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (135.2ms)[0m  [1m[35mBEGIN[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mUser Load (146.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mCustomer Load (147.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mTRANSACTION (139.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
Completed 422 Unprocessable Content in 98493ms (Views: 1.0ms | ActiveRecord: 2639.2ms (2 queries, 0 cached) | GC: 32.9ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:32:48 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[35mBEGIN[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mUser Load (133.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mCustomer Load (132.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mTRANSACTION (134.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
Completed 422 Unprocessable Content in 172137ms (Views: 2.0ms | ActiveRecord: 2608.7ms (2 queries, 0 cached) | GC: 19.2ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:35:43 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (132.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (132.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mCustomer Load (132.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (132.8ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 1544ms (ActiveRecord: 2144.7ms (2 queries, 0 cached) | GC: 1.9ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:35:54 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (134.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mUser Load (133.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mCustomer Load (133.1ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (138.0ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 556ms (ActiveRecord: 538.4ms (2 queries, 0 cached) | GC: 0.2ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:39:43 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108194bb0>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (132.0ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (133.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mCustomer Load (133.1ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransaction Create (135.5ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 17:39:44.822110"], ["updated_at", "2025-04-09 17:39:44.822110"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (133.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 500 Internal Server Error in 1398ms (ActiveRecord: 2007.2ms (3 queries, 0 cached) | GC: 3.5ms)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "mpesa_transaction_id" of relation "transactions" violates not-null constraint
DETAIL:  Failing row contains (2, 1, 1, 2025-04-09 00:00:00, 150.0, 10.0, mpesa, Completed, null, 2025-04-09 17:39:44.82211, 2025-04-09 17:39:44.82211, null).
):

Causes:
PG::NotNullViolation (ERROR:  null value in column "mpesa_transaction_id" of relation "transactions" violates not-null constraint
DETAIL:  Failing row contains (2, 1, 1, 2025-04-09 00:00:00, 150.0, 10.0, mpesa, Completed, null, 2025-04-09 17:39:44.82211, 2025-04-09 17:39:44.82211, null).
)
  
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (138.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (139.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (141.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to ChangeMpesaTransactionIdInTransactions (20250409174132)
  [1m[36mTRANSACTION (138.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (282.3ms)[0m  [1m[35mALTER TABLE "transactions" ALTER COLUMN "mpesa_transaction_id" DROP NOT NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (139.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250409174132') RETURNING "version"[0m
  [1m[36mTRANSACTION (140.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (139.0ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (139.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/transactions" for ::1 at 2025-04-09 22:42:12 +0500
  [1m[36mActiveRecord::SchemaMigration Load (143.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000107d1ae68>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (133.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (132.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mCustomer Load (132.8ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransaction Create (134.2ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 17:42:16.706068"], ["updated_at", "2025-04-09 17:42:16.706068"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
[31mUnpermitted parameters: :user_id, :customer_id, :date, :total_amount, :discount, :payment_method, :status, :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000107d1ae68>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (131.7ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
Completed 500 Internal Server Error in 1383ms (ActiveRecord: 2004.6ms (3 queries, 0 cached) | GC: 0.3ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:26:in `block in create'
app/controllers/transactions_controller.rb:19:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:43:18 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108118df8>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (134.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (136.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mCustomer Load (132.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mTransaction Create (133.6ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 17:43:29.601868"], ["updated_at", "2025-04-09 17:43:29.601868"], ["quantity", nil]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
[31mUnpermitted parameters: :user_id, :customer_id, :date, :total_amount, :discount, :payment_method, :status, :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108118df8>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
[31mUnpermitted parameters: :user_id, :customer_id, :date, :total_amount, :discount, :payment_method, :status, :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108118df8>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
[31mUnpermitted parameters: :user_id, :customer_id, :date, :total_amount, :discount, :payment_method, :status, :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108118df8>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (175.7ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 198289ms (ActiveRecord: 2088.0ms (3 queries, 0 cached) | GC: 57.2ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:46:41 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (132.7ms)[0m  [1m[35mBEGIN[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mUser Load (134.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mCustomer Load (132.7ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
  [1m[36mTRANSACTION (132.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `create'
Completed 422 Unprocessable Content in 51504ms (Views: 1.2ms | ActiveRecord: 3062.4ms (2 queries, 0 cached) | GC: 35.3ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:47:37 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (131.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (132.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (132.2ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (131.9ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 32596ms (ActiveRecord: 2140.2ms (2 queries, 0 cached) | GC: 21.6ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:48:17 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x00000001072244c8>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (137.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (132.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mCustomer Load (142.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mTransaction Create (135.7ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 17:48:28.969232"], ["updated_at", "2025-04-09 17:48:28.969232"], ["quantity", nil]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mTRANSACTION (133.5ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 38861ms (ActiveRecord: 2308.7ms (3 queries, 0 cached) | GC: 55.8ms)


  
ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):
  
app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
app/controllers/transactions_controller.rb:22:in `each'
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:49:57 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (133.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (134.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (133.1ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (132.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 1606ms (ActiveRecord: 2169.9ms (2 queries, 0 cached) | GC: 21.7ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:50:09 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (141.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (133.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (136.8ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (134.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 165321ms (ActiveRecord: 544.4ms (2 queries, 0 cached) | GC: 29.3ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:52:59 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 290ms (ActiveRecord: 809.7ms (0 queries, 0 cached) | GC: 0.2ms)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Symbol passed.):
  
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:53:16 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 22195ms (ActiveRecord: 805.5ms (0 queries, 0 cached) | GC: 38.8ms)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Symbol passed.):
  
app/controllers/transactions_controller.rb:19:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:54:47 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 8228ms (ActiveRecord: 536.6ms (0 queries, 0 cached) | GC: 30.6ms)


  
NoMethodError (undefined method `except' for :transaction_params:Symbol):
  
app/controllers/transactions_controller.rb:20:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:55:04 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (138.0ms)[0m  [1m[35mBEGIN[0m
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mUser Load (133.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mCustomer Load (135.0ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ (rdbg)//Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/controllers/transactions_controller.rb:1:in `block in create'
  [1m[36mTRANSACTION (152.0ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
No template found for TransactionsController#create, rendering head :no_content
Completed 204 No Content in 251277ms (ActiveRecord: 1645.9ms (2 queries, 0 cached) | GC: 16.5ms)


Started POST "/transactions" for ::1 at 2025-04-09 22:59:18 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 6991ms (ActiveRecord: 533.0ms (0 queries, 0 cached) | GC: 28.2ms)


  
NoMethodError (undefined method `except' for :transaction_params:Symbol):
  
app/controllers/transactions_controller.rb:20:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 22:59:39 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (132.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mTRANSACTION (136.5ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 7887ms (ActiveRecord: 1088.4ms (0 queries, 0 cached) | GC: 33.4ms)


  
ArgumentError (When assigning attributes, you must pass a hash as an argument, Symbol passed.):
  
app/controllers/transactions_controller.rb:20:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:00:26 +0500
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108f5c450>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108f5c450>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (140.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (133.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (134.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (135.7ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:01:03.031509"], ["updated_at", "2025-04-09 18:01:03.031509"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x0000000108f5c450>, params: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "controller"=>"transactions", "action"=>"create", "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}} }[0m
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 37016ms (ActiveRecord: 1360.8ms (3 queries, 0 cached) | GC: 18.0ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:01:24 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_items_attributes"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed"}}
  [1m[36mTRANSACTION (133.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (132.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (132.6ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (137.1ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:02:29.411499"], ["updated_at", "2025-04-09 18:02:29.411499"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (215.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 155304ms (ActiveRecord: 2659.1ms (3 queries, 0 cached) | GC: 156.8ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:06:16 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed"}}
  [1m[36mTRANSACTION (141.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (136.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (141.0ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (153.6ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:07:20.160474"], ["updated_at", "2025-04-09 18:07:20.160474"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (132.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 63200ms (ActiveRecord: 2138.2ms (3 queries, 0 cached) | GC: 54.5ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:07:26 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}], "transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed"}}
  [1m[36mTRANSACTION (137.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (132.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (132.5ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (133.0ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:08:42.622939"], ["updated_at", "2025-04-09 18:08:42.622939"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (141.9ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 75945ms (ActiveRecord: 2088.6ms (3 queries, 0 cached) | GC: 70.3ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:22:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:08:47 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (133.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 23003ms (ActiveRecord: 815.4ms (0 queries, 0 cached) | GC: 61.1ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'transaction_data' for Transaction.):

Causes:
NoMethodError (undefined method `transaction_data=' for #<Transaction id: nil, user_id: 1, customer_id: 1, date: "2025-04-09 00:00:00.000000000 +0000", total_amount: 0.15e3, discount: 0.1e2, payment_method: "mpesa", status: "Completed", mpesa_transaction_id: nil, created_at: nil, updated_at: nil, quantity: nil>)
  
app/controllers/transactions_controller.rb:20:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:09:19 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
Completed 500 Internal Server Error in 39998ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 20.6ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'transaction_data' for Transaction.):

Causes:
NoMethodError (undefined method `transaction_data=' for #<Transaction id: nil, user_id: 1, customer_id: 1, date: "2025-04-09 00:00:00.000000000 +0000", total_amount: 0.15e3, discount: 0.1e2, payment_method: "mpesa", status: "Completed", mpesa_transaction_id: nil, created_at: nil, updated_at: nil, quantity: nil>)
  
app/controllers/transactions_controller.rb:20:in `block in create'
app/controllers/transactions_controller.rb:18:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:10:05 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>2, "quantity"=>3}]}}
  [1m[36mTRANSACTION (165.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:20:in `block in create'
  [1m[36mUser Load (140.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (136.6ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (138.8ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:10:16.455136"], ["updated_at", "2025-04-09 18:10:16.455136"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (136.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Create (144.9ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 10], ["product_id", 1], ["quantity", 2], ["created_at", "2025-04-09 18:10:20.649693"], ["updated_at", "2025-04-09 18:10:20.649693"]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransaction Load (192.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Create (144.8ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 10], ["product_id", 2], ["quantity", 3], ["created_at", "2025-04-09 18:10:25.058417"], ["updated_at", "2025-04-09 18:10:25.058417"]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Load (136.3ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 10]]
  ↳ app/controllers/transactions_controller.rb:26:in `block in create'
  [1m[36mTRANSACTION (142.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 201 Created in 27222ms (Views: 572.0ms | ActiveRecord: 3063.4ms (8 queries, 0 cached) | GC: 94.4ms)


Started POST "/transactions" for ::1 at 2025-04-09 23:10:53 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>19999, "quantity"=>2}, {"product_id"=>44444, "quantity"=>3}]}}
  [1m[36mTRANSACTION (135.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (135.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (144.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (135.6ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:10:55.276901"], ["updated_at", "2025-04-09 18:10:55.276901"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (138.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Create (138.1ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 11], ["product_id", 19999], ["quantity", 2], ["created_at", "2025-04-09 18:10:55.559362"], ["updated_at", "2025-04-09 18:10:55.559362"]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTRANSACTION (141.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 500 Internal Server Error in 2355ms (ActiveRecord: 968.1ms (5 queries, 0 cached) | GC: 19.9ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "transaction_items" violates foreign key constraint "fk_rails_856b4fc46a"
DETAIL:  Key (product_id)=(19999) is not present in table "products".
):

Causes:
PG::ForeignKeyViolation (ERROR:  insert or update on table "transaction_items" violates foreign key constraint "fk_rails_856b4fc46a"
DETAIL:  Key (product_id)=(19999) is not present in table "products".
)
  
Started POST "/transactions" for ::1 at 2025-04-09 23:11:21 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>3, "quantity"=>3}]}}
  [1m[36mTRANSACTION (135.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mUser Load (136.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mCustomer Load (166.1ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Create (135.7ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:11:24.149629"], ["updated_at", "2025-04-09 18:11:24.149629"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (136.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Create (142.4ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 12], ["product_id", 1], ["quantity", 2], ["created_at", "2025-04-09 18:11:24.430438"], ["updated_at", "2025-04-09 18:11:24.430438"]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransaction Load (150.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Create (137.3ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 12], ["product_id", 3], ["quantity", 3], ["created_at", "2025-04-09 18:11:24.734930"], ["updated_at", "2025-04-09 18:11:24.734930"]]
  ↳ app/controllers/transactions_controller.rb:23:in `block (2 levels) in create'
  [1m[36mTransactionItem Load (153.6ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 12]]
  ↳ app/controllers/transactions_controller.rb:26:in `block in create'
  [1m[36mTRANSACTION (140.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:18:in `create'
Completed 201 Created in 3540ms (Views: 4.8ms | ActiveRecord: 1432.8ms (8 queries, 0 cached) | GC: 19.1ms)


Started POST "/transactions" for ::1 at 2025-04-09 23:12:44 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>3, "quantity"=>3}]}}
  [1m[36mTRANSACTION (139.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (146.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (135.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (138.4ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:12:46.096564"], ["updated_at", "2025-04-09 18:12:46.096564"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (137.2ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (137.2ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 13], ["product_id", 1], ["quantity", 2], ["created_at", "2025-04-09 18:12:47.223136"], ["updated_at", "2025-04-09 18:12:47.223136"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (137.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (136.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (135.8ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (136.3ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 13], ["product_id", 3], ["quantity", 3], ["created_at", "2025-04-09 18:12:47.788446"], ["updated_at", "2025-04-09 18:12:47.788446"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (136.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Load (139.1ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 13]]
  ↳ app/controllers/transactions_controller.rb:24:in `create'
Completed 500 Internal Server Error in 4477ms (Views: 150.4ms | ActiveRecord: 4359.1ms (8 queries, 0 cached) | GC: 0.0ms)


  
NameError (undefined local variable or method `e' for #<TransactionsController:0x0000000026b100>):
  
app/controllers/transactions_controller.rb:28:in `create'
Started POST "/transactions" for ::1 at 2025-04-09 23:13:34 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>3, "quantity"=>3}]}}
  [1m[36mTRANSACTION (137.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (168.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (144.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (151.8ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:13:37.056775"], ["updated_at", "2025-04-09 18:13:37.056775"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (139.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (138.0ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (147.7ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 14], ["product_id", 1], ["quantity", 2], ["created_at", "2025-04-09 18:13:38.226022"], ["updated_at", "2025-04-09 18:13:38.226022"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (137.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (164.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (141.7ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (145.3ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 14], ["product_id", 3], ["quantity", 3], ["created_at", "2025-04-09 18:13:38.828787"], ["updated_at", "2025-04-09 18:13:38.828787"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (176.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Load (136.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 14]]
  ↳ app/controllers/transactions_controller.rb:24:in `create'
Completed 201 Created in 4689ms (Views: 150.9ms | ActiveRecord: 4564.7ms (8 queries, 0 cached) | GC: 15.5ms)


Started POST "/transactions" for ::1 at 2025-04-09 23:13:45 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>9999, "quantity"=>2}, {"product_id"=>3, "quantity"=>3}]}}
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (136.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (136.7ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (140.4ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:13:45.505069"], ["updated_at", "2025-04-09 18:13:45.505069"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (136.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (135.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (137.3ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 15], ["product_id", 9999], ["quantity", 2], ["created_at", "2025-04-09 18:13:46.067880"], ["updated_at", "2025-04-09 18:13:46.067880"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (135.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
Completed 500 Internal Server Error in 1263ms (ActiveRecord: 1231.6ms (5 queries, 0 cached) | GC: 1.0ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "transaction_items" violates foreign key constraint "fk_rails_856b4fc46a"
DETAIL:  Key (product_id)=(9999) is not present in table "products".
):

Causes:
PG::ForeignKeyViolation (ERROR:  insert or update on table "transaction_items" violates foreign key constraint "fk_rails_856b4fc46a"
DETAIL:  Key (product_id)=(9999) is not present in table "products".
)
  
Started POST "/transactions" for ::1 at 2025-04-09 23:14:42 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:8)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>150.0, "discount"=>10.0, "payment_method"=>"mpesa", "status"=>"Completed", "transaction_data"=>[{"product_id"=>1, "quantity"=>2}, {"product_id"=>3, "quantity"=>3}]}}
  [1m[36mTRANSACTION (135.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (140.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (135.4ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (159.4ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "150.0"], ["discount", "10.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", nil], ["created_at", "2025-04-09 18:14:45.020845"], ["updated_at", "2025-04-09 18:14:45.020845"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (146.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (142.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (137.0ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (144.2ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 16], ["product_id", 1], ["quantity", 2], ["created_at", "2025-04-09 18:14:46.240659"], ["updated_at", "2025-04-09 18:14:46.240659"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (142.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (142.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (137.6ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (136.1ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 16], ["product_id", 3], ["quantity", 3], ["created_at", "2025-04-09 18:14:46.822050"], ["updated_at", "2025-04-09 18:14:46.822050"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (136.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Load (135.8ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 16]]
  ↳ app/controllers/transactions_controller.rb:24:in `create'
Completed 201 Created in 4953ms (Views: 155.2ms | ActiveRecord: 4820.0ms (8 queries, 0 cached) | GC: 18.7ms)


Started POST "/customers/" for ::1 at 2025-04-09 23:16:18 +0500
  
NoMethodError (undefined method `validates' for CustomersController:Class):
  
app/controllers/customers_controller.rb:4:in `<class:CustomersController>'
app/controllers/customers_controller.rb:1:in `<main>'
Started POST "/customers/" for ::1 at 2025-04-09 23:16:57 +0500
Processing by CustomersController#create as */*
  Parameters: {"customer"=>{"first_name"=>"John", "last_name"=>"Doe", "phone"=>"1234567890", "gender"=>"Male", "email"=>"[FILTERED]", "date_of_birth"=>"1990-01-01"}}
  [1m[36mTRANSACTION (147.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mCustomer Create (291.4ms)[0m  [1m[32mINSERT INTO "customers" ("first_name", "last_name", "phone", "gender", "created_at", "updated_at", "email", "date_of_birth") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["first_name", "John"], ["last_name", "Doe"], ["phone", "1234567890"], ["gender", "Male"], ["created_at", "2025-04-09 18:16:58.240171"], ["updated_at", "2025-04-09 18:16:58.240171"], ["email", "[FILTERED]"], ["date_of_birth", "1990-01-01"]]
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mTRANSACTION (137.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
Completed 201 Created in 1294ms (Views: 0.8ms | ActiveRecord: 1423.3ms (1 query, 0 cached) | GC: 2.4ms)


Started POST "/customers/" for ::1 at 2025-04-09 23:17:05 +0500
Processing by CustomersController#create as */*
  Parameters: {"customer"=>{"first_name"=>"John", "phone"=>"1234567890", "gender"=>"Male", "email"=>"[FILTERED]", "date_of_birth"=>"1990-01-01"}}
Completed 422 Unprocessable Content in 2ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/customers/" for ::1 at 2025-04-09 23:17:14 +0500
Error occurred while parsing request parameters.
Contents:

{
  "customer": {
    "first_name": "John",
    "last_name": "Doe",
    "phone": "1234567890",
    "gender": "Male",
  }
}
Processing by CustomersController#create as */*
Completed 400 Bad Request in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):

Causes:
JSON::ParserError (expected object key, got: '}
}')
  
app/controllers/customers_controller.rb:50:in `customer_params'
app/controllers/customers_controller.rb:18:in `create'
Started POST "/customers/" for ::1 at 2025-04-09 23:17:20 +0500
Error occurred while parsing request parameters.
Contents:

{
  "customer": {
    "first_name": "John",
    "last_name": "Doe",
    "phone": "1234567890",
    "gender": "Male",
  }
}
Processing by CustomersController#create as */*
Completed 400 Bad Request in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.2ms)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):

Causes:
JSON::ParserError (expected object key, got: '}
}')
  
app/controllers/customers_controller.rb:50:in `customer_params'
app/controllers/customers_controller.rb:18:in `create'
Started POST "/customers/" for ::1 at 2025-04-09 23:17:23 +0500
Processing by CustomersController#create as */*
  Parameters: {"customer"=>{"first_name"=>"John", "last_name"=>"Doe", "phone"=>"1234567890", "gender"=>"Male"}}
  [1m[36mTRANSACTION (143.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mCustomer Create (302.8ms)[0m  [1m[32mINSERT INTO "customers" ("first_name", "last_name", "phone", "gender", "created_at", "updated_at", "email", "date_of_birth") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["first_name", "John"], ["last_name", "Doe"], ["phone", "1234567890"], ["gender", "Male"], ["created_at", "2025-04-09 18:17:23.430216"], ["updated_at", "2025-04-09 18:17:23.430216"], ["email", "[FILTERED]"], ["date_of_birth", nil]]
  ↳ app/controllers/customers_controller.rb:19:in `create'
  [1m[36mTRANSACTION (152.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/customers_controller.rb:19:in `create'
Completed 201 Created in 461ms (Views: 0.5ms | ActiveRecord: 599.2ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/users/" for ::1 at 2025-04-12 15:19:45 +0500
Processing by UsersController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "user"=>{}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 2ms (ActiveRecord: 1485.8ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/users/" for ::1 at 2025-04-12 15:20:33 +0500
Processing by UsersController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "user"=>{}}
Completed 400 Bad Request in 6ms (ActiveRecord: 589.1ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::ParameterMissing (param is missing or the value is empty: user):
  
app/controllers/users_controller.rb:70:in `user_params'
app/controllers/users_controller.rb:18:in `create'
Started GET "/users/" for ::1 at 2025-04-12 15:20:42 +0500
Processing by UsersController#index as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "user"=>{}}
  [1m[36mUser Load (165.4ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  ↳ app/controllers/users_controller.rb:8:in `index'
Completed 200 OK in 535ms (Views: 16.3ms | ActiveRecord: 518.2ms (1 query, 0 cached) | GC: 0.1ms)


Started GET "/users/id_by_supabase_id/0c136af9-97ed-47b1-94e8-d706825048fa" for ::1 at 2025-04-12 15:21:20 +0500
Processing by UsersController#find_id_by_supabase_id as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "supabase_id"=>"0c136af9-97ed-47b1-94e8-d706825048fa", "user"=>{}}
  [1m[36mUser Load (151.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "0c136af9-97ed-47b1-94e8-d706825048fa"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:53:in `find_id_by_supabase_id'
Completed 200 OK in 646ms (Views: 0.2ms | ActiveRecord: 310.5ms (1 query, 0 cached) | GC: 0.2ms)


Started GET "/users/find_by_supabase_id/0c136af9-97ed-47b1-94e8-d706825048fa" for ::1 at 2025-04-12 15:21:35 +0500
  
ActionController::RoutingError (No route matches [GET] "/users/find_by_supabase_id/0c136af9-97ed-47b1-94e8-d706825048fa"):
  
Started GET "/users/by_supabase_id/0c136af9-97ed-47b1-94e8-d706825048fa" for ::1 at 2025-04-12 15:22:07 +0500
Processing by UsersController#find_by_supabase_id as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "supabase_id"=>"0c136af9-97ed-47b1-94e8-d706825048fa", "user"=>{}}
  [1m[36mUser Load (142.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "0c136af9-97ed-47b1-94e8-d706825048fa"], ["LIMIT", 1]]
  ↳ app/controllers/users_controller.rb:43:in `find_by_supabase_id'
Completed 200 OK in 457ms (Views: 0.7ms | ActiveRecord: 874.2ms (1 query, 0 cached) | GC: 0.3ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (151.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (155.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (151.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddSalesTransactionToInventoryLogs (20250413103259)
  [1m[36mTRANSACTION (148.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (322.5ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD "sales_transaction_id" bigint NOT NULL[0m
  [1m[35m (172.1ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_sales_transaction_id" ON "inventory_logs" ("sales_transaction_id")[0m
  [1m[35m (190.6ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_4fc8fd7989"
FOREIGN KEY ("sales_transaction_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (152.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413103259') RETURNING "version"[0m
  [1m[36mTRANSACTION (157.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (148.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (148.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/inventory_log/" for ::1 at 2025-04-13 15:36:52 +0500
  [1m[36mActiveRecord::SchemaMigration Load (137.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [POST] "/inventory_log"):
  
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/inventory_logs/" for ::1 at 2025-04-13 15:37:53 +0500
Processing by InventoryLogsController#create as */*
  Parameters: {"inventory_log"=>{"product_id"=>1, "change_quantity"=>-5, "date"=>"2025-04-01T12:00:00Z", "reason"=>"Sold item", "sales_transaction_id"=>3}}
Can't verify CSRF token authenticity.
Completed 422 Unprocessable Content in 0ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActionController::InvalidAuthenticityToken (Can't verify CSRF token authenticity.):
  
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:312:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:406:in `handle_unverified_request'
actionpack (7.2.2.1) lib/action_controller/metal/request_forgery_protection.rb:395:in `verify_authenticity_token'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:362:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/inventory_logs/" for ::1 at 2025-04-13 15:38:13 +0500
Processing by InventoryLogsController#create as */*
  Parameters: {"inventory_log"=>{"product_id"=>1, "change_quantity"=>-5, "date"=>"2025-04-01T12:00:00Z", "reason"=>"Sold item", "sales_transaction_id"=>3}}
Completed 404 Not Found in 1ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
AbstractController::ActionNotFound (The destroy action could not be found for the :set_inventory_log
callback on InventoryLogsController, but it is listed in the controller's
:only option.

Raising for missing callback actions is a new default in Rails 7.1, if you'd
like to turn this off you can delete the option from the environment configurations
or set `config.action_controller.raise_on_missing_callback_actions` to `false`.
):
  
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:62:in `match?'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:385:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:178:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:178:in `all?'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:178:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
turbo-rails (2.0.13) lib/turbo-rails.rb:24:in `with_request_id'
turbo-rails (2.0.13) app/controllers/concerns/turbo/request_id_tracking.rb:10:in `turbo_tracking_request_id'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `block in run_callbacks'
actiontext (7.2.2.1) lib/action_text/rendering.rb:25:in `with_renderer'
actiontext (7.2.2.1) lib/action_text/engine.rb:71:in `block (4 levels) in <class:Engine>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `instance_exec'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:43:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started POST "/inventory_logs/" for ::1 at 2025-04-13 15:38:35 +0500
Processing by InventoryLogsController#create as */*
  Parameters: {"inventory_log"=>{"product_id"=>1, "change_quantity"=>-5, "date"=>"2025-04-01T12:00:00Z", "reason"=>"Sold item", "sales_transaction_id"=>3}}
  [1m[36mTRANSACTION (138.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mProduct Load (142.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mInventoryLog Create (151.5ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 1], ["change_quantity", -5], ["date", "2025-04-01 12:00:00"], ["reason", "Sold item"], ["created_at", "2025-04-13 10:38:39.897696"], ["updated_at", "2025-04-13 10:38:39.897696"], ["sales_transaction_id", 3]]
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mTRANSACTION (139.0ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
Completed 500 Internal Server Error in 4924ms (ActiveRecord: 3497.9ms (2 queries, 0 cached) | GC: 0.3ms)


  
ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  insert or update on table "inventory_logs" violates foreign key constraint "fk_rails_4fc8fd7989"
DETAIL:  Key (sales_transaction_id)=(3) is not present in table "transactions".
):

Causes:
PG::ForeignKeyViolation (ERROR:  insert or update on table "inventory_logs" violates foreign key constraint "fk_rails_4fc8fd7989"
DETAIL:  Key (sales_transaction_id)=(3) is not present in table "transactions".
)
  
Started GET "/transactions/" for ::1 at 2025-04-13 15:39:00 +0500
Processing by TransactionsController#index as */*
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (138.0ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions"[0m
  ↳ app/controllers/transactions_controller.rb:8:in `index'
  [1m[36mTransactionItem Load (141.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["transaction_record_id", 1], ["transaction_record_id", 10], ["transaction_record_id", 12], ["transaction_record_id", 13], ["transaction_record_id", 14], ["transaction_record_id", 15], ["transaction_record_id", 16], ["transaction_record_id", 17]]
  ↳ app/controllers/transactions_controller.rb:8:in `index'
  [1m[36mMpesaTransaction Load (137.3ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/transactions_controller.rb:8:in `index'
Completed 200 OK in 2733ms (Views: 210.0ms | ActiveRecord: 2514.3ms (3 queries, 0 cached) | GC: 0.6ms)


Started POST "/inventory_logs/" for ::1 at 2025-04-13 15:39:14 +0500
Processing by InventoryLogsController#create as */*
  Parameters: {"inventory_log"=>{"product_id"=>1, "change_quantity"=>-5, "date"=>"2025-04-01T12:00:00Z", "reason"=>"Sold item", "sales_transaction_id"=>1}}
  [1m[36mTRANSACTION (135.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mProduct Load (142.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mInventoryLog Create (136.1ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 1], ["change_quantity", -5], ["date", "2025-04-01 12:00:00"], ["reason", "Sold item"], ["created_at", "2025-04-13 10:39:15.150062"], ["updated_at", "2025-04-13 10:39:15.150062"], ["sales_transaction_id", 1]]
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
  [1m[36mTRANSACTION (139.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/inventory_logs_controller.rb:19:in `create'
Completed 201 Created in 568ms (Views: 0.6ms | ActiveRecord: 553.8ms (2 queries, 0 cached) | GC: 0.1ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mInventoryLog Load (141.5ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" ORDER BY "inventory_logs"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mInventoryLog Load (143.3ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" ORDER BY "inventory_logs"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (143.1ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/transactions/" for ::1 at 2025-04-13 15:45:46 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Processing by TransactionsController#index as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mTransaction Load (2356.7ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions"[0m
  ↳ app/controllers/transactions_controller.rb:8:in `index'
  [1m[36mTransactionItem Load (136.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["transaction_record_id", 1], ["transaction_record_id", 10], ["transaction_record_id", 12], ["transaction_record_id", 13], ["transaction_record_id", 14], ["transaction_record_id", 15], ["transaction_record_id", 16], ["transaction_record_id", 17]]
  ↳ app/controllers/transactions_controller.rb:8:in `index'
  [1m[36mMpesaTransaction Load (137.7ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/transactions_controller.rb:8:in `index'
Completed 200 OK in 3117ms (Views: -878.1ms | ActiveRecord: 3993.3ms (3 queries, 0 cached) | GC: 21.0ms)


Started POST "/transactions/" for ::1 at 2025-04-13 15:45:55 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x000000010bbbf5b0>, params: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "controller"=>"transactions", "action"=>"create"} }[0m
  [1m[36mMpesaTransaction Load (135.0ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (134.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mUser Load (479.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mCustomer Load (135.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mMpesaTransaction Create (135.2ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 10:45:57.545152"], ["updated_at", "2025-04-13 10:45:57.545152"]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTransaction Create (138.7ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 2], ["created_at", "2025-04-13 10:45:57.685359"], ["updated_at", "2025-04-13 10:45:57.685359"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x000000010bbbf5b0>, params: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "controller"=>"transactions", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (136.8ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/transactions_controller.rb:21:in `create'
Completed 500 Internal Server Error in 2464ms (ActiveRecord: 1858.0ms (5 queries, 0 cached) | GC: 4.7ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:23:in `block in create'
app/controllers/transactions_controller.rb:21:in `create'
Started POST "/transactions/" for ::1 at 2025-04-13 15:48:33 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x000000010a558678>, params: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "controller"=>"transactions", "action"=>"create"} }[0m
  [1m[36mMpesaTransaction Load (135.7ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (149.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (134.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (134.6ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (133.9ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 10:48:36.011544"], ["updated_at", "2025-04-13 10:48:36.011544"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (142.1ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 3], ["created_at", "2025-04-13 10:48:36.150148"], ["updated_at", "2025-04-13 10:48:36.150148"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (135.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
[31mUnpermitted parameter: :transaction_items_attributes. Context: { controller: TransactionsController, action: create, request: #<ActionDispatch::Request:0x000000010a558678>, params: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_items_attributes"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}, "controller"=>"transactions", "action"=>"create"} }[0m
Completed 500 Internal Server Error in 3103ms (ActiveRecord: 3037.3ms (5 queries, 0 cached) | GC: 2.4ms)


  
NoMethodError (undefined method `each' for nil:NilClass):
  
app/controllers/transactions_controller.rb:20:in `create'
Started POST "/transactions/" for ::1 at 2025-04-13 15:49:14 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_data"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (134.6ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (134.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (134.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (145.2ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (136.7ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 10:49:15.247387"], ["updated_at", "2025-04-13 10:49:15.247387"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (137.2ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 4], ["created_at", "2025-04-13 10:49:15.389717"], ["updated_at", "2025-04-13 10:49:15.389717"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (136.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (139.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (135.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (140.0ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 20], ["product_id", 3], ["quantity", 2], ["created_at", "2025-04-13 10:49:16.658271"], ["updated_at", "2025-04-13 10:49:16.658271"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (136.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (138.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (279.4ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 93], ["updated_at", "2025-04-13 10:49:17.777238"], ["id", 3]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (136.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (134.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (139.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (142.2ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["change_quantity", -2], ["date", "2025-04-13 10:49:18.205653"], ["reason", "Sold in transaction 20"], ["created_at", "2025-04-13 10:49:19.046104"], ["updated_at", "2025-04-13 10:49:19.046104"], ["sales_transaction_id", 20]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (136.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (134.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (142.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (136.3ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 20], ["product_id", 2], ["quantity", 1], ["created_at", "2025-04-13 10:49:19.612635"], ["updated_at", "2025-04-13 10:49:19.612635"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (136.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (144.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (134.0ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (269.9ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 91], ["updated_at", "2025-04-13 10:49:20.173934"], ["id", 2]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (137.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (136.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (134.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (135.2ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["change_quantity", -1], ["date", "2025-04-13 10:49:20.586001"], ["reason", "Sold in transaction 20"], ["created_at", "2025-04-13 10:49:20.863644"], ["updated_at", "2025-04-13 10:49:20.863644"], ["sales_transaction_id", 20]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (135.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransactionItem Load (141.6ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 20]]
  ↳ app/controllers/transactions_controller.rb:33:in `create'
Completed 201 Created in 7029ms (Views: 293.6ms | ActiveRecord: 6310.8ms (18 queries, 0 cached) | GC: 24.6ms)


  [1m[36mInventoryLog Load (136.7ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mProduct Load (137.7ms)[0m  [1m[34mSELECT "products".* FROM "products" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/transactions/" for ::1 at 2025-04-13 15:50:52 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_data"=>[{"product_id"=>3, "quantity"=>2}, {"product_id"=>2, "quantity"=>1}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (135.7ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (134.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (134.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (135.8ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (478.7ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 10:50:53.040243"], ["updated_at", "2025-04-13 10:50:53.040243"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (135.3ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 5], ["created_at", "2025-04-13 10:50:53.522324"], ["updated_at", "2025-04-13 10:50:53.522324"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (134.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (144.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (136.2ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (138.7ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 21], ["product_id", 3], ["quantity", 2], ["created_at", "2025-04-13 10:50:54.093983"], ["updated_at", "2025-04-13 10:50:54.093983"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (141.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (135.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (136.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (274.4ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 91], ["updated_at", "2025-04-13 10:50:54.656015"], ["id", 3]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (135.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (133.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (136.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (138.4ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["change_quantity", -2], ["date", "2025-04-13 10:50:55.074583"], ["reason", "Sold in transaction 21"], ["created_at", "2025-04-13 10:50:55.353414"], ["updated_at", "2025-04-13 10:50:55.353414"], ["sales_transaction_id", 21]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (140.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (138.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (492.1ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (146.0ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["transaction_record_id", 21], ["product_id", 2], ["quantity", 1], ["created_at", "2025-04-13 10:50:56.276327"], ["updated_at", "2025-04-13 10:50:56.276327"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (142.3ms)[0m  [1m[34mSELECT "products".* FROM "products" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTRANSACTION (495.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (135.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (137.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (276.0ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 90], ["updated_at", "2025-04-13 10:50:57.196362"], ["id", 2]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (136.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (135.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (135.7ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["change_quantity", -1], ["date", "2025-04-13 10:50:57.618326"], ["reason", "Sold in transaction 21"], ["created_at", "2025-04-13 10:50:57.902094"], ["updated_at", "2025-04-13 10:50:57.902094"], ["sales_transaction_id", 21]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (135.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransactionItem Load (135.0ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 21]]
  ↳ app/controllers/transactions_controller.rb:33:in `create'
Completed 201 Created in 6195ms (Views: 140.0ms | ActiveRecord: 5715.7ms (18 queries, 0 cached) | GC: 86.9ms)


  [1m[36mProduct Load (207.0ms)[0m  [1m[34mSELECT "products".* FROM "products" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mInventoryLog Load (138.4ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mInventoryLog Destroy (273.3ms)[0m  [1m[31mDELETE FROM "inventory_logs" WHERE "inventory_logs"."id" = $1[0m  [["id", 2]]
  [1m[36mTRANSACTION (136.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (135.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mInventoryLog Destroy (272.0ms)[0m  [1m[31mDELETE FROM "inventory_logs" WHERE "inventory_logs"."id" = $1[0m  [["id", 3]]
  [1m[36mTRANSACTION (137.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (135.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mInventoryLog Destroy (630.2ms)[0m  [1m[31mDELETE FROM "inventory_logs" WHERE "inventory_logs"."id" = $1[0m  [["id", 4]]
  [1m[36mTRANSACTION (136.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (135.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mInventoryLog Destroy (272.4ms)[0m  [1m[31mDELETE FROM "inventory_logs" WHERE "inventory_logs"."id" = $1[0m  [["id", 5]]
  [1m[36mTRANSACTION (137.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (137.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mInventoryLog Destroy (275.6ms)[0m  [1m[31mDELETE FROM "inventory_logs" WHERE "inventory_logs"."id" = $1[0m  [["id", 6]]
  [1m[36mTRANSACTION (136.7ms)[0m  [1m[35mCOMMIT[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::SchemaMigration Load (141.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (139.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (140.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddSalesTransactionToInventoryLogs (20250413103259)
  [1m[36mTRANSACTION (134.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (284.4ms)[0m  [1m[35mALTER TABLE "inventory_logs" DROP CONSTRAINT "fk_rails_4fc8fd7989"[0m
  [1m[35m (140.0ms)[0m  [1m[35mALTER TABLE "inventory_logs" DROP COLUMN "sales_transaction_id"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (138.2ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20250413103259'[0m
  [1m[36mTRANSACTION (154.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (135.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (141.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (142.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (149.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddSalesTransactionToInventoryLogs (20250413103259)
  [1m[36mTRANSACTION (141.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (284.4ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD "sales_transaction_id" bigint[0m
  [1m[35m (150.4ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_sales_transaction_id" ON "inventory_logs" ("sales_transaction_id")[0m
  [1m[35m (152.7ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_4fc8fd7989"
FOREIGN KEY ("sales_transaction_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (141.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413103259') RETURNING "version"[0m
  [1m[36mTRANSACTION (144.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (143.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (519.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (132.8ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (1547.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (133.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (133.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (132.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/products/" for ::1 at 2025-04-13 15:58:20 +0500
  [1m[36mActiveRecord::SchemaMigration Load (149.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Organic Honey", "description"=>"Pure, raw, organic honey from wildflowers.", "quantity"=>100, "price"=>14.99, "product_category_id"=>2}}
  [1m[36mTRANSACTION (493.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProductCategory Load (134.7ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mProduct Create (138.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "quantity", "price", "product_category_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Organic Honey"], ["description", "Pure, raw, organic honey from wildflowers."], ["quantity", 100], ["price", "14.99"], ["product_category_id", 2], ["created_at", "2025-04-13 10:58:28.046293"], ["updated_at", "2025-04-13 10:58:28.046293"]]
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mTRANSACTION (151.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:19:in `create'
  [1m[36mTRANSACTION (131.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:20:in `create'
  [1m[36mInventoryLog Create (267.6ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 11], ["change_quantity", 100], ["date", "2025-04-13 10:58:28.355905"], ["reason", "Product created with initial stock"], ["created_at", "2025-04-13 10:58:28.361449"], ["updated_at", "2025-04-13 10:58:28.361449"], ["sales_transaction_id", nil]]
  ↳ app/controllers/products_controller.rb:20:in `create'
  [1m[36mTRANSACTION (132.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:20:in `create'
Completed 201 Created in 5119ms (Views: 1.2ms | ActiveRecord: 4232.0ms (3 queries, 0 cached) | GC: 4.5ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (225.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (137.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (137.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddPriceToTransactionItems (20250413105955)
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (298.0ms)[0m  [1m[35mALTER TABLE "transaction_items" ADD "price" decimal[0m
  [1m[36mActiveRecord::SchemaMigration Create (135.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413105955') RETURNING "version"[0m
  [1m[36mTRANSACTION (139.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (154.0ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (134.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mInventoryLog Load (137.6ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started PUT "/products/" for ::1 at 2025-04-13 16:01:37 +0500
  [1m[36mActiveRecord::SchemaMigration Load (132.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [PUT] "/products"):
  
Started PUT "/products/11" for ::1 at 2025-04-13 16:02:04 +0500
Processing by ProductsController#update as */*
  Parameters: {"product"=>{"name"=>"Organic Honey", "description"=>"Pure, raw, organic honey from wildflowers.", "quantity"=>90, "price"=>14.99, "product_category_id"=>2}, "id"=>"11"}
  [1m[36mProduct Load (134.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:53:in `set_product'
  [1m[36mTRANSACTION (131.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mProduct Update (266.0ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 90], ["updated_at", "2025-04-13 11:02:05.369638"], ["id", 11]]
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mTRANSACTION (138.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mTRANSACTION (133.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:34:in `update'
  [1m[36mInventoryLog Create (267.5ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 11], ["change_quantity", -10], ["date", "2025-04-13 11:02:05.788190"], ["reason", "Stock updated"], ["created_at", "2025-04-13 11:02:06.433424"], ["updated_at", "2025-04-13 11:02:06.433424"], ["sales_transaction_id", nil]]
  ↳ app/controllers/products_controller.rb:34:in `update'
  [1m[36mTRANSACTION (137.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:34:in `update'
Completed 200 OK in 2582ms (Views: 1.3ms | ActiveRecord: 2650.3ms (3 queries, 0 cached) | GC: 1.5ms)


  [1m[36mInventoryLog Load (137.3ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started PUT "/products/11" for ::1 at 2025-04-13 16:02:23 +0500
Processing by ProductsController#update as */*
  Parameters: {"product"=>{"name"=>"Organic Honey", "description"=>"Pure, raw, organic honey from wildflowers.", "quantity"=>110, "price"=>14.99, "product_category_id"=>2}, "id"=>"11"}
  [1m[36mProduct Load (134.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/products_controller.rb:53:in `set_product'
  [1m[36mTRANSACTION (132.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mProduct Update (268.6ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 110], ["updated_at", "2025-04-13 11:02:23.993904"], ["id", 11]]
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mTRANSACTION (133.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:30:in `update'
  [1m[36mTRANSACTION (141.0ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:34:in `update'
  [1m[36mInventoryLog Create (277.1ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 11], ["change_quantity", 20], ["date", "2025-04-13 11:02:24.401830"], ["reason", "Stock updated"], ["created_at", "2025-04-13 11:02:24.403115"], ["updated_at", "2025-04-13 11:02:24.403115"], ["sales_transaction_id", nil]]
  ↳ app/controllers/products_controller.rb:34:in `update'
  [1m[36mTRANSACTION (134.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:34:in `update'
Completed 200 OK in 1100ms (Views: 0.7ms | ActiveRecord: 1221.1ms (3 queries, 0 cached) | GC: 0.2ms)


  [1m[36mInventoryLog Load (146.6ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/transactions/" for ::1 at 2025-04-13 16:03:56 +0500
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-09", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_data"=>[{"product_id"=>3, "quantity"=>2, "price"=>100}, {"product_id"=>2, "quantity"=>1, "price"=>200}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (137.2ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (138.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (133.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (133.7ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (132.4ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 11:03:59.300703"], ["updated_at", "2025-04-13 11:03:59.300703"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (136.0ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-09 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 6], ["created_at", "2025-04-13 11:03:59.437015"], ["updated_at", "2025-04-13 11:03:59.437015"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (133.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (161.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (133.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (135.0ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at", "price") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["transaction_record_id", 22], ["product_id", 3], ["quantity", 2], ["created_at", "2025-04-13 11:04:00.698354"], ["updated_at", "2025-04-13 11:04:00.698354"], ["price", "100.0"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (134.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (132.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (144.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (648.9ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 89], ["updated_at", "2025-04-13 11:04:02.398695"], ["id", 3]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (136.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (134.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (132.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (134.0ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["change_quantity", -2], ["date", "2025-04-13 11:04:03.195632"], ["reason", "Sold in transaction 22"], ["created_at", "2025-04-13 11:04:04.026052"], ["updated_at", "2025-04-13 11:04:04.026052"], ["sales_transaction_id", 22]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (133.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (132.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (132.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (132.8ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at", "price") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["transaction_record_id", 22], ["product_id", 2], ["quantity", 1], ["created_at", "2025-04-13 11:04:04.571848"], ["updated_at", "2025-04-13 11:04:04.571848"], ["price", "200.0"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (133.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (134.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (132.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (267.8ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 89], ["updated_at", "2025-04-13 11:04:05.113490"], ["id", 2]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (134.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (132.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (134.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (134.1ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["change_quantity", -1], ["date", "2025-04-13 11:04:05.522178"], ["reason", "Sold in transaction 22"], ["created_at", "2025-04-13 11:04:05.794899"], ["updated_at", "2025-04-13 11:04:05.794899"], ["sales_transaction_id", 22]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (134.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransactionItem Load (133.5ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 22]]
  ↳ app/controllers/transactions_controller.rb:33:in `create'
Completed 201 Created in 10210ms (Views: 283.6ms | ActiveRecord: 9326.3ms (18 queries, 0 cached) | GC: 22.6ms)


Started GET "/reports/daily" for ::1 at 2025-04-13 16:05:45 +0500
Processing by ReportsController#daily as */*
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Sum (141.2ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:32:in `generate_report'
  [1m[36mTransaction Sum (133.2ms)[0m  [1m[34mSELECT SUM("transactions"."discount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:33:in `generate_report'
  [1m[36mTransaction Count (136.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:34:in `generate_report'
  [1m[36mTransaction Count (135.1ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."payment_method" AS "transactions_payment_method" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."payment_method"[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:35:in `generate_report'
  [1m[36mTransaction Count (134.5ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."status" AS "transactions_status" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."status"[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:36:in `generate_report'
Completed 200 OK in 1275ms (Views: 4.9ms | ActiveRecord: 958.6ms (5 queries, 0 cached) | GC: 0.8ms)


  [1m[36mTransaction Load (138.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mTransaction Load (137.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 /* loading for pp */ LIMIT $3[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"], ["LIMIT", 11]]
  [1m[36mTransaction Pluck (509.7ms)[0m  [1m[34mSELECT "transactions"."date" FROM "transactions"[0m
Started GET "/reports/monthly" for ::1 at 2025-04-13 16:07:32 +0500
Processing by ReportsController#monthly as */*
  [1m[36mTransaction Sum (135.8ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-01 00:00:00"], ["date", "2025-04-30 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:32:in `generate_report'
  [1m[36mTransaction Sum (133.1ms)[0m  [1m[34mSELECT SUM("transactions"."discount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-01 00:00:00"], ["date", "2025-04-30 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:33:in `generate_report'
  [1m[36mTransaction Count (133.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-01 00:00:00"], ["date", "2025-04-30 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:34:in `generate_report'
  [1m[36mTransaction Count (133.0ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."payment_method" AS "transactions_payment_method" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."payment_method"[0m  [["date", "2025-04-01 00:00:00"], ["date", "2025-04-30 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:35:in `generate_report'
  [1m[36mTransaction Count (136.8ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."status" AS "transactions_status" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."status"[0m  [["date", "2025-04-01 00:00:00"], ["date", "2025-04-30 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:36:in `generate_report'
Completed 200 OK in 690ms (Views: 0.5ms | ActiveRecord: 671.8ms (5 queries, 0 cached) | GC: 0.4ms)


Started GET "/reports/yearly" for ::1 at 2025-04-13 16:07:59 +0500
Processing by ReportsController#yearly as */*
  [1m[36mTransaction Sum (133.8ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:32:in `generate_report'
  [1m[36mTransaction Sum (132.4ms)[0m  [1m[34mSELECT SUM("transactions"."discount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:33:in `generate_report'
  [1m[36mTransaction Count (132.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:34:in `generate_report'
  [1m[36mTransaction Count (133.6ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."payment_method" AS "transactions_payment_method" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."payment_method"[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:35:in `generate_report'
  [1m[36mTransaction Count (133.0ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."status" AS "transactions_status" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."status"[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:36:in `generate_report'
Completed 200 OK in 681ms (Views: 0.4ms | ActiveRecord: 665.1ms (5 queries, 0 cached) | GC: 0.8ms)


Started POST "/transactions/" for ::1 at 2025-04-13 16:08:27 +0500
Processing by TransactionsController#create as */*
  Parameters: {"transaction"=>{"user_id"=>1, "customer_id"=>1, "date"=>"2025-04-13", "total_amount"=>500.0, "discount"=>50.0, "payment_method"=>"mpesa", "status"=>"Completed", "mpesa_transaction_id"=>"12345ABC", "transaction_data"=>[{"product_id"=>3, "quantity"=>2, "price"=>100}, {"product_id"=>2, "quantity"=>1, "price"=>200}], "mpesa_transaction_attributes"=>{"total_amount"=>500.0, "code"=>"ABC123", "status"=>"Success", "date"=>"2025-04-09"}}}
  [1m[36mMpesaTransaction Load (133.1ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" = $1 LIMIT $2[0m  [["id", 12345], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:18:in `create'
  [1m[36mTRANSACTION (133.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mUser Load (136.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mCustomer Load (138.6ms)[0m  [1m[34mSELECT "customers".* FROM "customers" WHERE "customers"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mMpesaTransaction Create (134.1ms)[0m  [1m[32mINSERT INTO "mpesa_transactions" ("total_amount", "code", "status", "date", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["total_amount", "500.0"], ["code", "ABC123"], ["status", "Success"], ["date", "2025-04-09 00:00:00"], ["created_at", "2025-04-13 11:08:29.754765"], ["updated_at", "2025-04-13 11:08:29.754765"]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTransaction Create (135.1ms)[0m  [1m[32mINSERT INTO "transactions" ("user_id", "customer_id", "date", "total_amount", "discount", "payment_method", "status", "mpesa_transaction_id", "created_at", "updated_at", "quantity") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["user_id", 1], ["customer_id", 1], ["date", "2025-04-13 00:00:00"], ["total_amount", "500.0"], ["discount", "50.0"], ["payment_method", "mpesa"], ["status", "Completed"], ["mpesa_transaction_id", 7], ["created_at", "2025-04-13 11:08:29.892768"], ["updated_at", "2025-04-13 11:08:29.892768"], ["quantity", nil]]
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:19:in `create'
  [1m[36mTRANSACTION (132.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (133.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (133.6ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at", "price") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["transaction_record_id", 23], ["product_id", 3], ["quantity", 2], ["created_at", "2025-04-13 11:08:30.992290"], ["updated_at", "2025-04-13 11:08:30.992290"], ["price", "100.0"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (132.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (134.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (131.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (268.5ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 87], ["updated_at", "2025-04-13 11:08:31.951422"], ["id", 3]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (133.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (136.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (132.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (132.9ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 3], ["change_quantity", -2], ["date", "2025-04-13 11:08:32.363008"], ["reason", "Sold in transaction 23"], ["created_at", "2025-04-13 11:08:33.194146"], ["updated_at", "2025-04-13 11:08:33.194146"], ["sales_transaction_id", 23]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (132.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (131.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransaction Load (132.6ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTransactionItem Create (133.9ms)[0m  [1m[32mINSERT INTO "transaction_items" ("transaction_record_id", "product_id", "quantity", "created_at", "updated_at", "price") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["transaction_record_id", 23], ["product_id", 2], ["quantity", 1], ["created_at", "2025-04-13 11:08:33.735197"], ["updated_at", "2025-04-13 11:08:33.735197"], ["price", "200.0"]]
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mTRANSACTION (135.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:21:in `block in create'
  [1m[36mProduct Load (133.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:22:in `block in create'
  [1m[36mTRANSACTION (478.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mProduct Update (614.4ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 88], ["updated_at", "2025-04-13 11:08:34.287375"], ["id", 2]]
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (133.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:23:in `block in create'
  [1m[36mTRANSACTION (131.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mProduct Load (132.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mInventoryLog Create (133.1ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 2], ["change_quantity", -1], ["date", "2025-04-13 11:08:35.039577"], ["reason", "Sold in transaction 23"], ["created_at", "2025-04-13 11:08:35.310629"], ["updated_at", "2025-04-13 11:08:35.310629"], ["sales_transaction_id", 23]]
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTRANSACTION (133.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/transactions_controller.rb:24:in `block in create'
  [1m[36mTransactionItem Load (133.3ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 23]]
  ↳ app/controllers/transactions_controller.rb:27:in `create'
Completed 201 Created in 8508ms (Views: 140.1ms | ActiveRecord: 8614.7ms (18 queries, 0 cached) | GC: 40.2ms)


Started GET "/reports/daily" for ::1 at 2025-04-13 16:08:49 +0500
Processing by ReportsController#daily as */*
  [1m[36mTransaction Sum (132.8ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:32:in `generate_report'
  [1m[36mTransaction Sum (133.1ms)[0m  [1m[34mSELECT SUM("transactions"."discount") FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:33:in `generate_report'
  [1m[36mTransaction Count (132.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:34:in `generate_report'
  [1m[36mTransaction Count (134.5ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."payment_method" AS "transactions_payment_method" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."payment_method"[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:35:in `generate_report'
  [1m[36mTransaction Count (133.9ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "transactions"."status" AS "transactions_status" FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 GROUP BY "transactions"."status"[0m  [["date", "2025-04-13 00:00:00"], ["date", "2025-04-13 23:59:59.999999"]]
  ↳ app/controllers/reports_controller.rb:36:in `generate_report'
Completed 200 OK in 683ms (Views: 0.5ms | ActiveRecord: 666.4ms (5 queries, 0 cached) | GC: 0.4ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (150.0ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (137.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (137.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateBusinesses (20250413133713)
  [1m[36mTRANSACTION (135.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (169.9ms)[0m  [1m[35mCREATE TABLE "businesses" ("id" bigserial primary key, "name" character varying, "description" text, "address" character varying, "phone" character varying, "email" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (503.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133713') RETURNING "version"[0m
  [1m[36mTRANSACTION (137.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToProducts (20250413133737)
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (276.1ms)[0m  [1m[35mALTER TABLE "products" ADD "business_id" bigint NOT NULL[0m
  [1m[36mTRANSACTION (135.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (496.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (138.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (138.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (137.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (135.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateBusinesses (20250413133713)
  [1m[36mTRANSACTION (133.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (279.9ms)[0m  [1m[35mDROP TABLE "businesses"[0m
  [1m[36mActiveRecord::SchemaMigration Destroy (132.8ms)[0m  [1m[31mDELETE FROM "schema_migrations" WHERE "schema_migrations"."version" = '20250413133713'[0m
  [1m[36mTRANSACTION (139.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (501.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (134.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (136.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (153.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (139.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateBusinesses (20250413133713)
  [1m[36mTRANSACTION (135.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (168.1ms)[0m  [1m[35mCREATE TABLE "businesses" ("id" bigserial primary key, "name" character varying, "description" text, "address" character varying, "phone" character varying, "email" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (137.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133713') RETURNING "version"[0m
  [1m[36mTRANSACTION (137.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToProducts (20250413133737)
  [1m[36mTRANSACTION (136.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (283.1ms)[0m  [1m[35mALTER TABLE "products" ADD "business_id" bigint[0m
  [1m[35m (140.0ms)[0m  [1m[35mCREATE INDEX "index_products_on_business_id" ON "products" ("business_id")[0m
  [1m[35m (144.7ms)[0m  [1m[35mALTER TABLE "products" ADD CONSTRAINT "fk_rails_64b1679e02"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (137.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133737') RETURNING "version"[0m
  [1m[36mTRANSACTION (141.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToCustomers (20250413133741)
  [1m[36mTRANSACTION (138.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (278.0ms)[0m  [1m[35mALTER TABLE "customers" ADD "business_id" bigint[0m
  [1m[35m (152.6ms)[0m  [1m[35mCREATE INDEX "index_customers_on_business_id" ON "customers" ("business_id")[0m
  [1m[35m (156.9ms)[0m  [1m[35mALTER TABLE "customers" ADD CONSTRAINT "fk_rails_b73113df4b"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (137.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133741') RETURNING "version"[0m
  [1m[36mTRANSACTION (140.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToTransactions (20250413133747)
  [1m[36mTRANSACTION (511.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (649.7ms)[0m  [1m[35mALTER TABLE "transactions" ADD "business_id" bigint[0m
  [1m[35m (140.8ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_business_id" ON "transactions" ("business_id")[0m
  [1m[35m (139.1ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_410128cf7a"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (137.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133747') RETURNING "version"[0m
  [1m[36mTRANSACTION (138.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToUsers (20250413133751)
  [1m[36mTRANSACTION (139.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (279.2ms)[0m  [1m[35mALTER TABLE "users" ADD "business_id" bigint[0m
  [1m[35m (142.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_business_id" ON "users" ("business_id")[0m
  [1m[35m (146.5ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT "fk_rails_ffa8fa13ef"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (141.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133751') RETURNING "version"[0m
  [1m[36mTRANSACTION (139.5ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddBusinessToProductCategories (20250413133755)
  [1m[36mTRANSACTION (143.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (301.3ms)[0m  [1m[35mALTER TABLE "product_categories" ADD "business_id" bigint[0m
  [1m[35m (139.2ms)[0m  [1m[35mCREATE INDEX "index_product_categories_on_business_id" ON "product_categories" ("business_id")[0m
  [1m[35m (144.2ms)[0m  [1m[35mALTER TABLE "product_categories" ADD CONSTRAINT "fk_rails_d08cd985f2"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (138.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250413133755') RETURNING "version"[0m
  [1m[36mTRANSACTION (139.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (137.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (140.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mUser Load (153.3ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (142.0ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (143.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (139.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to RenamePriceAndAddSellingPriceToProducts (20250418150022)
  [1m[36mTRANSACTION (137.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (298.9ms)[0m  [1m[35mALTER TABLE "products" RENAME COLUMN "price" TO "buying_price"[0m
  [1m[35m (140.6ms)[0m  [1m[35mALTER TABLE "products" ADD "selling_price" decimal[0m
  [1m[36mActiveRecord::SchemaMigration Create (140.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250418150022') RETURNING "version"[0m
  [1m[36mTRANSACTION (141.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (138.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (143.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (136.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (139.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (141.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to MakeCustomerOptionalInTransactions (20250418150904)
  [1m[36mTRANSACTION (135.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (277.4ms)[0m  [1m[35mALTER TABLE "transactions" ALTER COLUMN "customer_id" DROP NOT NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (152.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250418150904') RETURNING "version"[0m
  [1m[36mTRANSACTION (138.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (136.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (138.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/inventory_logs" for ::1 at 2025-04-22 20:28:47 +0500
  [1m[36mActiveRecord::SchemaMigration Load (138.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by InventoryLogsController#index as */*
  [1m[36mInventoryLog Load (4110.0ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
  [1m[36mProduct Load (162.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16)[0m  [["id", 11], ["id", 3], ["id", 2], ["id", 12], ["id", 4], ["id", 8], ["id", 1], ["id", 13], ["id", 14], ["id", 15], ["id", 10], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20]]
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
Completed 200 OK in 6057ms (Views: 1.2ms | ActiveRecord: 7173.8ms (2 queries, 0 cached) | GC: 0.0ms)


Started GET "/inventory_logs" for ::1 at 2025-05-07 22:05:44 +0500
Processing by InventoryLogsController#index as */*
  [1m[36mInventoryLog Load (4867.9ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
Completed 500 Internal Server Error in 4873ms (ActiveRecord: 4867.9ms (1 query, 0 cached) | GC: 0.6ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
)
  
app/controllers/inventory_logs_controller.rb:8:in `index'
Started GET "/inventory_logs" for ::1 at 2025-05-07 22:13:27 +0500
Processing by InventoryLogsController#index as */*
  [1m[36mInventoryLog Load (2391.5ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
Completed 500 Internal Server Error in 2394ms (ActiveRecord: 2391.5ms (1 query, 0 cached) | GC: 0.0ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.108.251.216", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.108.251.216", port 5432 failed: FATAL:  Tenant or user not found
):

Causes:
PG::ConnectionBad (connection to server at "3.108.251.216", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.108.251.216", port 5432 failed: FATAL:  Tenant or user not found
)
  
app/controllers/inventory_logs_controller.rb:8:in `index'
Started GET "/inventory_logs" for ::1 at 2025-05-07 22:13:32 +0500
Processing by InventoryLogsController#index as */*
  [1m[36mInventoryLog Load (3048.1ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
Completed 500 Internal Server Error in 3052ms (ActiveRecord: 3048.0ms (1 query, 0 cached) | GC: 0.3ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
connection to server at "3.111.105.85", port 5432 failed: FATAL:  Tenant or user not found
)
  
app/controllers/inventory_logs_controller.rb:8:in `index'
Started GET "/inventory_logs" for ::1 at 2025-05-07 22:20:00 +0500
Processing by InventoryLogsController#index as */*
  [1m[36mInventoryLog Load (3860.5ms)[0m  [1m[34mSELECT "inventory_logs".* FROM "inventory_logs"[0m
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
  [1m[36mProduct Load (250.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16)[0m  [["id", 11], ["id", 3], ["id", 2], ["id", 12], ["id", 4], ["id", 8], ["id", 1], ["id", 13], ["id", 14], ["id", 15], ["id", 10], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20]]
  ↳ app/controllers/inventory_logs_controller.rb:8:in `index'
Completed 200 OK in 4130ms (Views: 1.2ms | ActiveRecord: 6040.9ms (2 queries, 0 cached) | GC: 0.6ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (138.4ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (141.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (140.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to CreateRoles (20250509024426)
  [1m[36mTRANSACTION (136.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (206.6ms)[0m  [1m[35mCREATE TABLE "roles" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (136.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250509024426') RETURNING "version"[0m
  [1m[36mTRANSACTION (137.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreatePermissions (20250509024430)
  [1m[36mTRANSACTION (135.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (288.6ms)[0m  [1m[35mCREATE TABLE "permissions" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (215.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250509024430') RETURNING "version"[0m
  [1m[36mTRANSACTION (136.8ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateRolesUsers (20250509024433)
  [1m[36mTRANSACTION (136.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (285.3ms)[0m  [1m[35mCREATE TABLE "roles_users" ("id" bigserial primary key, "user_id" bigint NOT NULL, "role_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_e2a7142459"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
, CONSTRAINT "fk_rails_9dada905f6"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
)[0m
  [1m[35m (139.2ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_user_id" ON "roles_users" ("user_id")[0m
  [1m[35m (139.9ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_role_id" ON "roles_users" ("role_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (135.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250509024433') RETURNING "version"[0m
  [1m[36mTRANSACTION (137.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreatePermissionsRoles (20250509024437)
  [1m[36mTRANSACTION (135.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (281.5ms)[0m  [1m[35mCREATE TABLE "permissions_roles" ("id" bigserial primary key, "role_id" bigint NOT NULL, "permission_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_211043a277"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
, CONSTRAINT "fk_rails_7cc0b02d7d"
FOREIGN KEY ("permission_id")
  REFERENCES "permissions" ("id")
)[0m
  [1m[35m (142.2ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_role_id" ON "permissions_roles" ("role_id")[0m
  [1m[35m (141.9ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_permission_id" ON "permissions_roles" ("permission_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (135.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250509024437') RETURNING "version"[0m
  [1m[36mTRANSACTION (138.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (136.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (136.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mTRANSACTION (149.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRole Create (303.2ms)[0m  [1m[32mINSERT INTO "roles" ("name", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "inventory_clerk"], ["created_at", "2025-05-09 02:53:50.602322"], ["updated_at", "2025-05-09 02:53:50.602322"]]
  [1m[36mTRANSACTION (150.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (153.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (149.8ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."name" = $1 LIMIT $2[0m  [["name", "inventory_clerk"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (153.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRolesUser Create (156.1ms)[0m  [1m[32mINSERT INTO "roles_users" ("user_id", "role_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 1], ["role_id", 1], ["created_at", "2025-05-09 02:55:23.586573"], ["updated_at", "2025-05-09 02:55:23.586573"]]
  [1m[36mTRANSACTION (150.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRole Load (150.6ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mRole Exists? (300.7ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  [1m[36mRole Load (152.4ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mBusiness Load (137.2ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" ORDER BY "businesses"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (136.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBusiness Create (275.9ms)[0m  [1m[32mINSERT INTO "businesses" ("name", "description", "address", "phone", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "Example Business"], ["description", "A business description here"], ["address", "123 Business St."], ["phone", "123-456-7890"], ["email", "[FILTERED]"], ["created_at", "2025-05-09 03:05:59.126706"], ["updated_at", "2025-05-09 03:05:59.126706"]]
  [1m[36mTRANSACTION (136.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (254.5ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (158.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (311.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (137.8ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "business_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2025-05-09 03:06:15.262339"], ["business_id", 1], ["id", 1]]
  [1m[36mTRANSACTION (177.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (180.7ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mBusiness Load (141.9ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started POST "/auth/register" for ::1 at 2025-05-09 08:08:22 +0500
  [1m[36mActiveRecord::SchemaMigration Load (138.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
NameError (uninitialized constant ApplicationController::CanCan):
  
app/controllers/application_controller.rb:4:in `<class:ApplicationController>'
app/controllers/application_controller.rb:1:in `<main>'
app/controllers/auth_controller.rb:1:in `<main>'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/auth/google" for ::1 at 2025-05-09 08:09:53 +0500
  [1m[36mActiveRecord::SchemaMigration Load (137.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#google_login as */*
Redirected to https://ceobcatjwmrilokphmtu.supabase.co/auth/v1/authorize?provider=google&redirect_to=http://localhost:3000/auth/callback
Completed 302 Found in 10ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.4ms)


Started POST "/auth/login" for ::1 at 2025-05-09 08:10:07 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 620ms (Views: 0.8ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-09 08:10:52 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 25633ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 19.2ms)


Started GET "/users" for ::1 at 2025-05-09 08:11:46 +0500
  
AbstractController::ActionNotFound (The action 'index' could not be found for UsersController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/users" for ::1 at 2025-05-09 08:11:47 +0500
  
AbstractController::ActionNotFound (The action 'index' could not be found for UsersController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/users" for ::1 at 2025-05-09 08:12:02 +0500
Processing by UsersController#index as */*
Completed 500 Internal Server Error in 70608ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 14.7ms)


  
NameError (undefined local variable or method `current_user' for #<UsersController:0x00000000032d48>):
  
app/controllers/users_controller.rb:8:in `index'
Started GET "/customers" for ::1 at 2025-05-09 08:13:20 +0500
Processing by CustomersController#index as */*
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


  
NameError (undefined local variable or method `current_user' for #<CustomersController:0x0000000003a5c0>):
  
cancancan (3.6.1) lib/cancan/controller_additions.rb:359:in `current_ability'
cancancan (3.6.1) lib/cancan/controller_resource.rb:138:in `current_ability'
cancancan (3.6.1) lib/cancan/controller_resource.rb:78:in `load_collection?'
cancancan (3.6.1) lib/cancan/controller_resource_loader.rb:19:in `load_resource'
cancancan (3.6.1) lib/cancan/controller_resource.rb:33:in `load_and_authorize_resource'
cancancan (3.6.1) lib/cancan/controller_resource.rb:17:in `block in add_before_action'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:429:in `instance_exec'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:429:in `block in make_lambda'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:179:in `block in call'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:180:in `call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `block in invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `each'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:559:in `invoke_before'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:119:in `block in run_callbacks'
turbo-rails (2.0.13) lib/turbo-rails.rb:24:in `with_request_id'
turbo-rails (2.0.13) app/controllers/concerns/turbo/request_id_tracking.rb:10:in `turbo_tracking_request_id'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `block in run_callbacks'
actiontext (7.2.2.1) lib/action_text/rendering.rb:25:in `with_renderer'
actiontext (7.2.2.1) lib/action_text/engine.rb:71:in `block (4 levels) in <class:Engine>'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `instance_exec'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:130:in `block in run_callbacks'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:141:in `run_callbacks'
actionpack (7.2.2.1) lib/abstract_controller/callbacks.rb:260:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/rescue.rb:27:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:77:in `block in process_action'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `block in instrument'
activesupport (7.2.2.1) lib/active_support/notifications/instrumenter.rb:58:in `instrument'
activesupport (7.2.2.1) lib/active_support/notifications.rb:210:in `instrument'
actionpack (7.2.2.1) lib/action_controller/metal/instrumentation.rb:76:in `process_action'
actionpack (7.2.2.1) lib/action_controller/metal/params_wrapper.rb:259:in `process_action'
activerecord (7.2.2.1) lib/active_record/railties/controller_runtime.rb:39:in `process_action'
actionpack (7.2.2.1) lib/abstract_controller/base.rb:163:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/customers" for ::1 at 2025-05-09 08:17:12 +0500
Processing by CustomersController#index as */*
  [1m[36mUser Load (131.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:19:in `set_current_user'
  [1m[36mUser Load (144.0ms)[0m  [1m[34mSELECT "users".* FROM "users" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (137.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (276.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (138.5ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = $1, "supabase_id" = $2 WHERE "users"."id" = $3[0m  [["updated_at", "2025-05-09 03:18:57.396451"], ["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["id", 1]]
  [1m[36mTRANSACTION (137.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mRole Exists? (264.3ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:7:in `initialize'
Completed 403 Forbidden in 115489ms (Views: 0.4ms | ActiveRecord: 3190.8ms (2 queries, 0 cached) | GC: 42.2ms)


Started GET "/customers" for ::1 at 2025-05-09 08:19:15 +0500
Processing by CustomersController#index as */*
  [1m[36mUser Load (133.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:19:in `set_current_user'
  [1m[36mRole Exists? (267.0ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:7:in `initialize'
  [1m[36mRole Load (132.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Completed 403 Forbidden in 20780ms (Views: 0.1ms | ActiveRecord: 532.6ms (3 queries, 0 cached) | GC: 24.6ms)


  [1m[36mUser Load (139.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (138.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
Started GET "/customers" for ::1 at 2025-05-09 08:20:12 +0500
Processing by CustomersController#index as */*
  [1m[36mUser Load (134.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:19:in `set_current_user'
  [1m[36mRole Exists? (264.8ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:7:in `initialize'
  [1m[36mRole Load (132.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mCustomer Load (136.2ms)[0m  [1m[34mSELECT "customers".* FROM "customers"[0m
  ↳ app/controllers/customers_controller.rb:10:in `index'
Completed 200 OK in 12269ms (Views: 61.7ms | ActiveRecord: 2544.1ms (4 queries, 0 cached) | GC: 76.0ms)


Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:32:40 +0500
  
AbstractController::ActionNotFound (The action 'grouped_by_category_and_payment_method' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:32:46 +0500
  
AbstractController::ActionNotFound (The action 'grouped_by_category_and_payment_method' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:32:47 +0500
  
AbstractController::ActionNotFound (The action 'grouped_by_category_and_payment_method' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:32:48 +0500
  
AbstractController::ActionNotFound (The action 'grouped_by_category_and_payment_method' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:33:17 +0500
  
AbstractController::ActionNotFound (The action 'grouped_by_category_and_payment_method' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:25 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:26 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:26 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:26 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:28 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:28 +0500
  
AbstractController::ActionNotFound (The action 'daily_by_category' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:33:56 +0500
Processing by ReportsController#daily_by_category as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Completed 500 Internal Server Error in 12354ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 7.9ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/reports_controller.rb:128:in `daily_by_category'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:34:21 +0500
Processing by ReportsController#daily_by_category as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 7.7ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/reports_controller.rb:128:in `daily_by_category'
Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:34:45 +0500
Processing by ReportsController#daily_by_category as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mTransaction Load (139.7ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 AND "transactions"."business_id" = $3[0m  [["date", "2025-05-09 00:00:00"], ["date", "2025-05-09 23:59:59.999999"], ["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:132:in `daily_by_category'
Completed 200 OK in 5024ms (Views: 0.6ms | ActiveRecord: 1925.6ms (2 queries, 0 cached) | GC: 0.3ms)


Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:35:04 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (160.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mTransaction Load (135.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Completed 200 OK in 1190ms (Views: 0.4ms | ActiveRecord: 296.7ms (2 queries, 0 cached) | GC: 0.0ms)


  [1m[36mTransaction Update All (2223.3ms)[0m  [1m[33mUPDATE "transactions" SET "business_id" = $1[0m  [["business_id", 1]]
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:35:50 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mTransaction Load (137.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (151.4ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Completed 500 Internal Server Error in 2214ms (ActiveRecord: 1247.1ms (3 queries, 0 cached) | GC: 11.7ms)


  
ActiveRecord::AssociationNotFoundError (Association named 'product' was not found on TransactionItem; perhaps you misspelled it?):
  
app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:36:19 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (136.7ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (141.1ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Completed 500 Internal Server Error in 3098ms (ActiveRecord: 2061.5ms (3 queries, 0 cached) | GC: 2.9ms)


  
ActiveRecord::AssociationNotFoundError (Association named 'products' was not found on TransactionItem; perhaps you misspelled it?):
  
app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:36:43 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (137.8ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (138.9ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
Completed 500 Internal Server Error in 3143ms (ActiveRecord: 2066.6ms (3 queries, 0 cached) | GC: 2.8ms)


  
NoMethodError (undefined method `product' for #<TransactionItem id: 18, transaction_record_id: 22, product_id: 3, quantity: 2, created_at: "2025-04-13 11:04:00.698354000 +0000", updated_at: "2025-04-13 11:04:00.698354000 +0000", price: 0.1e3>):
  
app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
app/controllers/reports_controller.rb:55:in `block in grouped_by_category_and_payment_method'
app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (136.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" ORDER BY "transaction_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTransactionItem Load (146.3ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" ORDER BY "transaction_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTransactionItem Load (135.5ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" ORDER BY "transaction_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (138.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:38:11 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (138.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (137.0ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mProduct Load (137.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (137.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (137.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (135.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (142.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (135.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
Completed 200 OK in 5408ms (Views: 0.3ms | ActiveRecord: 3579.3ms (24 queries, 14 cached) | GC: 49.1ms)


  [1m[36mTransactionItem Load (136.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" ORDER BY "transaction_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (135.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mProductCategory Load (137.2ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTransactionItem Load (160.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" ORDER BY "transaction_items"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProduct Load (136.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mProductCategory Load (135.4ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started GET "/reports/grouped_by_category_and_payment_method" for ::1 at 2025-05-09 08:39:50 +0500
Processing by ReportsController#grouped_by_category_and_payment_method as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (140.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (137.0ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE 1=1 AND "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mTransactionItem Load (138.5ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:54:in `grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProductCategory Load (137.8ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (137.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProductCategory Load (136.4ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (2.6ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.1ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (143.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mProduct Load (136.8ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:56:in `block (2 levels) in grouped_by_category_and_payment_method'
Completed 200 OK in 7052ms (Views: 0.7ms | ActiveRecord: 4400.0ms (45 queries, 33 cached) | GC: 22.8ms)


Started GET "/reports/yearly_by_category" for ::1 at 2025-05-09 08:40:21 +0500
Processing by ReportsController#yearly_by_category as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mTransaction Load (137.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 AND "transactions"."business_id" = $3[0m  [["date", "2025-01-01 00:00:00"], ["date", "2025-12-31 23:59:59.999999"], ["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:95:in `yearly_by_category'
  [1m[36mTransactionItem Load (149.3ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/reports_controller.rb:95:in `yearly_by_category'
  [1m[36mProduct Load (164.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/reports_controller.rb:95:in `yearly_by_category'
  [1m[36mProductCategory Load (137.3ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mProductCategory Load (137.7ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mCACHE ProductCategory Load (0.6ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
  [1m[36mCACHE ProductCategory Load (0.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" WHERE "product_categories"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/reports_controller.rb:98:in `block (2 levels) in yearly_by_category'
Completed 200 OK in 1687ms (Views: 0.3ms | ActiveRecord: 862.5ms (11 queries, 5 cached) | GC: 1.6ms)


Started GET "/reports/daily_by_category" for ::1 at 2025-05-09 08:40:36 +0500
Processing by ReportsController#daily_by_category as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "report"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mTransaction Load (148.1ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."date" BETWEEN $1 AND $2 AND "transactions"."business_id" = $3[0m  [["date", "2025-05-09 00:00:00"], ["date", "2025-05-09 23:59:59.999999"], ["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:132:in `daily_by_category'
Completed 200 OK in 799ms (Views: 0.5ms | ActiveRecord: 284.3ms (2 queries, 0 cached) | GC: 0.2ms)


Started POST "/auth/register" for ::1 at 2025-05-10 01:04:29 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"John Doe", "business"=>{"name"=>"Doe Enterprises", "industry"=>"Retail", "address"=>"123 Main St", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"John Doe", "business"=>{"name"=>"Doe Enterprises", "industry"=>"Retail", "address"=>"123 Main St", "country"=>"USA"}}}
Completed 422 Unprocessable Content in 3657ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-05-10 01:04:44 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"John Doe", "business"=>{"name"=>"Doe Enterprises", "industry"=>"Retail", "address"=>"123 Main St", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"John Doe", "business"=>{"name"=>"Doe Enterprises", "industry"=>"Retail", "address"=>"123 Main St", "country"=>"USA"}}}
Completed 422 Unprocessable Content in 878ms (Views: 0.4ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-05-10 01:05:26 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}}
Completed 500 Internal Server Error in 6398ms (ActiveRecord: 1926.7ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):
  
app/controllers/auth_controller.rb:19:in `register'
Started POST "/auth/register" for ::1 at 2025-05-10 01:09:52 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}}
Completed 500 Internal Server Error in 4300ms (ActiveRecord: 857.8ms (0 queries, 0 cached) | GC: 0.7ms)


  
ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):
  
app/controllers/auth_controller.rb:17:in `register'
Started POST "/auth/register" for ::1 at 2025-05-10 01:13:53 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}}
[31mUnpermitted parameters: :industry, :country. Context: { controller: AuthController, action: register, request: #<ActionDispatch::Request:0x000000010cade758>, params: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "controller"=>"auth", "action"=>"register", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}} }[0m
  [1m[36mTRANSACTION (479.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:29:in `register'
  [1m[36mUser Exists? (628.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:29:in `register'
  [1m[36mUser Create (150.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id", "business_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test User"], ["email", "[FILTERED]"], ["phone", "1234567890"], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-05-09 20:13:59.746760"], ["updated_at", "2025-05-09 20:13:59.746760"], ["supabase_id", "5b527467-7733-4c60-8e70-9e50deac0acb"], ["business_id", nil]]
  ↳ app/controllers/auth_controller.rb:29:in `register'
  [1m[36mTRANSACTION (140.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:29:in `register'
Completed 201 Created in 6441ms (Views: 0.9ms | ActiveRecord: 2964.6ms (2 queries, 0 cached) | GC: 1.7ms)


  [1m[36mBusiness Load (523.2ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mBusiness Count (539.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "businesses"[0m
Started POST "/auth/register" for ::1 at 2025-05-10 01:14:54 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}}
[31mUnpermitted parameters: :industry, :country. Context: { controller: AuthController, action: register, request: #<ActionDispatch::Request:0x000000010bcc1f58>, params: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}, "controller"=>"auth", "action"=>"register", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "industry"=>"IT", "address"=>"456 Test Ave", "country"=>"USA"}}} }[0m
  [1m[36mTRANSACTION (139.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:30:in `register'
  [1m[36mUser Exists? (285.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:30:in `register'
  [1m[36mTRANSACTION (139.8ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/auth_controller.rb:30:in `register'
Completed 422 Unprocessable Content in 25310ms (Views: 0.4ms | ActiveRecord: 1983.2ms (1 query, 0 cached) | GC: 43.1ms)


  [1m[36mBusiness Count (137.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "businesses"[0m
  [1m[36mBusiness Count (137.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "businesses"[0m
Started POST "/auth/register" for ::1 at 2025-05-10 01:17:12 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (150.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:20:in `register'
  [1m[36mBusiness Create (295.9ms)[0m  [1m[32mINSERT INTO "businesses" ("name", "description", "address", "phone", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["name", "TestCorp"], ["description", "A business description here"], ["address", nil], ["phone", "123-456-7890"], ["email", "[FILTERED]"], ["created_at", "2025-05-09 20:17:19.528525"], ["updated_at", "2025-05-09 20:17:19.528525"]]
  ↳ app/controllers/auth_controller.rb:20:in `register'
  [1m[36mTRANSACTION (141.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:20:in `register'
  [1m[36mTRANSACTION (140.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:30:in `register'
  [1m[36mUser Exists? (283.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:30:in `register'
  [1m[36mUser Create (141.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id", "business_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test User"], ["email", "[FILTERED]"], ["phone", "1234567890"], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-05-09 20:17:20.843321"], ["updated_at", "2025-05-09 20:17:20.843321"], ["supabase_id", "9d94398a-abc7-426a-9e2c-eb0909493ecd"], ["business_id", 2]]
  ↳ app/controllers/auth_controller.rb:30:in `register'
  [1m[36mTRANSACTION (142.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:30:in `register'
Completed 201 Created in 8881ms (Views: 0.9ms | ActiveRecord: 2720.1ms (3 queries, 0 cached) | GC: 31.3ms)


  [1m[36mBusiness Load (137.0ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/roles/" for ::1 at 2025-05-10 01:43:59 +0500
Processing by RolesController#create as */*
  Parameters: {"role"=>{"name"=>"test role", "description"=>"Can manage inventory and staff"}}
Completed 500 Internal Server Error in 2738ms (ActiveRecord: 1660.6ms (0 queries, 0 cached) | GC: 0.2ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'description' for Role.):

Causes:
NoMethodError (undefined method `description=' for #<Role id: nil, name: "test role", created_at: nil, updated_at: nil>)
  
app/controllers/roles_controller.rb:15:in `create'
Started POST "/roles/" for ::1 at 2025-05-10 01:44:43 +0500
Processing by RolesController#create as */*
  Parameters: {"role"=>{"name"=>"test role"}}
  [1m[36mTRANSACTION (138.8ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/roles_controller.rb:16:in `create'
  [1m[36mRole Create (287.0ms)[0m  [1m[32mINSERT INTO "roles" ("name", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["name", "test role"], ["created_at", "2025-05-09 20:44:44.233035"], ["updated_at", "2025-05-09 20:44:44.233035"]]
  ↳ app/controllers/roles_controller.rb:16:in `create'
  [1m[36mTRANSACTION (136.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/roles_controller.rb:16:in `create'
Completed 201 Created in 1263ms (Views: 0.6ms | ActiveRecord: 1387.0ms (1 query, 0 cached) | GC: 0.1ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mPermission Load (151.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#find_by_supabase_id"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (158.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#find_id_by_supabase_id"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#roles_permissions"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (150.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (157.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "users#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (154.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transactions#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (153.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transactions#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transactions#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (150.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transactions#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.5ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transactions#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (162.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transaction_items#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transaction_items#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (152.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transaction_items#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (151.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transaction_items#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "transaction_items#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (150.5ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "roles#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "roles#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "roles#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "roles#assign"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "roles#remove"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#grouped_by_category_and_payment_method"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#yearly_by_category"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#daily_by_category"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#generate_report"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#daily"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#monthly"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "reports#yearly"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "products#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "products#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "products#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "products#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "products#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (154.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "product_categories#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (521.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "product_categories#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "product_categories#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "product_categories#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (158.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "product_categories#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (158.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "permissions#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (173.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "inventory_logs#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (153.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "inventory_logs#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "inventory_logs#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (151.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "inventory_logs#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "inventory_logs#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "customers#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "customers#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "customers#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "customers#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "customers#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#new"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (151.5ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#create"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#show"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#edit"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#index"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (150.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#update"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (150.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "businesses#destroy"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (168.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "auth#google_login"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (149.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "auth#google_callback"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "auth#login"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Load (148.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 LIMIT $2[0m  [["name", "auth#register"], ["LIMIT", 1]]
  ↳ lib/tasks/permissions.rake:14:in `block (4 levels) in <main>'
  [1m[36mPermission Count (139.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "permissions"[0m
  [1m[36mPermission Load (138.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/roles/" for ::1 at 2025-05-10 15:58:22 +0500
Processing by RolesController#create as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5]}
Completed 500 Internal Server Error in 2424ms (ActiveRecord: 1240.6ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'description' for Role.):

Causes:
NoMethodError (undefined method `description=' for #<Role id: nil, name: "Editor", created_at: nil, updated_at: nil>)
  
app/controllers/roles_controller.rb:15:in `create'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (173.7ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (182.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (192.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddDescriptionToRoles (20250510105916)
  [1m[36mTRANSACTION (184.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (380.0ms)[0m  [1m[35mALTER TABLE "roles" ADD "description" text[0m
  [1m[36mActiveRecord::SchemaMigration Create (170.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250510105916') RETURNING "version"[0m
  [1m[36mTRANSACTION (183.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (588.6ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (538.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/roles/" for ::1 at 2025-05-10 16:11:46 +0500
  [1m[36mActiveRecord::SchemaMigration Load (137.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by RolesController#create as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5]}
Completed 500 Internal Server Error in 2273ms (ActiveRecord: 1175.2ms (0 queries, 0 cached) | GC: 0.2ms)


  
ActiveModel::UnknownAttributeError (unknown attribute 'description' for Role.):

Causes:
NoMethodError (undefined method `description=' for #<Role id: nil, name: "Editor", created_at: nil, updated_at: nil>)
  
app/controllers/roles_controller.rb:15:in `create'
  [1m[36mRole Load (139.5ms)[0m  [1m[34mSELECT "roles".* FROM "roles" ORDER BY "roles"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/roles/" for ::1 at 2025-05-10 16:13:06 +0500
  [1m[36mActiveRecord::SchemaMigration Load (146.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by RolesController#create as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5]}
  [1m[36mTRANSACTION (131.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/roles_controller.rb:16:in `create'
  [1m[36mRole Create (280.4ms)[0m  [1m[32mINSERT INTO "roles" ("name", "created_at", "updated_at", "description") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Editor"], ["created_at", "2025-05-10 11:13:12.923968"], ["updated_at", "2025-05-10 11:13:12.923968"], ["description", "Can edit and manage content"]]
  ↳ app/controllers/roles_controller.rb:16:in `create'
  [1m[36mTRANSACTION (132.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/roles_controller.rb:16:in `create'
  [1m[36mPermission Load (134.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3)[0m  [["id", 1], ["id", 3], ["id", 5]]
  ↳ app/controllers/roles_controller.rb:62:in `+'
  [1m[36mPermission Load (134.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 3]]
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
  [1m[36mTRANSACTION (139.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
  [1m[36mPermissionsRole Create (134.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 3], ["permission_id", 1], ["created_at", "2025-05-10 11:13:15.208942"], ["updated_at", "2025-05-10 11:13:15.208942"]]
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
  [1m[36mPermissionsRole Create (134.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 3], ["permission_id", 3], ["created_at", "2025-05-10 11:13:15.347767"], ["updated_at", "2025-05-10 11:13:15.347767"]]
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
  [1m[36mPermissionsRole Create (132.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 3], ["permission_id", 5], ["created_at", "2025-05-10 11:13:15.487813"], ["updated_at", "2025-05-10 11:13:15.487813"]]
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
  [1m[36mTRANSACTION (138.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/roles_controller.rb:71:in `assign_permissions'
Completed 201 Created in 5941ms (Views: 1.5ms | ActiveRecord: 4628.8ms (6 queries, 0 cached) | GC: 0.0ms)


Started GET "/roles/" for ::1 at 2025-05-10 16:13:24 +0500
Processing by RolesController#index as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5]}
  [1m[36mRole Load (141.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles"[0m
  ↳ app/controllers/roles_controller.rb:7:in `index'
Completed 200 OK in 147ms (Views: 3.8ms | ActiveRecord: 141.6ms (1 query, 0 cached) | GC: 0.0ms)


Started GET "/roles/1/show" for ::1 at 2025-05-10 16:13:48 +0500
  
ActionController::RoutingError (No route matches [GET] "/roles/1/show"):
  
Started GET "/roles/1/" for ::1 at 2025-05-10 16:14:07 +0500
Processing by RolesController#show as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5], "id"=>"1"}
  [1m[36mRole Load (162.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/roles_controller.rb:52:in `set_role'
  [1m[36mPermission Load (149.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  ↳ app/controllers/roles_controller.rb:11:in `show'
Completed 200 OK in 725ms (Views: 140.3ms | ActiveRecord: 311.6ms (2 queries, 0 cached) | GC: 2.5ms)


Started GET "/roles/3/" for ::1 at 2025-05-10 16:14:12 +0500
Processing by RolesController#show as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permission_ids"=>[1, 3, 5], "id"=>"3"}
  [1m[36mRole Load (138.8ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/roles_controller.rb:52:in `set_role'
  [1m[36mPermission Load (135.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 3]]
  ↳ app/controllers/roles_controller.rb:11:in `show'
Completed 200 OK in 553ms (Views: 143.3ms | ActiveRecord: 274.5ms (2 queries, 0 cached) | GC: 2.1ms)


  [1m[36mPermission Load (214.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/roles/3/" for ::1 at 2025-05-10 16:32:16 +0500
Processing by RolesController#show as */*
  Parameters: {"role"=>{"name"=>"Editor", "description"=>"Can edit and manage content"}, "permissions"=>[{"name"=>"articles#create"}, {"name"=>"articles#update"}, {"name"=>"comments#destroy"}], "id"=>"3"}
  [1m[36mRole Load (138.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/roles_controller.rb:52:in `set_role'
  [1m[36mPermission Load (135.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 3]]
  ↳ app/controllers/roles_controller.rb:11:in `show'
Completed 200 OK in 4629ms (Views: 312.0ms | ActiveRecord: 2525.7ms (2 queries, 0 cached) | GC: 0.9ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-05-11 16:31:34 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 3584ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/transaction_totals_by_type" for ::1 at 2025-05-11 16:32:06 +0500
Processing by DashboardController#transaction_totals_by_type as */*
  [1m[36mUser Load (142.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (156.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:62:in `set_business'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Sum (286.8ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") AS "sum_total_amount", "transaction_type" AS "transaction_type" FROM "transactions" WHERE "transactions"."business_id" = $1 GROUP BY "transaction_type"[0m  [["business_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:9:in `transaction_totals_by_type'
Completed 500 Internal Server Error in 7913ms (ActiveRecord: 3685.0ms (3 queries, 0 cached) | GC: 16.1ms)


  
ActiveRecord::StatementInvalid (PG::UndefinedColumn: ERROR:  column "transaction_type" does not exist
LINE 1: ...nsactions"."total_amount") AS "sum_total_amount", "transacti...
                                                             ^
):

Causes:
PG::UndefinedColumn (ERROR:  column "transaction_type" does not exist
LINE 1: ...nsactions"."total_amount") AS "sum_total_amount", "transacti...
                                                             ^
)
  
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (506.4ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" ORDER BY "transactions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/dashboard/transaction_totals_by_type" for ::1 at 2025-05-11 16:33:26 +0500
Processing by DashboardController#transaction_totals_by_type as */*
  [1m[36mUser Load (144.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (143.3ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:62:in `set_business'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Sum (519.3ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") AS "sum_total_amount", "transactions"."payment_method" AS "transactions_payment_method" FROM "transactions" WHERE "transactions"."business_id" = $1 GROUP BY "transactions"."payment_method"[0m  [["business_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:9:in `transaction_totals_by_type'
Completed 200 OK in 3275ms (Views: 0.6ms | ActiveRecord: 2229.1ms (3 queries, 0 cached) | GC: 16.7ms)


Started GET "/dashboard/sales_summary" for ::1 at 2025-05-11 16:33:51 +0500
Processing by DashboardController#sales_summary as */*
  [1m[36mUser Load (142.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (511.1ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:62:in `set_business'
  [1m[36mTransaction Sum (145.4ms)[0m  [1m[34mSELECT SUM("transactions"."total_amount") FROM "transactions" WHERE "transactions"."business_id" = $1 AND "transactions"."date" = $2[0m  [["business_id", 1], ["date", "2025-05-11"]]
  ↳ app/controllers/dashboard_controller.rb:23:in `sales_summary'
  [1m[36mTransaction Average (145.3ms)[0m  [1m[34mSELECT AVG("transactions"."total_amount") FROM "transactions" WHERE "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:24:in `sales_summary'
  [1m[36mTransaction Count (143.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "transactions" WHERE "transactions"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:25:in `sales_summary'
Completed 200 OK in 2479ms (Views: 0.3ms | ActiveRecord: 1382.5ms (5 queries, 0 cached) | GC: 0.9ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-11 16:34:22 +0500
Processing by DashboardController#recent_transactions as */*
  [1m[36mUser Load (152.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (144.6ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:61:in `set_business'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (293.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:41:in `map'
  [1m[36mUser Load (144.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:41:in `map'
Completed 200 OK in 5397ms (Views: 1.2ms | ActiveRecord: 2498.6ms (4 queries, 0 cached) | GC: 11.8ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-11 16:36:15 +0500
Processing by DashboardController#recent_transactions as */*
  [1m[36mUser Load (141.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (146.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:71:in `set_business'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (282.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:41:in `map'
  [1m[36mUser Load (141.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:41:in `map'
  [1m[36mTransactionItem Load (145.0ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 32]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mProduct Load (144.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mProduct Load (141.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mProduct Load (142.5ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (140.9ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 31]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mProduct Load (142.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (143.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 30]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mProduct Load (142.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (145.8ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 29]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mProduct Load (143.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mProduct Load (150.9ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (145.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 28]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (141.5ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 27]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (145.6ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 26]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (155.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 25]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (143.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 24]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (142.1ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 23]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (140.8ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 22]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:59:in `block (2 levels) in recent_transactions'
  [1m[36mTransactionItem Load (140.6ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1[0m  [["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:53:in `map'
Completed 200 OK in 10794ms (Views: 1.4ms | ActiveRecord: 6297.0ms (37 queries, 14 cached) | GC: 6.5ms)


  [1m[36mTransaction Load (144.1ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" ORDER BY "transactions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTransactionItem Load (140.1ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" = $1 /* loading for pp */ LIMIT $2[0m  [["transaction_record_id", 1], ["LIMIT", 11]]
Started GET "/users" for ::1 at 2025-05-11 18:14:26 +0500
Processing by UsersController#index as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "user"=>{}}
Completed 500 Internal Server Error in 1458ms (ActiveRecord: 1375.6ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/users_controller.rb:7:in `index'
Started GET "/users" for ::1 at 2025-05-11 18:14:42 +0500
Processing by UsersController#index as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "user"=>{}}
Completed 500 Internal Server Error in 827ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/users_controller.rb:7:in `index'
Started POST "/auth/login" for ::1 at 2025-05-11 18:14:49 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 953ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/users" for ::1 at 2025-05-11 18:15:02 +0500
Processing by UsersController#index as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "user"=>{}}
  [1m[36mUser Load (164.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (228.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/users_controller.rb:9:in `map'
  [1m[36mRolesUser Load (160.9ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/controllers/users_controller.rb:9:in `map'
  [1m[36mRole Load (183.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/users_controller.rb:9:in `map'
Completed 200 OK in 4008ms (Views: 0.3ms | ActiveRecord: 2662.7ms (4 queries, 0 cached) | GC: 1.4ms)


  [1m[36mUser Count (172.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mUser Count (177.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."business_category_id" = $1[0m  [["business_category_id", 1]]
  [1m[36mUser Count (227.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  [1m[36mUser Update All (188.6ms)[0m  [1m[33mUPDATE "users" SET "business_id" = $1[0m  [["business_id", 1]]
Started GET "/users" for ::1 at 2025-05-11 18:16:04 +0500
Processing by UsersController#index as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "user"=>{}}
  [1m[36mUser Load (157.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (157.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/users_controller.rb:9:in `map'
  [1m[36mRolesUser Load (178.2ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)[0m  [["user_id", 1], ["user_id", 3], ["user_id", 9], ["user_id", 11], ["user_id", 12], ["user_id", 13], ["user_id", 14], ["user_id", 15], ["user_id", 16], ["user_id", 17], ["user_id", 10]]
  ↳ app/controllers/users_controller.rb:9:in `map'
  [1m[36mRole Load (161.5ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" IN ($1, $2, $3)[0m  [["id", 1], ["id", 4], ["id", 5]]
  ↳ app/controllers/users_controller.rb:9:in `map'
Completed 200 OK in 1367ms (Views: 0.4ms | ActiveRecord: 655.0ms (4 queries, 0 cached) | GC: 0.0ms)


Started GET "/users" for ::1 at 2025-05-11 18:17:13 +0500
Processing by UsersController#index as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "user"=>{}}
  [1m[36mUser Load (156.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (189.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRolesUser Load (408.5ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)[0m  [["user_id", 1], ["user_id", 3], ["user_id", 9], ["user_id", 11], ["user_id", 12], ["user_id", 13], ["user_id", 14], ["user_id", 15], ["user_id", 16], ["user_id", 17], ["user_id", 10]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRole Load (167.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" IN ($1, $2, $3)[0m  [["id", 1], ["id", 4], ["id", 5]]
  ↳ app/controllers/users_controller.rb:8:in `map'
Completed 200 OK in 3567ms (Views: 0.4ms | ActiveRecord: 3284.7ms (4 queries, 0 cached) | GC: 1.5ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mPermission Load (149.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mPermission Load (145.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (144.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (149.5ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mPermissionsRole Load (341.8ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (147.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (145.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (149.7ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (149.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (142.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (149.2ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (151.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mPermission Load (141.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (142.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (141.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (144.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mRole Load (144.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (145.5ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (150.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (145.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (154.1ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (148.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (144.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (147.5ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (150.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (142.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mPermissionsRole Load (149.1ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (147.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
  [1m[36mRole Load (143.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" ASC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mPermissionsRole Load (149.3ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 4]]
  [1m[36mPermission Load (150.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62]]
  [1m[36mRole Load (141.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" ASC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mPermissionsRole Load (144.3ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 4]]
  [1m[36mPermission Load (146.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62]]
  [1m[36mPermission Count (145.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 4]]
  [1m[36mPermission Load (142.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mPermission Load (138.5ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (136.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (177.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (136.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (135.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mPermissionsRole Load (274.1ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" IN ($1, $2)[0m  [["role_id", 4], ["role_id", 5]]
  [1m[36mPermission Load (273.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 11], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62], ["id", 5]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mPermission Load (134.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (141.3ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (135.5ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 36], ["LIMIT", 11]]
  [1m[36mUser Load (134.8ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-05-14 21:56:58 +0500
  [1m[36mActiveRecord::SchemaMigration Load (155.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 3446ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.3ms)


Started GET "/users" for ::1 at 2025-05-14 21:57:29 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (138.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (141.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRolesUser Load (138.8ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["user_id", 3], ["user_id", 9], ["user_id", 11], ["user_id", 1], ["user_id", 17], ["user_id", 10], ["user_id", 19], ["user_id", 36]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRole Load (139.4ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" IN ($1, $2)[0m  [["id", 4], ["id", 5]]
  ↳ app/controllers/users_controller.rb:8:in `map'
Completed 200 OK in 5445ms (Views: 0.5ms | ActiveRecord: 3513.1ms (4 queries, 0 cached) | GC: 0.7ms)


Started GET "/transactions" for ::1 at 2025-05-14 21:58:21 +0500
Processing by TransactionsController#index as */*
  [1m[36mUser Load (141.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mRole Exists? (283.0ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mTransaction Load (143.2ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions"[0m
  ↳ app/controllers/transactions_controller.rb:10:in `index'
  [1m[36mTransactionItem Load (140.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/transactions_controller.rb:10:in `index'
  [1m[36mMpesaTransaction Load (146.4ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" IN ($1, $2, $3)[0m  [["id", 1], ["id", 6], ["id", 7]]
  ↳ app/controllers/transactions_controller.rb:10:in `index'
Completed 200 OK in 25709ms (Views: 60.6ms | ActiveRecord: 4199.3ms (5 queries, 0 cached) | GC: 19.4ms)


  [1m[36mRole Count (138.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mRole Load (134.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" ASC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mRole Load (136.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  [1m[36mTRANSACTION (134.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRolesUser Delete All (138.1ms)[0m  [1m[31mDELETE FROM "roles_users" WHERE "roles_users"."user_id" = $1 AND "roles_users"."role_id" IN ($2, $3)[0m  [["user_id", 1], ["role_id", 4], ["role_id", 5]]
  [1m[36mTRANSACTION (136.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (139.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (284.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (135.8ms)[0m  [1m[35mCOMMIT[0m
Started GET "/transactions" for ::1 at 2025-05-14 21:59:17 +0500
Processing by TransactionsController#index as */*
  [1m[36mUser Load (158.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mRole Exists? (277.4ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mRole Load (139.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
Completed 403 Forbidden in 1910ms (Views: 0.2ms | ActiveRecord: 574.5ms (3 queries, 0 cached) | GC: 10.6ms)


  [1m[36mRole Load (136.4ms)[0m  [1m[34mSELECT "roles".* FROM "roles" ORDER BY "roles"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (136.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" ORDER BY "roles"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (136.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1 /* loading for pp */ LIMIT $2[0m  [["role_id", 1], ["LIMIT", 11]]
  [1m[36mRole Load (134.4ms)[0m  [1m[34mSELECT "roles".* FROM "roles" ORDER BY "roles"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (137.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mRolesUser Create (286.1ms)[0m  [1m[32mINSERT INTO "roles_users" ("user_id", "role_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["user_id", 1], ["role_id", 1], ["created_at", "2025-05-14 16:59:55.642724"], ["updated_at", "2025-05-14 16:59:55.642724"]]
  [1m[36mTRANSACTION (135.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mPermission Load (134.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (139.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 /* loading for pp */ LIMIT $2[0m  [["name", "transactions#index"], ["LIMIT", 11]]
  [1m[36mPermission Load (136.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 ORDER BY "permissions"."id" DESC LIMIT $2[0m  [["name", "transactions#index"], ["LIMIT", 1]]
  [1m[36mPermission Load (136.5ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1 /* loading for pp */ LIMIT $2[0m  [["role_id", 1], ["LIMIT", 11]]
  [1m[36mTRANSACTION (135.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mPermissionsRole Create (141.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 11], ["created_at", "2025-05-14 17:00:56.873508"], ["updated_at", "2025-05-14 17:00:56.873508"]]
  [1m[36mTRANSACTION (136.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mPermission Load (138.8ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1 /* loading for pp */ LIMIT $2[0m  [["role_id", 1], ["LIMIT", 11]]
  [1m[36mTRANSACTION (142.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (277.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (134.0ms)[0m  [1m[35mCOMMIT[0m
Started GET "/transactions" for ::1 at 2025-05-14 22:01:08 +0500
Processing by TransactionsController#index as */*
  [1m[36mUser Load (138.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mRole Exists? (279.2ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mRole Load (138.6ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermissionsRole Load (140.3ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermission Load (142.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" = $1[0m  [["id", 11]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mTransaction Load (139.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions"[0m
  ↳ app/controllers/transactions_controller.rb:10:in `index'
  [1m[36mTransactionItem Load (143.3ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 1], ["transaction_record_id", 22], ["transaction_record_id", 23], ["transaction_record_id", 24], ["transaction_record_id", 25], ["transaction_record_id", 26], ["transaction_record_id", 27], ["transaction_record_id", 28], ["transaction_record_id", 29], ["transaction_record_id", 30], ["transaction_record_id", 31], ["transaction_record_id", 32]]
  ↳ app/controllers/transactions_controller.rb:10:in `index'
  [1m[36mMpesaTransaction Load (137.9ms)[0m  [1m[34mSELECT "mpesa_transactions".* FROM "mpesa_transactions" WHERE "mpesa_transactions"."id" IN ($1, $2, $3)[0m  [["id", 1], ["id", 6], ["id", 7]]
  ↳ app/controllers/transactions_controller.rb:10:in `index'
Completed 200 OK in 9862ms (Views: 24.1ms | ActiveRecord: 2375.7ms (8 queries, 0 cached) | GC: 50.2ms)


Started POST "/transactions" for ::1 at 2025-05-14 22:01:30 +0500
Processing by TransactionsController#create as */*
  [1m[36mUser Load (143.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
Completed 400 Bad Request in 680ms (ActiveRecord: 143.0ms (1 query, 0 cached) | GC: 0.0ms)


  
ActionController::ParameterMissing (param is missing or the value is empty: transaction):
  
app/controllers/transactions_controller.rb:59:in `transaction_params'
Started GET "/users" for ::1 at 2025-05-14 22:01:50 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (139.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (141.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRolesUser Load (137.8ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["user_id", 3], ["user_id", 9], ["user_id", 11], ["user_id", 1], ["user_id", 17], ["user_id", 10], ["user_id", 19], ["user_id", 36]]
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRole Load (146.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."id" IN ($1, $2, $3)[0m  [["id", 4], ["id", 5], ["id", 1]]
  ↳ app/controllers/users_controller.rb:8:in `map'
Completed 200 OK in 1614ms (Views: 0.6ms | ActiveRecord: 860.5ms (4 queries, 0 cached) | GC: 0.4ms)


Started GET "/users" for ::1 at 2025-05-14 22:02:06 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (141.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mRole Exists? (282.1ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mRole Load (141.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermissionsRole Load (144.7ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermission Load (142.1ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" = $1[0m  [["id", 11]]
  ↳ app/models/ability.rb:11:in `initialize'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
Completed 403 Forbidden in 4305ms (Views: 0.5ms | ActiveRecord: 3670.3ms (5 queries, 0 cached) | GC: 0.3ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (154.6ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (152.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (154.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
Migrating to AddReceivedAndReturnedToTransactions (20250514171240)
  [1m[36mTRANSACTION (153.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (320.0ms)[0m  [1m[35mALTER TABLE "transactions" ADD "received_amount" decimal[0m
  [1m[35m (150.7ms)[0m  [1m[35mALTER TABLE "transactions" ADD "returned_amount" decimal[0m
  [1m[36mActiveRecord::SchemaMigration Create (160.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20250514171240') RETURNING "version"[0m
  [1m[36mTRANSACTION (155.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (150.0ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (152.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/sales_summary" for ::1 at 2025-05-14 22:20:58 +0500
  [1m[36mActiveRecord::SchemaMigration Load (144.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/sales_summary"):
  
Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:11 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (139.5ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTransaction Load (284.7ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 5696ms (Views: 0.7ms | ActiveRecord: 2913.5ms (3 queries, 0 cached) | GC: 6.7ms)


Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:23 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (143.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (135.8ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (271.6ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 1229ms (Views: 0.2ms | ActiveRecord: 550.5ms (3 queries, 0 cached) | GC: 0.3ms)


Started GET "/dashboard/sales_summary'" for ::1 at 2025-05-14 22:21:27 +0500
  
ActionController::RoutingError (No route matches [GET] "/dashboard/sales_summary'"):
  
Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:31 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (139.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (137.1ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (271.8ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 1628ms (Views: 0.4ms | ActiveRecord: 548.2ms (3 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:35 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (137.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (136.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (271.2ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 1606ms (Views: 0.3ms | ActiveRecord: 544.7ms (3 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:38 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (136.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (139.1ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (274.8ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 1217ms (Views: 0.2ms | ActiveRecord: 549.7ms (3 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/sales_summary" for ::1 at 2025-05-14 22:21:40 +0500
Processing by DashboardController#sales_summary as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (135.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (146.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (274.0ms)[0m  [1m[34mSELECT SUM(CASE WHEN date = '2025-05-14' THEN total_amount ELSE 0 END) AS sales_today, AVG(total_amount) AS average_sales_value, COUNT(*) AS total_transactions FROM "transactions" WHERE "transactions"."business_id" = $1 LIMIT $2[0m  [["business_id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:22:in `sales_summary'
Completed 200 OK in 1228ms (Views: 0.4ms | ActiveRecord: 555.5ms (3 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-14 22:21:46 +0500
Processing by DashboardController#recent_transactions as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (135.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (137.0ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (140.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mUser Load (136.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mTransactionItem Load (137.7ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 32], ["transaction_record_id", 31], ["transaction_record_id", 30], ["transaction_record_id", 29], ["transaction_record_id", 28], ["transaction_record_id", 27], ["transaction_record_id", 26], ["transaction_record_id", 25], ["transaction_record_id", 24], ["transaction_record_id", 23], ["transaction_record_id", 22], ["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mProduct Load (141.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
Completed 200 OK in 3335ms (Views: 0.8ms | ActiveRecord: 2297.7ms (6 queries, 0 cached) | GC: 17.3ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-14 22:21:52 +0500
Processing by DashboardController#recent_transactions as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (144.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (136.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (140.6ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mUser Load (135.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mTransactionItem Load (142.0ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 32], ["transaction_record_id", 31], ["transaction_record_id", 30], ["transaction_record_id", 29], ["transaction_record_id", 28], ["transaction_record_id", 27], ["transaction_record_id", 26], ["transaction_record_id", 25], ["transaction_record_id", 24], ["transaction_record_id", 23], ["transaction_record_id", 22], ["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mProduct Load (137.6ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
Completed 200 OK in 1902ms (Views: 1.1ms | ActiveRecord: 836.0ms (6 queries, 0 cached) | GC: 1.1ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-14 22:21:57 +0500
Processing by DashboardController#recent_transactions as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (480.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (136.7ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (138.5ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mUser Load (137.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mTransactionItem Load (138.8ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 32], ["transaction_record_id", 31], ["transaction_record_id", 30], ["transaction_record_id", 29], ["transaction_record_id", 28], ["transaction_record_id", 27], ["transaction_record_id", 26], ["transaction_record_id", 25], ["transaction_record_id", 24], ["transaction_record_id", 23], ["transaction_record_id", 22], ["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mProduct Load (140.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
Completed 200 OK in 1840ms (Views: 1.6ms | ActiveRecord: 1171.0ms (6 queries, 0 cached) | GC: 1.1ms)


Started GET "/dashboard/recent_transactionsl" for ::1 at 2025-05-14 22:22:02 +0500
  
ActionController::RoutingError (No route matches [GET] "/dashboard/recent_transactionsl"):
  
Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-14 22:22:03 +0500
Processing by DashboardController#recent_transactions as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (136.7ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (137.3ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mUser Load (135.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mTransactionItem Load (138.6ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 32], ["transaction_record_id", 31], ["transaction_record_id", 30], ["transaction_record_id", 29], ["transaction_record_id", 28], ["transaction_record_id", 27], ["transaction_record_id", 26], ["transaction_record_id", 25], ["transaction_record_id", 24], ["transaction_record_id", 23], ["transaction_record_id", 22], ["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mProduct Load (137.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
Completed 200 OK in 1507ms (Views: 0.8ms | ActiveRecord: 822.5ms (6 queries, 0 cached) | GC: 0.0ms)


Started GET "/dashboard/recent_transactions" for ::1 at 2025-05-14 22:22:10 +0500
Processing by DashboardController#recent_transactions as */*
  Parameters: {"start_date"=>"2025-01-01", "end_date"=>"2025-12-31", "dashboard"=>{"start_date"=>"2025-01-01", "end_date"=>"2025-12-31"}}
  [1m[36mUser Load (137.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mBusiness Load (141.5ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/dashboard_controller.rb:48:in `set_business'
  [1m[36mTransaction Load (141.9ms)[0m  [1m[34mSELECT "transactions".* FROM "transactions" WHERE "transactions"."business_id" = $1 ORDER BY "transactions"."created_at" DESC LIMIT $2[0m  [["business_id", 1], ["LIMIT", 50]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mUser Load (138.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mTransactionItem Load (693.2ms)[0m  [1m[34mSELECT "transaction_items".* FROM "transaction_items" WHERE "transaction_items"."transaction_record_id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)[0m  [["transaction_record_id", 32], ["transaction_record_id", 31], ["transaction_record_id", 30], ["transaction_record_id", 29], ["transaction_record_id", 28], ["transaction_record_id", 27], ["transaction_record_id", 26], ["transaction_record_id", 25], ["transaction_record_id", 24], ["transaction_record_id", 23], ["transaction_record_id", 22], ["transaction_record_id", 1]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
  [1m[36mProduct Load (137.7ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" IN ($1, $2, $3, $4, $5, $6, $7)[0m  [["id", 3], ["id", 2], ["id", 11], ["id", 8], ["id", 1], ["id", 4], ["id", 12]]
  ↳ app/controllers/dashboard_controller.rb:34:in `map'
Completed 200 OK in 2093ms (Views: 1.4ms | ActiveRecord: 1389.0ms (6 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-18 01:39:19 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 5053ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to ceobcatjwmrilokphmtu.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:27:in `sign_in'
app/controllers/auth_controller.rb:29:in `login'
Started POST "/auth/login" for ::1 at 2025-05-18 01:39:30 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to ceobcatjwmrilokphmtu.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:27:in `sign_in'
app/controllers/auth_controller.rb:29:in `login'
Started POST "/auth/login" for ::1 at 2025-05-18 01:39:31 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to ceobcatjwmrilokphmtu.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:27:in `sign_in'
app/controllers/auth_controller.rb:29:in `login'
Started POST "/auth/login" for ::1 at 2025-05-18 01:39:31 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to ceobcatjwmrilokphmtu.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:27:in `sign_in'
app/controllers/auth_controller.rb:29:in `login'
Started POST "/auth/login" for ::1 at 2025-05-18 01:39:32 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.2ms)


  
SocketError (Failed to open TCP connection to ceobcatjwmrilokphmtu.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:27:in `sign_in'
app/controllers/auth_controller.rb:29:in `login'
Started POST "/auth/login" for ::1 at 2025-05-18 01:40:45 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1729ms (Views: 1.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 4.7ms)


Started GET "/reports/inventory_valuation" for ::1 at 2025-05-18 01:41:11 +0500
  
ActionController::RoutingError (No route matches [GET] "/reports/inventory_valuation"):
  
Started GET "/reports/inventory_valuation" for ::1 at 2025-05-18 01:41:46 +0500
  
AbstractController::ActionNotFound (The action 'inventory_valuation' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/inventory_valuation" for ::1 at 2025-05-18 01:41:48 +0500
  
AbstractController::ActionNotFound (The action 'inventory_valuation' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/inventory_valuation" for ::1 at 2025-05-18 01:42:05 +0500
  
AbstractController::ActionNotFound (The action 'inventory_valuation' could not be found for ReportsController):
  
actionpack (7.2.2.1) lib/abstract_controller/base.rb:158:in `process'
actionview (7.2.2.1) lib/action_view/rendering.rb:40:in `process'
actionpack (7.2.2.1) lib/action_controller/metal.rb:252:in `dispatch'
actionpack (7.2.2.1) lib/action_controller/metal.rb:335:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:67:in `dispatch'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:50:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:53:in `block in serve'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:133:in `block in find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `each'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:126:in `find_routes'
actionpack (7.2.2.1) lib/action_dispatch/journey/router.rb:34:in `serve'
actionpack (7.2.2.1) lib/action_dispatch/routing/route_set.rb:896:in `call'
rack (3.1.12) lib/rack/tempfile_reaper.rb:20:in `call'
rack (3.1.12) lib/rack/etag.rb:29:in `call'
rack (3.1.12) lib/rack/conditional_get.rb:31:in `call'
rack (3.1.12) lib/rack/head.rb:15:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/permissions_policy.rb:38:in `call'
actionpack (7.2.2.1) lib/action_dispatch/http/content_security_policy.rb:38:in `call'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:274:in `context'
rack-session (2.1.0) lib/rack/session/abstract/id.rb:268:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/cookies.rb:704:in `call'
activerecord (7.2.2.1) lib/active_record/migration.rb:674:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/inventory_valuation" for ::1 at 2025-05-18 01:42:22 +0500
Processing by ReportsController#inventory_valuation as */*
  [1m[36mUser Load (148.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mProduct Load (145.5ms)[0m  [1m[34mSELECT "products"."id", "products"."name", "products"."buying_price", "products"."quantity" FROM "products" WHERE "products"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:161:in `map'
Completed 200 OK in 4255ms (Views: 1.0ms | ActiveRecord: 1557.1ms (2 queries, 0 cached) | GC: 0.3ms)


Started GET "/reports/inventory_valuation?page=2&per_page=10" for ::1 at 2025-05-18 01:44:35 +0500
Processing by ReportsController#inventory_valuation as */*
  Parameters: {"page"=>"2", "per_page"=>"10"}
  [1m[36mUser Load (137.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mProduct Count (142.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:165:in `inventory_valuation'
  [1m[36mProduct Load (137.6ms)[0m  [1m[34mSELECT "products"."id", "products"."name", "products"."buying_price", "products"."quantity" FROM "products" WHERE "products"."business_id" = $1 LIMIT $2 OFFSET $3[0m  [["business_id", 1], ["LIMIT", 10], ["OFFSET", 10]]
  ↳ app/controllers/reports_controller.rb:167:in `map'
Completed 200 OK in 3114ms (Views: 0.7ms | ActiveRecord: 1698.6ms (3 queries, 0 cached) | GC: 0.1ms)


Started GET "/reports/inventory_valuation?page=2&per_page=10" for ::1 at 2025-05-18 01:46:17 +0500
Processing by ReportsController#inventory_valuation as */*
  Parameters: {"page"=>"2", "per_page"=>"10"}
  [1m[36mUser Load (145.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mProduct Load (142.1ms)[0m  [1m[34mSELECT "products"."id", "products"."name", "products"."buying_price", "products"."quantity" FROM "products" WHERE "products"."business_id" = $1 LIMIT $2 OFFSET $3[0m  [["business_id", 1], ["LIMIT", 10], ["OFFSET", 10]]
  ↳ app/controllers/reports_controller.rb:168:in `inventory_valuation'
  [1m[36mProduct Count (154.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "products" WHERE "products"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:170:in `inventory_valuation'
Completed 200 OK in 2669ms (Views: 0.6ms | ActiveRecord: 1612.1ms (3 queries, 0 cached) | GC: 0.1ms)


Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:48:29 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mInventoryLog Sum (164.4ms)[0m  [1m[34mSELECT SUM("inventory_logs"."change_quantity") AS "sum_change_quantity", DATE(inventory_logs.created_at) AS "date_inventory_logs_created_at" FROM "inventory_logs" INNER JOIN "products" ON "products"."id" = "inventory_logs"."product_id" WHERE "products"."business_id" = $1 AND (inventory_logs.created_at >= $2) GROUP BY DATE(inventory_logs.created_at)[0m  [["business_id", 1], [nil, "2025-05-11 00:00:00"]]
  ↳ app/controllers/reports_controller.rb:184:in `stock_availability_trend'
Completed 200 OK in 2792ms (Views: 0.3ms | ActiveRecord: 1861.4ms (2 queries, 0 cached) | GC: 0.2ms)


Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:50:23 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (139.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (278.8ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-11'
    GROUP BY log_date
    ORDER BY log_date ASC
    LIMIT 7 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:196:in `stock_availability_trend'
Completed 500 Internal Server Error in 1840ms (ActiveRecord: 975.9ms (2 queries, 0 cached) | GC: 0.2ms)


  
TypeError (no implicit conversion of Date into String):
  
app/controllers/reports_controller.rb:200:in `parse'
app/controllers/reports_controller.rb:200:in `block in stock_availability_trend'
app/controllers/reports_controller.rb:198:in `map'
app/controllers/reports_controller.rb:198:in `stock_availability_trend'
Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:51:08 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (137.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (277.8ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-11'
    GROUP BY log_date
    ORDER BY log_date ASC
    LIMIT 7 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:196:in `stock_availability_trend'
Completed 500 Internal Server Error in 5723ms (ActiveRecord: 1006.4ms (2 queries, 0 cached) | GC: 23.5ms)


  
TypeError (no implicit conversion of Date into String):
  
app/controllers/reports_controller.rb:200:in `parse'
app/controllers/reports_controller.rb:200:in `block in stock_availability_trend'
app/controllers/reports_controller.rb:198:in `map'
app/controllers/reports_controller.rb:198:in `stock_availability_trend'
Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:51:17 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (140.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (277.2ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-11'
    GROUP BY log_date
    ORDER BY log_date ASC
    LIMIT 7 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:196:in `stock_availability_trend'
Completed 500 Internal Server Error in 93594ms (ActiveRecord: 417.5ms (2 queries, 0 cached) | GC: 38.2ms)


  
TypeError (no implicit conversion of Date into String):
  
app/controllers/reports_controller.rb:200:in `parse'
app/controllers/reports_controller.rb:200:in `block in stock_availability_trend'
app/controllers/reports_controller.rb:198:in `map'
app/controllers/reports_controller.rb:198:in `stock_availability_trend'
Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:52:53 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (138.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (289.4ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-11'
    GROUP BY log_date
    ORDER BY log_date ASC
    LIMIT 7 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:196:in `stock_availability_trend'
Completed 200 OK in 2760ms (Views: 0.4ms | ActiveRecord: 1032.3ms (2 queries, 0 cached) | GC: 18.2ms)


Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-18 01:54:46 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (142.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (285.8ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-11'
    GROUP BY log_date
[0m
  ↳ app/controllers/reports_controller.rb:191:in `stock_availability_trend'
Completed 200 OK in 1936ms (Views: 4.7ms | ActiveRecord: 1016.1ms (2 queries, 0 cached) | GC: 2.1ms)


Started GET "/reports/monthly_stock_by_category" for ::1 at 2025-05-18 01:59:15 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  [1m[36mUser Load (153.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (285.8ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 6 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:229:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (140.2ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:231:in `monthly_stock_by_category'
Completed 200 OK in 2352ms (Views: 0.4ms | ActiveRecord: 1350.8ms (3 queries, 0 cached) | GC: 0.2ms)


Started GET "/reports/monthly_stock_by_category?months=12" for ::1 at 2025-05-18 01:59:33 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  Parameters: {"months"=>"12"}
  [1m[36mUser Load (142.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
Completed 500 Internal Server Error in 676ms (ActiveRecord: 142.5ms (1 query, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `months' for "12":String):
  
app/controllers/reports_controller.rb:210:in `monthly_stock_by_category'
Started GET "/reports/monthly_stock_by_category?months=12" for ::1 at 2025-05-18 02:00:15 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  Parameters: {"months"=>"12"}
  [1m[36mUser Load (150.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (288.7ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-05-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 6 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:229:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (138.2ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:231:in `monthly_stock_by_category'
Completed 200 OK in 1859ms (Views: 1.0ms | ActiveRecord: 1293.0ms (3 queries, 0 cached) | GC: 0.2ms)


Started GET "/reports/monthly_stock_by_category?months=12" for ::1 at 2025-05-18 02:00:27 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  Parameters: {"months"=>"12"}
  [1m[36mUser Load (137.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (312.2ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 6 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:230:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (146.4ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:232:in `monthly_stock_by_category'
Completed 200 OK in 72390ms (Views: 1.2ms | ActiveRecord: 1322.3ms (3 queries, 0 cached) | GC: 59.9ms)


Started GET "/reports/monthly_stock_by_category" for ::1 at 2025-05-18 02:01:44 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  [1m[36mUser Load (136.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (354.8ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 6 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:230:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (139.2ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:232:in `monthly_stock_by_category'
Completed 200 OK in 5635ms (Views: 0.5ms | ActiveRecord: 1349.8ms (3 queries, 0 cached) | GC: 57.0ms)


  [1m[36mProductCategory Load (142.0ms)[0m  [1m[34mSELECT "product_categories".* FROM "product_categories" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
Started POST "/products" for ::1 at 2025-05-18 02:03:47 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (302.9ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 2448ms (Views: 1.7ms | ActiveRecord: 2379.4ms (1 query, 0 cached) | GC: 9.9ms)


  [1m[36mUser Load (154.8ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (227.9ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (139.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (138.9ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (168.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (176.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."name" = $1 /* loading for pp */ LIMIT $2[0m  [["name", "Admin"], ["LIMIT", 11]]
  [1m[36mRole Load (214.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."name" = $1 /* loading for pp */ LIMIT $2[0m  [["name", "Admin"], ["LIMIT", 11]]
  [1m[36mRole Load (146.1ms)[0m  [1m[34mSELECT "roles".* FROM "roles" /* loading for pp */ LIMIT $1[0m  [["LIMIT", 11]]
  [1m[36mUser Load (183.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (152.7ms)[0m  [1m[34mSELECT "roles".* FROM "roles" WHERE "roles"."name" = $1 /* loading for pp */ LIMIT $2[0m  [["name", "Editor"], ["LIMIT", 11]]
  [1m[36mUser Load (166.6ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (162.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (172.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (321.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."id" != $2 LIMIT $3[0m  [["email", "[FILTERED]"], ["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (139.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (183.5ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (146.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (140.8ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mUser Load (139.3ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (141.0ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" DESC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mPermission Load (144.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1 /* loading for pp */ LIMIT $2[0m  [["role_id", 1], ["LIMIT", 11]]
  [1m[36mUser Load (141.9ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (171.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" DESC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mPermission Load (193.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions"[0m
  [1m[36mTRANSACTION (182.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mPermissionsRole Create (335.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 1], ["created_at", "2025-05-17 21:05:37.915249"], ["updated_at", "2025-05-17 21:05:37.915249"]]
  [1m[36mPermissionsRole Create (184.9ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 2], ["created_at", "2025-05-17 21:05:38.254491"], ["updated_at", "2025-05-17 21:05:38.254491"]]
  [1m[36mPermissionsRole Create (164.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 3], ["created_at", "2025-05-17 21:05:38.443027"], ["updated_at", "2025-05-17 21:05:38.443027"]]
  [1m[36mPermissionsRole Create (159.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 4], ["created_at", "2025-05-17 21:05:38.609630"], ["updated_at", "2025-05-17 21:05:38.609630"]]
  [1m[36mPermissionsRole Create (141.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 5], ["created_at", "2025-05-17 21:05:38.772787"], ["updated_at", "2025-05-17 21:05:38.772787"]]
  [1m[36mPermissionsRole Create (179.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 6], ["created_at", "2025-05-17 21:05:38.918776"], ["updated_at", "2025-05-17 21:05:38.918776"]]
  [1m[36mPermissionsRole Create (159.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 7], ["created_at", "2025-05-17 21:05:39.104879"], ["updated_at", "2025-05-17 21:05:39.104879"]]
  [1m[36mPermissionsRole Create (158.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 8], ["created_at", "2025-05-17 21:05:39.267221"], ["updated_at", "2025-05-17 21:05:39.267221"]]
  [1m[36mPermissionsRole Create (152.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 9], ["created_at", "2025-05-17 21:05:39.427202"], ["updated_at", "2025-05-17 21:05:39.427202"]]
  [1m[36mPermissionsRole Create (160.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 10], ["created_at", "2025-05-17 21:05:39.581675"], ["updated_at", "2025-05-17 21:05:39.581675"]]
  [1m[36mPermissionsRole Create (157.5ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 11], ["created_at", "2025-05-17 21:05:39.744837"], ["updated_at", "2025-05-17 21:05:39.744837"]]
  [1m[36mPermissionsRole Create (167.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 12], ["created_at", "2025-05-17 21:05:39.905991"], ["updated_at", "2025-05-17 21:05:39.905991"]]
  [1m[36mPermissionsRole Create (178.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 13], ["created_at", "2025-05-17 21:05:40.077720"], ["updated_at", "2025-05-17 21:05:40.077720"]]
  [1m[36mPermissionsRole Create (173.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 14], ["created_at", "2025-05-17 21:05:40.258220"], ["updated_at", "2025-05-17 21:05:40.258220"]]
  [1m[36mPermissionsRole Create (192.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 15], ["created_at", "2025-05-17 21:05:40.436349"], ["updated_at", "2025-05-17 21:05:40.436349"]]
  [1m[36mPermissionsRole Create (181.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 16], ["created_at", "2025-05-17 21:05:40.631357"], ["updated_at", "2025-05-17 21:05:40.631357"]]
  [1m[36mPermissionsRole Create (169.7ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 17], ["created_at", "2025-05-17 21:05:40.815046"], ["updated_at", "2025-05-17 21:05:40.815046"]]
  [1m[36mPermissionsRole Create (179.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 18], ["created_at", "2025-05-17 21:05:40.988138"], ["updated_at", "2025-05-17 21:05:40.988138"]]
  [1m[36mPermissionsRole Create (194.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 19], ["created_at", "2025-05-17 21:05:41.171982"], ["updated_at", "2025-05-17 21:05:41.171982"]]
  [1m[36mPermissionsRole Create (181.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 20], ["created_at", "2025-05-17 21:05:41.369834"], ["updated_at", "2025-05-17 21:05:41.369834"]]
  [1m[36mPermissionsRole Create (186.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 21], ["created_at", "2025-05-17 21:05:41.554034"], ["updated_at", "2025-05-17 21:05:41.554034"]]
  [1m[36mPermissionsRole Create (180.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 22], ["created_at", "2025-05-17 21:05:41.744768"], ["updated_at", "2025-05-17 21:05:41.744768"]]
  [1m[36mPermissionsRole Create (189.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 23], ["created_at", "2025-05-17 21:05:41.928703"], ["updated_at", "2025-05-17 21:05:41.928703"]]
  [1m[36mPermissionsRole Create (193.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 24], ["created_at", "2025-05-17 21:05:42.121038"], ["updated_at", "2025-05-17 21:05:42.121038"]]
  [1m[36mPermissionsRole Create (199.5ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 25], ["created_at", "2025-05-17 21:05:42.318205"], ["updated_at", "2025-05-17 21:05:42.318205"]]
  [1m[36mPermissionsRole Create (196.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 26], ["created_at", "2025-05-17 21:05:42.520882"], ["updated_at", "2025-05-17 21:05:42.520882"]]
  [1m[36mPermissionsRole Create (184.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 27], ["created_at", "2025-05-17 21:05:42.721262"], ["updated_at", "2025-05-17 21:05:42.721262"]]
  [1m[36mPermissionsRole Create (210.5ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 28], ["created_at", "2025-05-17 21:05:42.908874"], ["updated_at", "2025-05-17 21:05:42.908874"]]
  [1m[36mPermissionsRole Create (177.7ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 29], ["created_at", "2025-05-17 21:05:43.123195"], ["updated_at", "2025-05-17 21:05:43.123195"]]
  [1m[36mPermissionsRole Create (189.9ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 30], ["created_at", "2025-05-17 21:05:43.304341"], ["updated_at", "2025-05-17 21:05:43.304341"]]
  [1m[36mPermissionsRole Create (198.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 31], ["created_at", "2025-05-17 21:05:43.497216"], ["updated_at", "2025-05-17 21:05:43.497216"]]
  [1m[36mPermissionsRole Create (186.9ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 32], ["created_at", "2025-05-17 21:05:43.698316"], ["updated_at", "2025-05-17 21:05:43.698316"]]
  [1m[36mPermissionsRole Create (177.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 33], ["created_at", "2025-05-17 21:05:43.889099"], ["updated_at", "2025-05-17 21:05:43.889099"]]
  [1m[36mPermissionsRole Create (226.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 34], ["created_at", "2025-05-17 21:05:44.070553"], ["updated_at", "2025-05-17 21:05:44.070553"]]
  [1m[36mPermissionsRole Create (219.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 35], ["created_at", "2025-05-17 21:05:44.300351"], ["updated_at", "2025-05-17 21:05:44.300351"]]
  [1m[36mPermissionsRole Create (192.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 36], ["created_at", "2025-05-17 21:05:44.522093"], ["updated_at", "2025-05-17 21:05:44.522093"]]
  [1m[36mPermissionsRole Create (205.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 37], ["created_at", "2025-05-17 21:05:44.716682"], ["updated_at", "2025-05-17 21:05:44.716682"]]
  [1m[36mPermissionsRole Create (208.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 38], ["created_at", "2025-05-17 21:05:44.925644"], ["updated_at", "2025-05-17 21:05:44.925644"]]
  [1m[36mPermissionsRole Create (192.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 39], ["created_at", "2025-05-17 21:05:45.138193"], ["updated_at", "2025-05-17 21:05:45.138193"]]
  [1m[36mPermissionsRole Create (179.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 40], ["created_at", "2025-05-17 21:05:45.334518"], ["updated_at", "2025-05-17 21:05:45.334518"]]
  [1m[36mPermissionsRole Create (179.9ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 41], ["created_at", "2025-05-17 21:05:45.516023"], ["updated_at", "2025-05-17 21:05:45.516023"]]
  [1m[36mPermissionsRole Create (142.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 42], ["created_at", "2025-05-17 21:05:45.699112"], ["updated_at", "2025-05-17 21:05:45.699112"]]
  [1m[36mPermissionsRole Create (170.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 43], ["created_at", "2025-05-17 21:05:45.846018"], ["updated_at", "2025-05-17 21:05:45.846018"]]
  [1m[36mPermissionsRole Create (168.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 44], ["created_at", "2025-05-17 21:05:46.019805"], ["updated_at", "2025-05-17 21:05:46.019805"]]
  [1m[36mPermissionsRole Create (159.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 45], ["created_at", "2025-05-17 21:05:46.191290"], ["updated_at", "2025-05-17 21:05:46.191290"]]
  [1m[36mPermissionsRole Create (189.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 46], ["created_at", "2025-05-17 21:05:46.354415"], ["updated_at", "2025-05-17 21:05:46.354415"]]
  [1m[36mPermissionsRole Create (179.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 47], ["created_at", "2025-05-17 21:05:46.547266"], ["updated_at", "2025-05-17 21:05:46.547266"]]
  [1m[36mPermissionsRole Create (190.0ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 48], ["created_at", "2025-05-17 21:05:46.731012"], ["updated_at", "2025-05-17 21:05:46.731012"]]
  [1m[36mPermissionsRole Create (181.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 49], ["created_at", "2025-05-17 21:05:46.924945"], ["updated_at", "2025-05-17 21:05:46.924945"]]
  [1m[36mPermissionsRole Create (200.9ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 50], ["created_at", "2025-05-17 21:05:47.110540"], ["updated_at", "2025-05-17 21:05:47.110540"]]
  [1m[36mPermissionsRole Create (210.6ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 51], ["created_at", "2025-05-17 21:05:47.315163"], ["updated_at", "2025-05-17 21:05:47.315163"]]
  [1m[36mPermissionsRole Create (202.1ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 52], ["created_at", "2025-05-17 21:05:47.528573"], ["updated_at", "2025-05-17 21:05:47.528573"]]
  [1m[36mPermissionsRole Create (194.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 53], ["created_at", "2025-05-17 21:05:47.733188"], ["updated_at", "2025-05-17 21:05:47.733188"]]
  [1m[36mPermissionsRole Create (211.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 54], ["created_at", "2025-05-17 21:05:47.931928"], ["updated_at", "2025-05-17 21:05:47.931928"]]
  [1m[36mPermissionsRole Create (191.2ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 55], ["created_at", "2025-05-17 21:05:48.146792"], ["updated_at", "2025-05-17 21:05:48.146792"]]
  [1m[36mPermissionsRole Create (223.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 56], ["created_at", "2025-05-17 21:05:48.342247"], ["updated_at", "2025-05-17 21:05:48.342247"]]
  [1m[36mPermissionsRole Create (231.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 57], ["created_at", "2025-05-17 21:05:48.568207"], ["updated_at", "2025-05-17 21:05:48.568207"]]
  [1m[36mPermissionsRole Create (239.5ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 58], ["created_at", "2025-05-17 21:05:48.803114"], ["updated_at", "2025-05-17 21:05:48.803114"]]
  [1m[36mPermissionsRole Create (177.8ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 59], ["created_at", "2025-05-17 21:05:49.046845"], ["updated_at", "2025-05-17 21:05:49.046845"]]
  [1m[36mPermissionsRole Create (143.5ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 60], ["created_at", "2025-05-17 21:05:49.228502"], ["updated_at", "2025-05-17 21:05:49.228502"]]
  [1m[36mPermissionsRole Create (138.4ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 61], ["created_at", "2025-05-17 21:05:49.375520"], ["updated_at", "2025-05-17 21:05:49.375520"]]
  [1m[36mPermissionsRole Create (140.3ms)[0m  [1m[32mINSERT INTO "permissions_roles" ("role_id", "permission_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["role_id", 1], ["permission_id", 62], ["created_at", "2025-05-17 21:05:49.516887"], ["updated_at", "2025-05-17 21:05:49.516887"]]
  [1m[36mTRANSACTION (140.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mPermission Load (140.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1 /* loading for pp */ LIMIT $2[0m  [["role_id", 1], ["LIMIT", 11]]
Started POST "/products" for ::1 at 2025-05-18 02:05:53 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (317.8ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 328ms (Views: 0.4ms | ActiveRecord: 317.7ms (1 query, 0 cached) | GC: 0.8ms)


Started POST "/products" for ::1 at 2025-05-18 02:05:55 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (287.3ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 296ms (Views: 0.8ms | ActiveRecord: 287.2ms (1 query, 0 cached) | GC: 1.8ms)


  [1m[36mUser Load (157.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 /* loading for pp */ LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 11]]
  [1m[36mUser Load (155.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (162.9ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (169.6ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for pp */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mUser Load (142.4ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (140.5ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for inspect */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mRole Load (138.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 /* loading for inspect */ LIMIT $2[0m  [["user_id", 1], ["LIMIT", 11]]
  [1m[36mUser Load (194.7ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mRole Load (189.4ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 ORDER BY "roles"."id" DESC LIMIT $2[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mPermission Count (197.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  [1m[36mPermission Load (139.7ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (183.0ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" ORDER BY "permissions"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mPermission Load (162.9ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."name" = $1 /* loading for pp */ LIMIT $2[0m  [["name", "products#create"], ["LIMIT", 11]]
Started POST "/products" for ::1 at 2025-05-18 02:08:07 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (280.7ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 293ms (Views: 0.3ms | ActiveRecord: 280.6ms (1 query, 0 cached) | GC: 0.4ms)


Started POST "/products" for ::1 at 2025-05-18 02:08:08 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (289.0ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 297ms (Views: 0.3ms | ActiveRecord: 288.9ms (1 query, 0 cached) | GC: 0.3ms)


Started POST "/products" for ::1 at 2025-05-18 02:08:27 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mRole Exists? (313.0ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" IS NULL AND (1=0) AND "roles"."name" = $1 LIMIT $2[0m  [["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
Completed 403 Forbidden in 3303ms (Views: 0.2ms | ActiveRecord: 3251.0ms (1 query, 0 cached) | GC: 0.2ms)


Started POST "/products" for ::1 at 2025-05-18 02:08:39 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
Completed 500 Internal Server Error in 15109ms (ActiveRecord: 1633.8ms (0 queries, 0 cached) | GC: 32.7ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/products_controller.rb:21:in `create'
Started POST "/products" for ::1 at 2025-05-18 02:09:17 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mUser Load (155.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mRole Exists? (429.7ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mRole Load (245.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermissionsRole Load (142.4ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermission Load (290.6ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 11], ["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 5], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62]]
  ↳ app/models/ability.rb:11:in `initialize'
DEPRECATION WARNING: Defining enums with keyword arguments is deprecated and will be removed
in Rails 8.0. Positional arguments should be used instead:

enum :payment_method, {:cash=>"cash", :mpesa=>"mpesa", :credit_card=>"credit_card", :bank_transfer=>"bank_transfer"}
 (called from <class:Transaction> at /Users/abdullahyaqub/Desktop/Future_POS/Fuatra_POS_System/backend/inventory_hub/app/models/transaction.rb:9)
  [1m[36mTRANSACTION (141.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mProductCategory Create (292.6ms)[0m  [1m[32mINSERT INTO "product_categories" ("name", "description", "created_at", "updated_at", "business_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Accessories"], ["description", "Peripheral accessories like mice, keyboards, etc."], ["created_at", "2025-05-17 21:09:26.500240"], ["updated_at", "2025-05-17 21:09:26.500240"], ["business_id", nil]]
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mProduct Create (159.3ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "quantity", "buying_price", "product_category_id", "created_at", "updated_at", "business_id", "selling_price") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "Wireless Mouse"], ["description", "Ergonomic wireless mouse with USB receiver"], ["quantity", 50], ["buying_price", "15.99"], ["product_category_id", 8], ["created_at", "2025-05-17 21:09:26.798567"], ["updated_at", "2025-05-17 21:09:26.798567"], ["business_id", 1], ["selling_price", "29.99"]]
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mTRANSACTION (149.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mTRANSACTION (181.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:22:in `create'
  [1m[36mInventoryLog Create (337.6ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 21], ["change_quantity", 50], ["date", "2025-05-17 21:09:27.110412"], ["reason", "Product created with initial stock"], ["created_at", "2025-05-17 21:09:27.447687"], ["updated_at", "2025-05-17 21:09:27.447687"], ["sales_transaction_id", nil]]
  ↳ app/controllers/products_controller.rb:22:in `create'
  [1m[36mTRANSACTION (141.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:22:in `create'
Completed 201 Created in 9748ms (Views: 0.5ms | ActiveRecord: 8674.5ms (8 queries, 0 cached) | GC: 12.4ms)


Started POST "/products" for ::1 at 2025-05-18 02:09:45 +0500
Processing by ProductsController#create as */*
  Parameters: {"product"=>{"name"=>"Wireless Mouse", "description"=>"Ergonomic wireless mouse with USB receiver", "quantity"=>50, "buying_price"=>15.99, "selling_price"=>29.99, "product_category_attributes"=>{"name"=>"Accessories", "description"=>"Peripheral accessories like mice, keyboards, etc."}}}
  [1m[36mUser Load (150.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mRole Exists? (301.1ms)[0m  [1m[34mSELECT 1 AS one FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1 AND "roles"."name" = $2 LIMIT $3[0m  [["user_id", 1], ["name", "admin"], ["LIMIT", 1]]
  ↳ app/models/ability.rb:8:in `initialize'
  [1m[36mRole Load (148.9ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermissionsRole Load (159.3ms)[0m  [1m[34mSELECT "permissions_roles".* FROM "permissions_roles" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mPermission Load (320.4ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" WHERE "permissions"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $53, $54, $55, $56, $57, $58, $59, $60, $61, $62)[0m  [["id", 11], ["id", 1], ["id", 2], ["id", 3], ["id", 4], ["id", 5], ["id", 6], ["id", 7], ["id", 8], ["id", 9], ["id", 10], ["id", 12], ["id", 13], ["id", 14], ["id", 15], ["id", 16], ["id", 17], ["id", 18], ["id", 19], ["id", 20], ["id", 21], ["id", 22], ["id", 23], ["id", 24], ["id", 25], ["id", 26], ["id", 27], ["id", 28], ["id", 29], ["id", 30], ["id", 31], ["id", 32], ["id", 33], ["id", 34], ["id", 35], ["id", 36], ["id", 37], ["id", 38], ["id", 39], ["id", 40], ["id", 41], ["id", 42], ["id", 43], ["id", 44], ["id", 45], ["id", 46], ["id", 47], ["id", 48], ["id", 49], ["id", 50], ["id", 51], ["id", 52], ["id", 53], ["id", 54], ["id", 55], ["id", 56], ["id", 57], ["id", 58], ["id", 59], ["id", 60], ["id", 61], ["id", 62]]
  ↳ app/models/ability.rb:11:in `initialize'
  [1m[36mTRANSACTION (152.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mProductCategory Create (303.5ms)[0m  [1m[32mINSERT INTO "product_categories" ("name", "description", "created_at", "updated_at", "business_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Accessories"], ["description", "Peripheral accessories like mice, keyboards, etc."], ["created_at", "2025-05-17 21:09:47.211693"], ["updated_at", "2025-05-17 21:09:47.211693"], ["business_id", nil]]
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mProduct Create (164.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "description", "quantity", "buying_price", "product_category_id", "created_at", "updated_at", "business_id", "selling_price") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["name", "Wireless Mouse"], ["description", "Ergonomic wireless mouse with USB receiver"], ["quantity", 50], ["buying_price", "15.99"], ["product_category_id", 9], ["created_at", "2025-05-17 21:09:47.522080"], ["updated_at", "2025-05-17 21:09:47.522080"], ["business_id", 1], ["selling_price", "29.99"]]
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mTRANSACTION (142.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:21:in `create'
  [1m[36mTRANSACTION (156.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/products_controller.rb:22:in `create'
  [1m[36mInventoryLog Create (340.7ms)[0m  [1m[32mINSERT INTO "inventory_logs" ("product_id", "change_quantity", "date", "reason", "created_at", "updated_at", "sales_transaction_id") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["product_id", 22], ["change_quantity", 50], ["date", "2025-05-17 21:09:47.832840"], ["reason", "Product created with initial stock"], ["created_at", "2025-05-17 21:09:47.834311"], ["updated_at", "2025-05-17 21:09:47.834311"], ["sales_transaction_id", nil]]
  ↳ app/controllers/products_controller.rb:22:in `create'
  [1m[36mTRANSACTION (159.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/products_controller.rb:22:in `create'
Completed 201 Created in 2818ms (Views: 1.0ms | ActiveRecord: 2498.1ms (8 queries, 0 cached) | GC: 3.5ms)


Started GET "/reports/monthly_stock_by_category" for ::1 at 2025-05-18 02:09:51 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  [1m[36mUser Load (191.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (286.3ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 6 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:230:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (140.5ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:232:in `monthly_stock_by_category'
Completed 200 OK in 21285ms (Views: 0.8ms | ActiveRecord: 618.2ms (3 queries, 0 cached) | GC: 67.5ms)


  [1m[36mUser Load (144.1ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mProductCategory Pluck (139.7ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  [1m[36mProduct Load (158.5ms)[0m  [1m[34mSELECT "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 2]]
  [1m[36mProduct Load (252.7ms)[0m  [1m[34mSELECT "products".* FROM "products" ORDER BY "products"."id" DESC LIMIT $1[0m  [["LIMIT", 3]]
  [1m[36mProduct Count (153.3ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "product_categories"."name" AS "product_categories_name" FROM "products" INNER JOIN "product_categories" ON "product_categories"."id" = "products"."product_category_id" GROUP BY "product_categories"."name"[0m
  [1m[36mProduct Count (292.2ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "product_categories"."name" AS "product_categories_name" FROM "products" INNER JOIN "product_categories" ON "product_categories"."id" = "products"."product_category_id" WHERE (products.business_id = $1) GROUP BY "product_categories"."name"[0m  [[nil, 1]]
  [1m[35mSQL (284.7ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 10 OFFSET 0
[0m
  [1m[36mProductCategory Pluck (200.6ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  [1m[36mProductCategory Update All (143.3ms)[0m  [1m[33mUPDATE "product_categories" SET "business_id" = $1[0m  [["business_id", 1]]
Started GET "/reports/monthly_stock_by_category" for ::1 at 2025-05-18 02:16:32 +0500
Processing by ReportsController#monthly_stock_by_category as */*
  [1m[36mUser Load (182.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (313.2ms)[0m  [1m[34m    SELECT
      TO_CHAR(DATE_TRUNC('month', products.created_at), 'Mon') AS month,
      product_categories.name AS category,
      SUM(products.quantity) AS total_quantity
    FROM products
    INNER JOIN product_categories ON product_categories.id = products.product_category_id
    WHERE products.business_id = 1
      AND products.created_at >= '2024-12-01'
    GROUP BY DATE_TRUNC('month', products.created_at), product_categories.name
    ORDER BY DATE_TRUNC('month', products.created_at) DESC
    LIMIT 10 OFFSET 0
[0m
  ↳ app/controllers/reports_controller.rb:230:in `monthly_stock_by_category'
  [1m[36mProductCategory Pluck (151.5ms)[0m  [1m[34mSELECT "product_categories"."name" FROM "product_categories" WHERE "product_categories"."business_id" = $1[0m  [["business_id", 1]]
  ↳ app/controllers/reports_controller.rb:232:in `monthly_stock_by_category'
Completed 200 OK in 21576ms (Views: 0.6ms | ActiveRecord: 2264.4ms (3 queries, 0 cached) | GC: 66.2ms)


  [1m[36mBusiness Load (141.4ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mBusiness Load (138.0ms)[0m  [1m[34mSELECT "businesses".* FROM "businesses" WHERE "businesses"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Started POST "/auth/login" for ::1 at 2025-05-19 23:28:48 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1481ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


Started GET "/reports/daily_transactions_summary" for ::1 at 2025-05-19 23:29:06 +0500
Processing by ReportsController#daily_transactions_summary as */*
  [1m[36mUser Load (140.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (284.1ms)[0m  [1m[34m    SELECT DATE(transactions.date) AS day, COUNT(DISTINCT transactions.id) AS transactions_count
    FROM transactions
    
    WHERE transactions.date BETWEEN '2025-04-12 00:00:00 UTC' AND '2025-04-17 23:59:59 UTC'
    
    GROUP BY day
    ORDER BY day ASC
[0m
  ↳ app/controllers/reports_controller.rb:185:in `daily_transactions_summary'
Completed 200 OK in 3412ms (Views: 0.5ms | ActiveRecord: 1661.1ms (2 queries, 0 cached) | GC: 0.3ms)


Started GET "/reports/stock_availability_trend" for ::1 at 2025-05-19 23:29:27 +0500
Processing by ReportsController#stock_availability_trend as */*
  [1m[36mUser Load (485.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (274.2ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-13'
      
    GROUP BY log_date
[0m
  ↳ app/controllers/reports_controller.rb:238:in `stock_availability_trend'
Completed 200 OK in 1721ms (Views: 0.4ms | ActiveRecord: 759.0ms (2 queries, 0 cached) | GC: 0.0ms)


Started GET "/reports/stock_availability_trend?product_category_ids=[1,%202]" for ::1 at 2025-05-19 23:29:51 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>"[1, 2]"}
  [1m[36mUser Load (135.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
Completed 500 Internal Server Error in 1090ms (ActiveRecord: 135.2ms (1 query, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `any?' for "[1, 2]":String):
  
app/controllers/reports_controller.rb:222:in `stock_availability_trend'
Started GET "/reports/stock_availability_trend?product_category_ids=1&product_category_ids=2" for ::1 at 2025-05-19 23:30:07 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>"2"}
  [1m[36mUser Load (137.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
Completed 500 Internal Server Error in 716ms (ActiveRecord: 137.3ms (1 query, 0 cached) | GC: 0.3ms)


  
NoMethodError (undefined method `any?' for "2":String):
  
app/controllers/reports_controller.rb:222:in `stock_availability_trend'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-19 23:31:05 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
  [1m[36mUser Load (159.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (272.9ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-13'
      AND products.product_category_id IN (1,2)
    GROUP BY log_date
[0m
  ↳ app/controllers/reports_controller.rb:238:in `stock_availability_trend'
Completed 200 OK in 1711ms (Views: 0.9ms | ActiveRecord: 432.0ms (2 queries, 0 cached) | GC: 0.6ms)


Started POST "/auth/login" for ::1 at 2025-05-22 23:31:07 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1625ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-22 23:31:13 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 876ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:31:27 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 2600ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:32:46 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 10224ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.2ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:33:12 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 6812ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 2.3ms)


  
ActiveRecord::DatabaseConnectionError (There is an issue connecting with your hostname: aws-0-ap-south-1.pooler.supabase.com.

Please check your database configuration and ensure there is a valid connection to your database.
):

Causes:
PG::ConnectionBad (could not translate host name "aws-0-ap-south-1.pooler.supabase.com" to address: nodename nor servname provided, or not known
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:34:32 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 1529ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.9ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:34:38 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 3060ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.0ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:35:00 +0500
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
Completed 500 Internal Server Error in 2578ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 2.5ms)


  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
app/controllers/application_controller.rb:18:in `set_current_user'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:36:34 +0500
  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.108.251.216", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:69:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:39:15 +0500
  
ActiveRecord::ConnectionNotEstablished (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "3.111.105.85", port 5432 failed: error received from server in SCRAM exchange: Wrong password
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:69:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/reports/stock_availability_trend?product_category_ids[]=1&product_category_ids[]=2" for ::1 at 2025-05-22 23:39:28 +0500
  [1m[36mActiveRecord::SchemaMigration Load (146.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReportsController#stock_availability_trend as */*
  Parameters: {"product_category_ids"=>["1", "2"]}
  [1m[36mUser Load (135.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "c8b0aded-3f84-4c1d-b616-237d14ba2005"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[35mSQL (290.0ms)[0m  [1m[34m    SELECT DATE(inventory_logs.created_at) AS log_date, SUM(change_quantity) AS items_left
    FROM inventory_logs
    INNER JOIN products ON products.id = inventory_logs.product_id
    WHERE products.business_id = 1
      AND inventory_logs.created_at >= '2025-05-16'
      AND products.product_category_id IN (1,2)
    GROUP BY log_date
[0m
  ↳ app/controllers/reports_controller.rb:231:in `stock_availability_trend'
Completed 200 OK in 4068ms (Views: 0.5ms | ActiveRecord: 2206.9ms (2 queries, 0 cached) | GC: 2.7ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/login" for ::1 at 2025-05-24 11:34:53 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1516ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-24 11:34:58 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 870ms (Views: 0.6ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/roles/3" for ::1 at 2025-05-28 16:27:44 +0500
  
ActiveRecord::ConnectionNotEstablished (connection to server at "52.8.172.168", port 5432 failed: SSL connection has been closed unexpectedly
):

Causes:
PG::ConnectionBad (connection to server at "52.8.172.168", port 5432 failed: SSL connection has been closed unexpectedly
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:69:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/roles/3" for ::1 at 2025-05-28 16:29:44 +0500
  
RuntimeError (Your version of PostgreSQL (0) is too old. Active Record supports PostgreSQL >= 9.3.):
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:645:in `check_version'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:1205:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:1000:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:670:in `block (2 levels) in reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:393:in `reset_transaction'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:668:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started GET "/roles/3" for ::1 at 2025-05-28 16:32:10 +0500
  
RuntimeError (Your version of PostgreSQL (0) is too old. Active Record supports PostgreSQL >= 9.3.):
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:645:in `check_version'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:1205:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:1000:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:670:in `block (2 levels) in reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:393:in `reset_transaction'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:668:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
Started GET "/roles/3" for ::1 at 2025-05-28 17:08:27 +0500
  
RuntimeError (Your version of PostgreSQL (0) is too old. Active Record supports PostgreSQL >= 9.3.):
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:645:in `check_version'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:1205:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:1000:in `configure_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:670:in `block (2 levels) in reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:393:in `reset_transaction'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:668:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mUser Load (163.6ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (7924.7ms)[0m  [1m[35mCREATE DATABASE "inventory_hub_development" ENCODING = 'unicode'[0m
  [1m[35m (5684.7ms)[0m  [1m[35mCREATE DATABASE "inventory_hub_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (607.7ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (301.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "businesses" CASCADE[0m
  [1m[35m (321.0ms)[0m  [1m[35mCREATE TABLE "businesses" ("id" bigserial primary key, "name" character varying, "description" text, "address" character varying, "phone" character varying, "email" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (299.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "customers" CASCADE[0m
  [1m[35m (321.6ms)[0m  [1m[35mCREATE TABLE "customers" ("id" bigserial primary key, "first_name" character varying, "last_name" character varying, "phone" character varying, "gender" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "email" character varying, "date_of_birth" date, "business_id" bigint)[0m
  [1m[35m (303.9ms)[0m  [1m[35mCREATE INDEX "index_customers_on_business_id" ON "customers" ("business_id")[0m
  [1m[35m (299.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "inventory_logs" CASCADE[0m
  [1m[35m (308.5ms)[0m  [1m[35mCREATE TABLE "inventory_logs" ("id" bigserial primary key, "product_id" bigint NOT NULL, "change_quantity" integer, "date" timestamp(6), "reason" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "sales_transaction_id" bigint)[0m
  [1m[35m (304.3ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_product_id" ON "inventory_logs" ("product_id")[0m
  [1m[35m (315.1ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_sales_transaction_id" ON "inventory_logs" ("sales_transaction_id")[0m
  [1m[35m (298.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "mpesa_transactions" CASCADE[0m
  [1m[35m (308.9ms)[0m  [1m[35mCREATE TABLE "mpesa_transactions" ("id" bigserial primary key, "total_amount" decimal, "code" character varying, "status" character varying, "date" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (301.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "permissions" CASCADE[0m
  [1m[35m (311.5ms)[0m  [1m[35mCREATE TABLE "permissions" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (301.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "permissions_roles" CASCADE[0m
  [1m[35m (304.6ms)[0m  [1m[35mCREATE TABLE "permissions_roles" ("id" bigserial primary key, "role_id" bigint NOT NULL, "permission_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (315.7ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_permission_id" ON "permissions_roles" ("permission_id")[0m
  [1m[35m (304.0ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_role_id" ON "permissions_roles" ("role_id")[0m
  [1m[35m (298.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "product_categories" CASCADE[0m
  [1m[35m (311.6ms)[0m  [1m[35mCREATE TABLE "product_categories" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "business_id" bigint)[0m
  [1m[35m (304.2ms)[0m  [1m[35mCREATE INDEX "index_product_categories_on_business_id" ON "product_categories" ("business_id")[0m
  [1m[35m (337.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "products" CASCADE[0m
  [1m[35m (308.9ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "quantity" integer, "buying_price" decimal, "product_category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "business_id" bigint, "selling_price" decimal)[0m
  [1m[35m (303.3ms)[0m  [1m[35mCREATE INDEX "index_products_on_business_id" ON "products" ("business_id")[0m
  [1m[35m (815.1ms)[0m  [1m[35mCREATE INDEX "index_products_on_product_category_id" ON "products" ("product_category_id")[0m
  [1m[35m (299.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "roles" CASCADE[0m
  [1m[35m (309.1ms)[0m  [1m[35mCREATE TABLE "roles" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "description" text)[0m
  [1m[35m (826.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "roles_users" CASCADE[0m
  [1m[35m (307.5ms)[0m  [1m[35mCREATE TABLE "roles_users" ("id" bigserial primary key, "user_id" bigint NOT NULL, "role_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (304.0ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_role_id" ON "roles_users" ("role_id")[0m
  [1m[35m (307.7ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_user_id" ON "roles_users" ("user_id")[0m
  [1m[35m (300.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "transaction_items" CASCADE[0m
  [1m[35m (309.1ms)[0m  [1m[35mCREATE TABLE "transaction_items" ("id" bigserial primary key, "transaction_record_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "price" decimal)[0m
  [1m[35m (305.8ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_product_id" ON "transaction_items" ("product_id")[0m
  [1m[35m (303.8ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_transaction_record_id" ON "transaction_items" ("transaction_record_id")[0m
  [1m[35m (298.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "transactions" CASCADE[0m
  [1m[35m (311.7ms)[0m  [1m[35mCREATE TABLE "transactions" ("id" bigserial primary key, "user_id" bigint NOT NULL, "customer_id" bigint, "date" timestamp(6), "total_amount" decimal, "discount" decimal, "payment_method" character varying, "status" character varying, "mpesa_transaction_id" bigint, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "quantity" integer, "business_id" bigint, "received_amount" decimal, "returned_amount" decimal)[0m
  [1m[35m (305.4ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_business_id" ON "transactions" ("business_id")[0m
  [1m[35m (315.7ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_customer_id" ON "transactions" ("customer_id")[0m
  [1m[35m (301.9ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_mpesa_transaction_id" ON "transactions" ("mpesa_transaction_id")[0m
  [1m[35m (301.1ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_user_id" ON "transactions" ("user_id")[0m
  [1m[35m (298.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (315.4ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying, "email" character varying, "phone" character varying, "revenue" decimal, "revenue_type" character varying, "password" character varying, "role" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "supabase_id" character varying, "business_id" bigint)[0m
  [1m[35m (315.1ms)[0m  [1m[35mCREATE INDEX "index_users_on_business_id" ON "users" ("business_id")[0m
  [1m[35m (302.3ms)[0m  [1m[35mALTER TABLE "customers" ADD CONSTRAINT "fk_rails_b73113df4b"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (375.3ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_e75e84fa25"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
[0m
  [1m[35m (304.2ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_4fc8fd7989"
FOREIGN KEY ("sales_transaction_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[35m (301.6ms)[0m  [1m[35mALTER TABLE "permissions_roles" ADD CONSTRAINT "fk_rails_7cc0b02d7d"
FOREIGN KEY ("permission_id")
  REFERENCES "permissions" ("id")
[0m
  [1m[35m (300.7ms)[0m  [1m[35mALTER TABLE "permissions_roles" ADD CONSTRAINT "fk_rails_211043a277"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
[0m
  [1m[35m (300.8ms)[0m  [1m[35mALTER TABLE "product_categories" ADD CONSTRAINT "fk_rails_d08cd985f2"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (300.9ms)[0m  [1m[35mALTER TABLE "products" ADD CONSTRAINT "fk_rails_64b1679e02"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (300.8ms)[0m  [1m[35mALTER TABLE "products" ADD CONSTRAINT "fk_rails_efe167855e"
FOREIGN KEY ("product_category_id")
  REFERENCES "product_categories" ("id")
[0m
  [1m[35m (300.9ms)[0m  [1m[35mALTER TABLE "roles_users" ADD CONSTRAINT "fk_rails_9dada905f6"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
[0m
  [1m[35m (300.2ms)[0m  [1m[35mALTER TABLE "roles_users" ADD CONSTRAINT "fk_rails_e2a7142459"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (301.9ms)[0m  [1m[35mALTER TABLE "transaction_items" ADD CONSTRAINT "fk_rails_856b4fc46a"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
[0m
  [1m[35m (300.3ms)[0m  [1m[35mALTER TABLE "transaction_items" ADD CONSTRAINT "fk_rails_922f2e8367"
FOREIGN KEY ("transaction_record_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[35m (301.4ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_410128cf7a"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (301.7ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_984bd8f159"
FOREIGN KEY ("customer_id")
  REFERENCES "customers" ("id")
[0m
  [1m[35m (299.9ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_abdb17cadd"
FOREIGN KEY ("mpesa_transaction_id")
  REFERENCES "mpesa_transactions" ("id")
[0m
  [1m[35m (300.7ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_77364e6416"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (300.3ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT "fk_rails_ffa8fa13ef"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (304.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (1315.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (299.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20250514171240)[0m
  [1m[35m (299.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20250510105916),
(20250509024437),
(20250509024433),
(20250509024430),
(20250509024426),
(20250418150904),
(20250418150022),
(20250413133755),
(20250413133751),
(20250413133747),
(20250413133741),
(20250413133737),
(20250413133713),
(20250413105955),
(20250413103259),
(20250409174132),
(20250409170018),
(20250409165309),
(20250409164945),
(20250406142616),
(20250325083359),
(20250325083347),
(20250325083328),
(20250325083312),
(20250325083233),
(20250325083142),
(20250325082518);[0m
  [1m[35m (306.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (306.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (302.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-05-28 12:28:58.261302', '2025-05-28 12:28:58.261306') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (300.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (298.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (323.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'f2ce0e42f6e9d3233689f07eed0bb1ad94129e63', '2025-05-28 12:28:59.997449', '2025-05-28 12:28:59.997454') RETURNING "key"[0m
  [1m[35mSQL (6858.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (302.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "businesses" CASCADE[0m
  [1m[35m (831.8ms)[0m  [1m[35mCREATE TABLE "businesses" ("id" bigserial primary key, "name" character varying, "description" text, "address" character varying, "phone" character varying, "email" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (301.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "customers" CASCADE[0m
  [1m[35m (314.0ms)[0m  [1m[35mCREATE TABLE "customers" ("id" bigserial primary key, "first_name" character varying, "last_name" character varying, "phone" character varying, "gender" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "email" character varying, "date_of_birth" date, "business_id" bigint)[0m
  [1m[35m (306.5ms)[0m  [1m[35mCREATE INDEX "index_customers_on_business_id" ON "customers" ("business_id")[0m
  [1m[35m (302.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "inventory_logs" CASCADE[0m
  [1m[35m (374.2ms)[0m  [1m[35mCREATE TABLE "inventory_logs" ("id" bigserial primary key, "product_id" bigint NOT NULL, "change_quantity" integer, "date" timestamp(6), "reason" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "sales_transaction_id" bigint)[0m
  [1m[35m (306.3ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_product_id" ON "inventory_logs" ("product_id")[0m
  [1m[35m (316.2ms)[0m  [1m[35mCREATE INDEX "index_inventory_logs_on_sales_transaction_id" ON "inventory_logs" ("sales_transaction_id")[0m
  [1m[35m (303.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "mpesa_transactions" CASCADE[0m
  [1m[35m (311.1ms)[0m  [1m[35mCREATE TABLE "mpesa_transactions" ("id" bigserial primary key, "total_amount" decimal, "code" character varying, "status" character varying, "date" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (301.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "permissions" CASCADE[0m
  [1m[35m (311.6ms)[0m  [1m[35mCREATE TABLE "permissions" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (301.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "permissions_roles" CASCADE[0m
  [1m[35m (345.0ms)[0m  [1m[35mCREATE TABLE "permissions_roles" ("id" bigserial primary key, "role_id" bigint NOT NULL, "permission_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (304.5ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_permission_id" ON "permissions_roles" ("permission_id")[0m
  [1m[35m (306.0ms)[0m  [1m[35mCREATE INDEX "index_permissions_roles_on_role_id" ON "permissions_roles" ("role_id")[0m
  [1m[35m (301.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "product_categories" CASCADE[0m
  [1m[35m (309.1ms)[0m  [1m[35mCREATE TABLE "product_categories" ("id" bigserial primary key, "name" character varying, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "business_id" bigint)[0m
  [1m[35m (305.4ms)[0m  [1m[35mCREATE INDEX "index_product_categories_on_business_id" ON "product_categories" ("business_id")[0m
  [1m[35m (301.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "products" CASCADE[0m
  [1m[35m (308.7ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "description" text, "quantity" integer, "buying_price" decimal, "product_category_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "business_id" bigint, "selling_price" decimal)[0m
  [1m[35m (305.1ms)[0m  [1m[35mCREATE INDEX "index_products_on_business_id" ON "products" ("business_id")[0m
  [1m[35m (344.5ms)[0m  [1m[35mCREATE INDEX "index_products_on_product_category_id" ON "products" ("product_category_id")[0m
  [1m[35m (302.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "roles" CASCADE[0m
  [1m[35m (311.8ms)[0m  [1m[35mCREATE TABLE "roles" ("id" bigserial primary key, "name" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "description" text)[0m
  [1m[35m (305.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "roles_users" CASCADE[0m
  [1m[35m (307.0ms)[0m  [1m[35mCREATE TABLE "roles_users" ("id" bigserial primary key, "user_id" bigint NOT NULL, "role_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (303.1ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_role_id" ON "roles_users" ("role_id")[0m
  [1m[35m (305.5ms)[0m  [1m[35mCREATE INDEX "index_roles_users_on_user_id" ON "roles_users" ("user_id")[0m
  [1m[35m (301.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "transaction_items" CASCADE[0m
  [1m[35m (310.7ms)[0m  [1m[35mCREATE TABLE "transaction_items" ("id" bigserial primary key, "transaction_record_id" bigint NOT NULL, "product_id" bigint NOT NULL, "quantity" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "price" decimal)[0m
  [1m[35m (377.1ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_product_id" ON "transaction_items" ("product_id")[0m
  [1m[35m (303.3ms)[0m  [1m[35mCREATE INDEX "index_transaction_items_on_transaction_record_id" ON "transaction_items" ("transaction_record_id")[0m
  [1m[35m (303.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "transactions" CASCADE[0m
  [1m[35m (397.1ms)[0m  [1m[35mCREATE TABLE "transactions" ("id" bigserial primary key, "user_id" bigint NOT NULL, "customer_id" bigint, "date" timestamp(6), "total_amount" decimal, "discount" decimal, "payment_method" character varying, "status" character varying, "mpesa_transaction_id" bigint, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "quantity" integer, "business_id" bigint, "received_amount" decimal, "returned_amount" decimal)[0m
  [1m[35m (303.1ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_business_id" ON "transactions" ("business_id")[0m
  [1m[35m (303.1ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_customer_id" ON "transactions" ("customer_id")[0m
  [1m[35m (303.8ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_mpesa_transaction_id" ON "transactions" ("mpesa_transaction_id")[0m
  [1m[35m (303.9ms)[0m  [1m[35mCREATE INDEX "index_transactions_on_user_id" ON "transactions" ("user_id")[0m
  [1m[35m (302.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (307.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying, "email" character varying, "phone" character varying, "revenue" decimal, "revenue_type" character varying, "password" character varying, "role" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, "supabase_id" character varying, "business_id" bigint)[0m
  [1m[35m (303.8ms)[0m  [1m[35mCREATE INDEX "index_users_on_business_id" ON "users" ("business_id")[0m
  [1m[35m (303.1ms)[0m  [1m[35mALTER TABLE "customers" ADD CONSTRAINT "fk_rails_b73113df4b"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (304.3ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_e75e84fa25"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
[0m
  [1m[35m (314.2ms)[0m  [1m[35mALTER TABLE "inventory_logs" ADD CONSTRAINT "fk_rails_4fc8fd7989"
FOREIGN KEY ("sales_transaction_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[35m (303.8ms)[0m  [1m[35mALTER TABLE "permissions_roles" ADD CONSTRAINT "fk_rails_7cc0b02d7d"
FOREIGN KEY ("permission_id")
  REFERENCES "permissions" ("id")
[0m
  [1m[35m (303.1ms)[0m  [1m[35mALTER TABLE "permissions_roles" ADD CONSTRAINT "fk_rails_211043a277"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
[0m
  [1m[35m (304.3ms)[0m  [1m[35mALTER TABLE "product_categories" ADD CONSTRAINT "fk_rails_d08cd985f2"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (302.9ms)[0m  [1m[35mALTER TABLE "products" ADD CONSTRAINT "fk_rails_64b1679e02"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (303.2ms)[0m  [1m[35mALTER TABLE "products" ADD CONSTRAINT "fk_rails_efe167855e"
FOREIGN KEY ("product_category_id")
  REFERENCES "product_categories" ("id")
[0m
  [1m[35m (303.4ms)[0m  [1m[35mALTER TABLE "roles_users" ADD CONSTRAINT "fk_rails_9dada905f6"
FOREIGN KEY ("role_id")
  REFERENCES "roles" ("id")
[0m
  [1m[35m (304.2ms)[0m  [1m[35mALTER TABLE "roles_users" ADD CONSTRAINT "fk_rails_e2a7142459"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (305.1ms)[0m  [1m[35mALTER TABLE "transaction_items" ADD CONSTRAINT "fk_rails_856b4fc46a"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
[0m
  [1m[35m (304.0ms)[0m  [1m[35mALTER TABLE "transaction_items" ADD CONSTRAINT "fk_rails_922f2e8367"
FOREIGN KEY ("transaction_record_id")
  REFERENCES "transactions" ("id")
[0m
  [1m[35m (303.0ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_410128cf7a"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (303.8ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_984bd8f159"
FOREIGN KEY ("customer_id")
  REFERENCES "customers" ("id")
[0m
  [1m[35m (303.3ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_abdb17cadd"
FOREIGN KEY ("mpesa_transaction_id")
  REFERENCES "mpesa_transactions" ("id")
[0m
  [1m[35m (304.4ms)[0m  [1m[35mALTER TABLE "transactions" ADD CONSTRAINT "fk_rails_77364e6416"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (302.5ms)[0m  [1m[35mALTER TABLE "users" ADD CONSTRAINT "fk_rails_ffa8fa13ef"
FOREIGN KEY ("business_id")
  REFERENCES "businesses" ("id")
[0m
  [1m[35m (305.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (303.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (301.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20250514171240)[0m
  [1m[35m (305.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20250510105916),
(20250509024437),
(20250509024433),
(20250509024430),
(20250509024426),
(20250418150904),
(20250418150022),
(20250413133755),
(20250413133751),
(20250413133747),
(20250413133741),
(20250413133737),
(20250413133713),
(20250413105955),
(20250413103259),
(20250409174132),
(20250409170018),
(20250409165309),
(20250409164945),
(20250406142616),
(20250325083359),
(20250325083347),
(20250325083328),
(20250325083312),
(20250325083233),
(20250325083142),
(20250325082518);[0m
  [1m[35m (306.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (806.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (301.7ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-05-28 12:29:30.950259', '2025-05-28 12:29:30.950266') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (398.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (302.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-05-28 12:29:31.964164' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (302.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (302.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'f2ce0e42f6e9d3233689f07eed0bb1ad94129e63', '2025-05-28 12:29:32.573451', '2025-05-28 12:29:32.573458') RETURNING "key"[0m
  [1m[36mUser Load (1463.6ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Load (301.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mCustomer Load (302.9ms)[0m  [1m[34mSELECT "customers".* FROM "customers" ORDER BY "customers"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[35m (318.9ms)[0m  [1m[34mSELECT pg_try_advisory_lock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (285.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (284.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (284.8ms)[0m  [1m[34mSELECT pg_advisory_unlock(7063170827162532495)[0m
  [1m[36mActiveRecord::SchemaMigration Load (287.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (302.3ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (314.6ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (311.5ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (302.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (302.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (303.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Count (304.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mUser Load (304.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mUser Load (501.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Started POST "/auth/register" for ::1 at 2025-05-28 17:34:58 +0500
Started POST "/auth/register" for ::1 at 2025-05-28 17:34:58 +0500
  
ActiveRecord::ConnectionNotEstablished (connection to server at "52.8.172.168", port 6543 failed: SSL connection has been closed unexpectedly
):

Causes:
PG::ConnectionBad (connection to server at "52.8.172.168", port 6543 failed: SSL connection has been closed unexpectedly
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:69:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
  
ActiveRecord::ConnectionNotEstablished (connection to server at "52.8.172.168", port 6543 failed: error received from server in SCRAM exchange: Wrong password
):

Causes:
PG::ConnectionBad (connection to server at "52.8.172.168", port 6543 failed: error received from server in SCRAM exchange: Wrong password
)
  
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:69:in `rescue in new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:57:in `new_client'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:982:in `connect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql_adapter.rb:994:in `reconnect'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:662:in `block in reconnect!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:661:in `reconnect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:763:in `block in verify!'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:754:in `verify!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:771:in `connect!'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:977:in `block in with_raw_connection'
activesupport (7.2.2.1) lib/active_support/concurrency/null_lock.rb:9:in `synchronize'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract_adapter.rb:976:in `with_raw_connection'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:128:in `quote_string'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/quoting.rb:76:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/quoting.rb:122:in `quote'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1099:in `quoted_scope'
activerecord (7.2.2.1) lib/active_record/connection_adapters/postgresql/schema_statements.rb:1076:in `data_source_sql'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/schema_statements.rb:60:in `table_exists?'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:54:in `block in create_table'
activerecord (7.2.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:421:in `with_connection'
activerecord (7.2.2.1) lib/active_record/schema_migration.rb:53:in `create_table'
activerecord (7.2.2.1) lib/active_record/migration.rb:1434:in `initialize'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `new'
activerecord (7.2.2.1) lib/active_record/migration.rb:1282:in `open'
activerecord (7.2.2.1) lib/active_record/migration.rb:776:in `block (2 levels) in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration/pending_migration_connection.rb:8:in `with_temporary_pool'
activerecord (7.2.2.1) lib/active_record/migration.rb:775:in `block in pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `each'
activerecord (7.2.2.1) lib/active_record/migration.rb:774:in `pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:753:in `check_pending_migrations'
activerecord (7.2.2.1) lib/active_record/migration.rb:663:in `block (2 levels) in call'
activesupport (7.2.2.1) lib/active_support/file_update_checker.rb:85:in `execute'
activerecord (7.2.2.1) lib/active_record/migration.rb:668:in `block in call'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `synchronize'
activerecord (7.2.2.1) lib/active_record/migration.rb:660:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:31:in `block in call'
activesupport (7.2.2.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (7.2.2.1) lib/action_dispatch/middleware/callbacks.rb:30:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:31:in `call'
web-console (4.2.1) lib/web_console/middleware.rb:132:in `call_app'
web-console (4.2.1) lib/web_console/middleware.rb:28:in `block in call'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `catch'
web-console (4.2.1) lib/web_console/middleware.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/show_exceptions.rb:32:in `call'
railties (7.2.2.1) lib/rails/rack/logger.rb:41:in `call_app'
railties (7.2.2.1) lib/rails/rack/logger.rb:29:in `call'
sprockets-rails (3.5.2) lib/sprockets/rails/quiet_assets.rb:17:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/remote_ip.rb:96:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/request_id.rb:33:in `call'
rack (3.1.12) lib/rack/method_override.rb:28:in `call'
rack (3.1.12) lib/rack/runtime.rb:24:in `call'
activesupport (7.2.2.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:61:in `block in call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:26:in `collect_events'
actionpack (7.2.2.1) lib/action_dispatch/middleware/server_timing.rb:60:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/executor.rb:16:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/static.rb:27:in `call'
rack (3.1.12) lib/rack/sendfile.rb:114:in `call'
actionpack (7.2.2.1) lib/action_dispatch/middleware/host_authorization.rb:143:in `call'
rack-cors (2.0.2) lib/rack/cors.rb:102:in `call'
railties (7.2.2.1) lib/rails/engine.rb:535:in `call'
puma (6.6.0) lib/puma/configuration.rb:279:in `call'
puma (6.6.0) lib/puma/request.rb:99:in `block in handle_request'
puma (6.6.0) lib/puma/thread_pool.rb:390:in `with_force_shutdown'
puma (6.6.0) lib/puma/request.rb:98:in `handle_request'
puma (6.6.0) lib/puma/server.rb:472:in `process_client'
puma (6.6.0) lib/puma/server.rb:254:in `block in run'
puma (6.6.0) lib/puma/thread_pool.rb:167:in `block in spawn_thread'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/register" for ::1 at 2025-05-28 17:35:18 +0500
  [1m[36mActiveRecord::SchemaMigration Load (288.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 422 Unprocessable Content in 1549ms (Views: 0.5ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.7ms)


Started GET "/users" for ::1 at 2025-05-28 17:36:24 +0500
Processing by UsersController#index as */*
Completed 500 Internal Server Error in 546ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 1.1ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/users_controller.rb:7:in `index'
Started GET "/users" for ::1 at 2025-05-28 17:36:27 +0500
Processing by UsersController#index as */*
Completed 500 Internal Server Error in 1117ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/users_controller.rb:7:in `index'
Started POST "/auth/login" for ::1 at 2025-05-28 17:36:37 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 532ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-28 17:36:39 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 401 Unauthorized in 607ms (Views: 0.2ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-05-28 17:36:46 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 422 Unprocessable Content in 1352ms (Views: 0.8ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/login" for ::1 at 2025-05-28 17:38:25 +0500
Processing by AuthController#login as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]"}}
Completed 200 OK in 1585ms (Views: 1.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/users" for ::1 at 2025-05-28 17:38:40 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (304.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "25e7409a-0311-48aa-b9bc-4871cd2a668d"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
Completed 500 Internal Server Error in 7397ms (ActiveRecord: 3637.5ms (1 query, 0 cached) | GC: 15.2ms)


  
NoMethodError (undefined method `business_id' for nil:NilClass):
  
app/controllers/users_controller.rb:7:in `index'
  [1m[36mUser Load (291.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (352.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (648.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  [1m[36mUser Create (289.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id", "business_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Abdullah"], ["email", "[FILTERED]"], ["phone", nil], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-05-28 12:40:40.771299"], ["updated_at", "2025-05-28 12:40:40.771299"], ["supabase_id", "25e7409a-0311-48aa-b9bc-4871cd2a668d"], ["business_id", nil]]
  [1m[36mTRANSACTION (449.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (290.9ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Started GET "/users" for ::1 at 2025-05-28 17:41:03 +0500
Processing by UsersController#index as */*
  [1m[36mUser Load (309.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."supabase_id" = $1 LIMIT $2[0m  [["supabase_id", "25e7409a-0311-48aa-b9bc-4871cd2a668d"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:18:in `set_current_user'
  [1m[36mUser Load (304.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."business_id" IS NULL[0m
  ↳ app/controllers/users_controller.rb:8:in `map'
  [1m[36mRolesUser Load (303.0ms)[0m  [1m[34mSELECT "roles_users".* FROM "roles_users" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 1]]
  ↳ app/controllers/users_controller.rb:8:in `map'
Completed 200 OK in 4680ms (Views: 1.5ms | ActiveRecord: 3254.8ms (3 queries, 0 cached) | GC: 3.3ms)


[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
UserMailer#welcome_email: processed outbound mail in 18.0ms
UserMailer#welcome_email: processed outbound mail in 2.5ms
UserMailer#welcome_email: processed outbound mail in 1.1ms
UserMailer#welcome_email: processed outbound mail in 3.7ms
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mUser Load (142.0ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[36mUser Load (139.2ms)[0m  [1m[34mSELECT "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering layout layouts/mailer.html.erb
  Rendering user_mailer/welcome_email.html.erb within layouts/mailer
  Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/mailer.html.erb (Duration: 0.5ms | GC: 0.0ms)
UserMailer#welcome_email: processed outbound mail in 17.0ms
Delivered mail 6845403f80d97_1333ae88-4d3@192.168.10.8.mail (3792.3ms)
Date: Sun, 08 Jun 2025 12:48:15 +0500
From: from@example.com
To: abdullahcs2020@gmail.com
Message-ID: <6845403f80d97_1333ae88-4d3@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcome to Our App</h1>
<p>Thank you for joining us.</p><!-- END app/views/user_mailer/welcome_email.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->
  [1m[36mUser Load (138.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 /* loading for pp */ LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 11]]
  [1m[36mUser Pluck (142.1ms)[0m  [1m[34mSELECT "users"."id", "users"."email" FROM "users"[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/register" for ::1 at 2025-06-08 12:51:09 +0500
  [1m[36mActiveRecord::SchemaMigration Load (141.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 500 Internal Server Error in 77ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.1ms)


  
SocketError (Failed to open TCP connection to escgnbaimbnfifkxefnm.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:8:in `sign_up'
app/controllers/auth_controller.rb:10:in `register'
Started POST "/auth/register" for ::1 at 2025-06-08 12:51:56 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to escgnbaimbnfifkxefnm.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:8:in `sign_up'
app/controllers/auth_controller.rb:10:in `register'
Started POST "/auth/register" for ::1 at 2025-06-08 12:52:09 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
SocketError (Failed to open TCP connection to escgnbaimbnfifkxefnm.supabase.co:443 (getaddrinfo: nodename nor servname provided, or not known)):

Causes:
SocketError (getaddrinfo: nodename nor servname provided, or not known)
  
app/services/supabase_service.rb:8:in `sign_up'
app/controllers/auth_controller.rb:10:in `register'
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
Started POST "/auth/register" for ::1 at 2025-06-08 12:52:16 +0500
  [1m[36mActiveRecord::SchemaMigration Load (136.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"Test User", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (136.0ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:20:in `block in register'
  [1m[36mUser Exists? (147.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mUser Create (149.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id", "business_id", "email_verified_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["name", "Test User"], ["email", "[FILTERED]"], ["phone", "1234567890"], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-06-08 07:52:23.604201"], ["updated_at", "2025-06-08 07:52:23.604201"], ["supabase_id", "43b3e13d-a09e-4fad-83f6-cb7f7c37dc4e"], ["business_id", nil], ["email_verified_at", "[FILTERED]"]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mTRANSACTION (138.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:19:in `register'
Completed 201 Created in 4712ms (Views: 1.0ms | ActiveRecord: 2371.2ms (2 queries, 0 cached) | GC: 1.6ms)


  [1m[36mUser Pluck (141.5ms)[0m  [1m[34mSELECT "users"."id", "users"."email" FROM "users"[0m
  [1m[36mUser Load (139.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 54], ["LIMIT", 1]]
  Rendering layout layouts/mailer.html.erb
  Rendering user_mailer/welcome_email.html.erb within layouts/mailer
  Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/mailer.html.erb (Duration: 0.8ms | GC: 0.0ms)
UserMailer#welcome_email: processed outbound mail in 4.1ms
Delivered mail 68454153644af_1333ae88-318@192.168.10.8.mail (4800.9ms)
Date: Sun, 08 Jun 2025 12:52:51 +0500
From: from@example.com
To: 2020cs72@gmail.com
Message-ID: <68454153644af_1333ae88-318@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcome to Our App</h1>
<p>Thank you for joining us.</p><!-- END app/views/user_mailer/welcome_email.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->
  Rendering layout layouts/mailer.html.erb
  Rendering user_mailer/welcome_email.html.erb within layouts/mailer
  Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.3ms | GC: 0.0ms)
  Rendered layout layouts/mailer.html.erb (Duration: 2.8ms | GC: 0.0ms)
UserMailer#welcome_email: processed outbound mail in 8.9ms
Delivered mail 684541cb74c21_1333ae88-253@192.168.10.8.mail (3294.9ms)
Date: Sun, 08 Jun 2025 12:54:51 +0500
From: from@example.com
To: 2020cs72@gmail.com
Message-ID: <684541cb74c21_1333ae88-253@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcome to Our App</h1>
<p>Thank you for joining us.</p><!-- END app/views/user_mailer/welcome_email.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->
  Rendering layout layouts/mailer.html.erb
  Rendering user_mailer/welcome_email.html.erb within layouts/mailer
  Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.4ms | GC: 0.0ms)
  Rendered layout layouts/mailer.html.erb (Duration: 3.0ms | GC: 0.0ms)
UserMailer#welcome_email: processed outbound mail in 6.0ms
Delivered mail 684541f0277bc_1333ae88-186@192.168.10.8.mail (3890.2ms)
Date: Sun, 08 Jun 2025 12:55:28 +0500
From: from@example.com
To: 2020cs72@gmail.com
Message-ID: <684541f0277bc_1333ae88-186@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcome to Our App</h1>
<p>Thank you for joining us.</p><!-- END app/views/user_mailer/welcome_email.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Set [36mSUPABASE_URL[0m and [36mSUPABASE_KEY[0m
[dotenv] Loaded [33m.env[0m
[dotenv] Loaded [33m.env[0m
  [1m[36mUser Load (150.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 54], ["LIMIT", 1]]
  Rendering layout layouts/mailer.html.erb
  Rendering user_mailer/welcome_email.html.erb within layouts/mailer
  Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.2ms | GC: 0.0ms)
  Rendered layout layouts/mailer.html.erb (Duration: 0.5ms | GC: 0.0ms)
UserMailer#welcome_email: processed outbound mail in 18.7ms
Delivered mail 6845427a759ef_13606e88614b3@192.168.10.8.mail (3117.8ms)
Date: Sun, 08 Jun 2025 12:57:46 +0500
From: from@example.com
To: 2020cs72@gmail.com
Message-ID: <6845427a759ef_13606e88614b3@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf=
-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcom=
e to [Futura POS], Test User!</h1>
<p>Thank you for joining us at [Your App Name]. We=E2=80=99re excited to =
have you on board. Explore all the amazing features we offer to make your=
 experience unforgettable.</p>
<p>If you have any questions, feel free to reach out to our support team!=
</p>
<p>Best regards,</p>
<p>The [Your App Name] Team</p><!-- END app/views/user_mailer/welcome_ema=
il.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->=

Started POST "/auth/register" for ::1 at 2025-06-08 13:01:18 +0500
  [1m[36mActiveRecord::SchemaMigration Load (139.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (148.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:20:in `block in register'
  [1m[36mUser Exists? (170.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mTRANSACTION (149.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:19:in `register'
Completed 422 Unprocessable Content in 4808ms (Views: 0.3ms | ActiveRecord: 2465.6ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-06-08 13:02:21 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (151.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mUser Exists? (305.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mTRANSACTION (152.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:19:in `register'
Completed 422 Unprocessable Content in 4178ms (Views: 0.3ms | ActiveRecord: 609.8ms (1 query, 0 cached) | GC: 0.0ms)


  [1m[36mUser Load (177.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 54], ["LIMIT", 1]]
  [1m[36mTRANSACTION (158.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Destroy (322.7ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 54]]
  [1m[36mTRANSACTION (167.8ms)[0m  [1m[35mCOMMIT[0m
Started POST "/auth/register" for ::1 at 2025-06-08 13:02:42 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
Completed 422 Unprocessable Content in 771ms (Views: 0.7ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started POST "/auth/register" for ::1 at 2025-06-08 13:15:30 +0500
Processing by AuthController#register as */*
  Parameters: {"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}, "auth"=>{"email"=>"[FILTERED]", "password"=>"[FILTERED]", "phone"=>"1234567890", "name"=>"ABD TEST", "business"=>{"name"=>"TestCorp", "description"=>"A business description here", "phone"=>"123-456-7890", "email"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (144.6ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mUser Exists? (290.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) LIMIT $2[0m  [["email", "[FILTERED]"], ["LIMIT", 1]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mUser Create (150.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "phone", "revenue", "revenue_type", "password", "role", "created_at", "updated_at", "supabase_id", "business_id", "email_verified_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12) RETURNING "id"[0m  [["name", "ABD TEST"], ["email", "[FILTERED]"], ["phone", "1234567890"], ["revenue", nil], ["revenue_type", nil], ["password", "[FILTERED]"], ["role", nil], ["created_at", "2025-06-08 08:15:37.694031"], ["updated_at", "2025-06-08 08:15:37.694031"], ["supabase_id", "adf51f67-820d-4a54-849f-734ec494591e"], ["business_id", nil], ["email_verified_at", "[FILTERED]"]]
  ↳ app/controllers/auth_controller.rb:21:in `block in register'
  [1m[36mTRANSACTION (150.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/auth_controller.rb:19:in `register'
[ActiveJob] Enqueued ActionMailer::MailDeliveryJob (Job ID: a24761f5-22ab-4fad-b906-0130ef8ed593) to Async(default) with arguments: "UserMailer", "welcome_email", "deliver_now", {:args=>[#<GlobalID:0x00000001059769f8 @uri=#<URI::GID gid://inventory-hub/User/55>>]}
[ActiveJob] ↳ app/models/user.rb:16:in `send_welcome_email'
Completed 201 Created in 6939ms (Views: 0.5ms | ActiveRecord: 2046.0ms (2 queries, 0 cached) | GC: 33.8ms)


[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593]   [1m[36mUser Load (188.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593] Performing ActionMailer::MailDeliveryJob (Job ID: a24761f5-22ab-4fad-b906-0130ef8ed593) from Async(default) enqueued at 2025-06-08T08:15:38.068134000Z with arguments: "UserMailer", "welcome_email", "deliver_now", {:args=>[#<GlobalID:0x0000000105b57128 @uri=#<URI::GID gid://inventory-hub/User/55>>]}
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593]   Rendering layout layouts/mailer.html.erb
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593]   Rendering user_mailer/welcome_email.html.erb within layouts/mailer
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593]   Rendered user_mailer/welcome_email.html.erb within layouts/mailer (Duration: 0.8ms | GC: 0.0ms)
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593]   Rendered layout layouts/mailer.html.erb (Duration: 1.4ms | GC: 0.0ms)
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593] UserMailer#welcome_email: processed outbound mail in 16.2ms
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593] Delivered mail 684546aac2574_135ca8048718b0@192.168.10.8.mail (3254.5ms)
[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593] Date: Sun, 08 Jun 2025 13:15:38 +0500
From: from@example.com
To: 2020cs72@gmail.com
Message-ID: <684546aac2574_135ca8048718b0@192.168.10.8.mail>
Subject: Welcome to Our App
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<!-- BEGIN app/views/layouts/mailer.html.erb --><!DOCTYPE html>
<html>
  <head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf=
-8">
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <!-- BEGIN app/views/user_mailer/welcome_email.html.erb --><h1>Welcom=
e to [Futura POS], ABD TEST!</h1>
<p>Thank you for joining us at [Your App Name]. We=E2=80=99re excited to =
have you on board. Explore all the amazing features we offer to make your=
 experience unforgettable.</p>
<p>If you have any questions, feel free to reach out to our support team!=
</p>
<p>Best regards,</p>
<p>The [Your App Name] Team</p><!-- END app/views/user_mailer/welcome_ema=
il.html.erb -->
  </body>
</html>
<!-- END app/views/layouts/mailer.html.erb -->=

[ActiveJob] [ActionMailer::MailDeliveryJob] [a24761f5-22ab-4fad-b906-0130ef8ed593] Performed ActionMailer::MailDeliveryJob (Job ID: a24761f5-22ab-4fad-b906-0130ef8ed593) from Async(default) in 3897.55ms
